_.Module.define({path:"frs-list/widget/util_pop_video",sub:{_isFuckingIE:$.browser.msie&&$.browser.version<8,_videoSize:{min:{width:440,height:356},normal:{width:534,height:386},max:{width:630,height:481}},initial:function(i){i=i||{},this.config=i,this.popBoxTemplate=['<div id="pop_video" class="dialogJshadow">','<div class="pop_video_inner">','<div class="pop_video_title">','<span class="title_text">',"</span>",'<a rel="noreferrer"  href="#" class="j_pop_video_btn show pop_video_btn">&nbsp;</a>',"</div>",'<div class="pop_video_content">','<video id="h5_video_play" controls loop src="#{src}" width="'+(i.width||this._videoSize.min.width)+'" height="'+(i.height||this._videoSize.min.height)+'"></video>',"</div>","</div>","</div>"].join(""),this._initEvent()},_resizeFlash:function(i){$("#pop_video").find("#h5_video_play").tbattr(i||this._videoSize.min)},_initEvent:function(){var i=this;$("body").off("click.pop_video",".media_box .j_pop_media").on("click.pop_video",".media_box .j_pop_media",function(o){var e=$(o.target).parents(".media_disp, .j_media_disp").find("video")[0];this.currentTime=e.currentTime,i.popBox($(this)),o.preventDefault()}),$("body").off("mousedown.pop_video",".j_m_flash").on("mousedown.pop_video",".j_m_flash",function(){i.unpopBox()}),$(window).off("resize.pop_video").on("resize.pop_video",function(){i._resize()})},unpopBox:function(){var i=$("#pop_video");i.remove(),this._isFuckingIE&&$(window).off("scroll",this._scroll)},popBox:function(i){$(".live_tv").hasClass("minimized")||$(".live_tv_btn").trigger("click");var o=this;o.unpopBox();var e=i.parents(".j_media_disp").find("video").tbattr("src"),t=i.parents(".j_thread_list").find(".threadlist_title a").html();t=$.tb.subByte(t,50,"...");var n=this.popBoxTemplate.replace(/#{src}/,e);$("body").append(n),$(".j_retract_media").trigger("click");var s=$("#pop_video"),p=$("#h5_video_play")[0];p.currentTime=i[0].currentTime,p.play(),s.find(".pop_video_title").css("width",this._videoSize.min.width).find(".title_text").html(t),this.setPosition(),s.on("click",".j_pop_video_btn",function(i){o.unpopBox(),i.preventDefault()}),this._isFuckingIE?$(window).on("scroll",this._scrollStop):this.draggableObj=new $.draggable({handle:s.find(".pop_video_title"),target:s,type:"",onUp:function(){var i=parseInt(s.css("top")),e=parseInt(s.css("left"));(0>i||0>e)&&(i=0>i?5:i,e=0>e?5:e,o.setPosition(e,i))}})},setPosition:function(i,o){var e=this,t=$("#pop_video");if(0!==i&!i&&0!==o&&!o){var n=$(document),s=$(window),p=e._isFuckingIE?[n.scrollLeft(),n.scrollTop()]:[0,0];i=p[0]+(s.width()-t.outerWidth()-5),o=p[1]+(s.height()-t.outerHeight())/2,o=o>=0?o:0}t.css({left:i,top:o,right:"auto",bottom:"auto"})},_resize:function(){0!=$("#pop_video").length&&this.setPosition()},_scrollStop:function(){$("#pop_video").css("top",$(document).scrollTop()+($(window).height()-$("#pop_video").height())/2)}}});_.Module.define({path:"tbui/widget/audio_player",sub:{defaultOptions:{src:"https://gss2.baidu.com/5LgHhXSm2Q5IlBGlnYG/player/static/flash/fmp.swf"},isReady:!1,isPlaying:!1,isMute:!1,volume:void 0,url:"",initial:function(t){var e=this;this.options=$.extend(this.defaultOptions,t);var i=$("<div></div>").css({width:1,height:1,overflow:"hidden"});i.appendTo("body"),i.html(this.renderSwf(this.options.src));var s=i.find("object"),a=$.browser.msie?s[0]:s.find("embed")[0];this.$container=i,this.$swf=s,this.swfObject=a,this.checkTimes=0;var n=setInterval(function(){try{this.checkTimes++,e.swfObject&&e.swfObject.PercentLoaded&&100===e.swfObject.PercentLoaded()&&(clearInterval(n),setTimeout(function(){e.onSwfLoaded()},100))}catch(t){this.checkTimes>20&&(clearInterval(n),n=null)}},100);window.pl=this},onSwfLoaded:function(){this.isReady=!0,this.bindEvents(),this.trigger("playerloaded",this)},renderSwf:function(){var t=['<object id="audio_player_core" width="#{width}" height="#{height}" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#4,0,0,0">','<param name="quality" value="high" />','<param name="allowscriptaccess" value="always">','<param name="scale" value="noscale">','<param name="wmode" value="window">','<param name="movie" value="#{srcWithStamp}">','<embed name="audio_player_core" width="#{width}" height="#{height}" allowscriptaccess="always" wmode="window" scale="noscale" src="#{srcWithStamp}" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">',"</object>"].join("");return function(e){return $.tb.format(t,{src:e,srcWithStamp:e,width:1,height:1})}}(),bindEvents:function(){this.bind("reset",this._reset,this),this.bind("load",this._load,this),this.bind("play",this._play,this),this.bind("pause",this._pause,this),this.bind("stop",this._stop,this),this.bind("setmute",this._setMute,this)},_reset:function(){this.stop(),this.url="",this.isPlaying=!1},_load:function(t,e,i,s){function a(){var t=n._getLoadedPercent();return t>.3?(n.trigger("songloaded",t),n.failHandler&&clearTimeout(n.failHandler),i&&i(),!0):!1}var n=this;this.url=e,this.swfObject.closeStream(),this.swfObject.f_load(e),this.failHandler&&clearTimeout(this.failHandler),this.failHandler=setTimeout(function(){s&&s()},5e3),this.checkLoadedHandler&&clearTimeout(this.checkLoadedHandler),this.checkLoadedHandler=setTimeout(function(){a()||(n.checkLoadedHandler=setTimeout(arguments.callee,50))},50)},_play:function(t,e,i,s){function a(){var t=n._getCurrentPosition();return i&&i({percent:t,totalTime:n._getTotalTime(),currentTime:n._getCurrentTime()}),1==t?(n.trigger("playfinish",t),s&&s(),!0):!1}var n=this;if(!this.isPlaying){var h=this._getTotalTime();this.swfObject.f_play(),this.checkFinishedHandler&&clearTimeout(this.checkFinishedHandler),this.isPlaying=!0,e&&e({totalTime:h}),this.checkFinishedHandler=setTimeout(function(){a()||(n.checkFinishedHandler=setTimeout(arguments.callee,500))},1e3)}},_pause:function(){this.isPlaying&&(this.swfObject.f_pause(),this.isPlaying=!1)},_stop:function(){this.swfObject.f_stop(),this.checkFinishedHandler&&clearTimeout(this.checkFinishedHandler),this.isPlaying=!1},_setMute:function(t,e){this.isMute=e;try{this.swfObject.setData("mute",e)}catch(i){return!1}},_setVolume:function(t,e){this.volume=e;try{this.swfObject.setData("volume",e)}catch(i){return!1}},_setCurrentPosition:function(){},_getCurrentPosition:function(){return this.swfObject.getData("postionPct")},_getLoadedPercent:function(){return this.swfObject.getData("loadedPct")},_getTotalTime:function(){return this.swfObject.getData("length")},_getCurrentTime:function(){return this.swfObject.getData("currentPosition")}}});_.Module.define({path:"tbui/widget/voice",requires:["tbui/widget/audio_player"],sub:{version:"0.1",api:"/voice/index?",pidWhiteList:[40649447103,40649504943,40649558518,40649601183],initial:function(t){this.product=t&&t.product||"frs",this.tid=t&&t.tid||0,this.api=t&&t.api||this.api,this.useMd5=t&&t.useMd5||0,this.canPlay=t&&t.canPlay||1,$("body").on("click",".voice_player a ",function(t){t.preventDefault()}),this.initPlayer(),$(window).bind("initvoicelength",function(t,e){var i=$(e),a=i.find(".minute"),n=i.find(".second");if(a.length>0||n.length>0&&n.text()>=30)i.width(125);else if(n.length>0){var r=n.text();5>=r?i.width(50):i.width(50+3*(r-5))}}),$(".voice_player .time").each(function(){$(window).trigger("initvoicelength",this)})},initPlayer:function(){var t=this;this.player=this.requireInstance("tbui/widget/audio_player"),this.player.bind("playerloaded",function(){t.bindPlayerEvent()})},bindPlayerEvent:function(){var t=this,e=this.animateIcon,i=this.player,a=null;$("body").on("click",".voice_player a",function(n){function r(t){t.totalTime>0&&!u.data("time")&&0!=t.totalTime&&u.data("time",t.totalTime)}function s(e){var i=(0!=e.totalTime?e.totalTime:u.data("time"))-e.currentTime;t.updateTime(u,i)}function o(){p.data("state",""),t.resetTime(u),e.reset(c)}n.preventDefault(),$.stats.track("voice_btn_total","pc_voice");{var l,d,p=$(this).parent(".voice_player"),c=p.find(".speaker"),u=p.find(".time"),m=p.hasClass("voice_player_mini");m?"lzl":t.product}if(p.hasClass("in_live_thread")){var h=p.data("info")||{};l=h.tid,d=h.pid}else"pb"===t.product?(l=PageData.thread&&PageData.thread.thread_id,d=m?p.parents(".j_lzl_s_p").getData().spid:p.parents(".l_post").getData().content.post_id):"frs"==t.product?l=p.parents(".j_thread_list").data("field").id:"index"==t.product&&(l=p.data("tid"));var g="";if(g=1==t.useMd5?t.api+"?voice_md5="+p.data("md5"):t.api+"tid="+l+(d?"&pid="+d:""),1!=t.canPlay&&-1==$.inArray(d,t.pidWhiteList))return a&&(i.trigger("stop"),t.resetPrevPlayer(a)),void 0;if("playing"===p.data("state"))i.trigger("stop"),p.data("state",""),e.reset(c),t.resetTime(u),$.stats.track("voice_stop","pc_voice");else{t.resetPrevPlayer(a),i.trigger("stop"),p.data("state","playing"),e.set(c,"loading"),$.stats.track("voice_play","pc_voice");var v=u.find(".minute"),f=u.find(".second"),y=v.length>0?+v.html():0,_=f.length>0?+f.html():0;u.data("time",6e4*y+1e3*_),i._setVolume("",100),i.trigger("load",g,function(){i.trigger("play",r,s,o),e.set(c,"playing")},function(){i.trigger("stop"),p.data("state",""),e.reset(c),t.resetTime(u);var a=$.tb.alert({title:"\u64ad\u653e\u5931\u8d25",message:"\u6211\u4e0d\u662f\u6545\u610f\u7684\uff0c\u64ad\u653e\u5931\u8d25\u4e86\uff0c\u8bf7\u518d\u8bd5\u4e00\u4e0b\u5427~",buttons:[{text:"\u786e\u8ba4"}],width:310});a.modal.bind("click",function(){a.hide()})}),a=p}})},updateTime:function(t,e){e=e||t.data("time")||0;var i=Math.floor(e/6e4),a=Math.round(e%6e4/1e3),n="";i>0&&(n+='<span class="minute">'+i+"</span>'"),(a>0||i>0)&&(n+='<span class="second">'+a+'</span>"'),t.html(n)},resetTime:function(t){this.updateTime(t)},resetPrevPlayer:function(t){if(t){var e=t.find(".speaker"),i=t.find(".time");t.data("state",""),this.resetTime(i),this.animateIcon.reset(e)}},animateIcon:function(){function t(t,e){if($.browser.mozilla){var i=t.parent().parent().hasClass("loading")?"loading":"playing",a=t.parent().parent().parent().hasClass("voice_player_mini")?"mini":"normal",n=e+"px "+s[a][i]+"px";t.css("background-position",n)}else t.css("background-position-x",e)}function e(e,s){l&&i(l),i(e),l=e,e.parent().parent().addClass(s);var d=e.parent().parent().parent().hasClass("voice_player_mini")?"mini":"normal";"playing"===s?(e.parent().parent().hasClass("voice_player_mini")?t(e,-38):t(e,-58),o=setTimeout(function(){var i=0;return function(){i=(i+1)%4,t(e,a[d][i]),o=setTimeout(arguments.callee,r[s])}}(),r[s])):"loading"===s&&(e.parent().parent().hasClass("voice_player_mini")?t(e,-1):t(e,-1),o=setTimeout(function(){var i=0;return function(){i=(i+1)%12,t(e,-1-i*n[d]),o=setTimeout(arguments.callee,r[s])}}(),r[s]))}function i(e){clearTimeout(o),e.parent().parent().removeClass("loading playing"),e.parent().parent().parent().hasClass("voice_player_mini")?t(e,-38):t(e,-58)}var a={normal:[-1,-20,-39,-58],mini:[1,-12,-25,-38]},n={normal:20,mini:15},r={playing:400,loading:100},s={normal:{playing:-202,loading:-167},mini:{playing:-264,loading:-237}},o=null,l=null;return{set:e,reset:i}}()}});_.Module.define({path:"frs-list/pagelet/thread_list",requires:["tbui/widget/voice","frs-list/widget/util_pop_video","user/widget/user_visit_card","user/widget/single_icons","entertainment-game/widget/game_thread","entertainment-game/widget/game_code_thread","frs-list/widget/scroll_event","frs-list/widget/util_https_stat","frs-list/widget/util_media_controller","frs-list/widget/util_top_cookie","ueglib/widget/detect_manager_block","ueglib/widget/block_user"],sub:{initial:function(){},init:function(e){this.$_wrapper=$(".j_threadlist_bright"),this.setOptions(e),this.initPlugin(),this.run(e)},run:function(e){this.initMediaController(e),this.bakanInit(),this.bindTopThreadEvent(),this.bindMemberEvents(),this.bindDeleteEvents(),this.threadEasterEggsTrack(),this.checkLogin(),this.bindJoinVipStat(),this.bindPostSuccessEvents(),this.bindTopicEvent(),this.bindLive()},initPlugin:function(){this.requireInstance("tbui/widget/voice"),this.requireInstance("frs-list/widget/util_pop_video"),this.requireInstance("user/widget/user_visit_card",[{wrapper:this.$_wrapper}]),this.requireInstance("user/widget/single_icons",[{wrapper:this.$_wrapper}]),this.requireInstance("entertainment-game/widget/game_thread",[{wrapper:this.$_wrapper}]),this.requireInstance("entertainment-game/widget/game_code_thread",[{wrapper:this.$_wrapper}]),this.requireInstance("frs-list/widget/scroll_event",[{wrapper:this.$_wrapper}]),this.requireInstance("frs-list/widget/util_https_stat")},setOptions:function(e){null!=e&&(this._options=$.extend(this._options,e))},initMediaController:function(e){this.requireInstance("frs-list/widget/util_media_controller",[{wrapper:this.$_wrapper,type:"threadList",videoAutoPlay:e.videoAutoPlay||0}])},bakanInit:function(){$(".th_bakan").each(function(){var e=$(this).closest(".j_thread_list"),t=e.getData();$.get("/bakan/sys/get_bakan_by_thread?fid="+PageData.forum.id+"&tid="+t.id,function(t){var i=$.parseJSON(t);0==i.error_no?e.find(".threadlist_abs").append(i.msg.brief).after('<div class="m_bakan"><a rel="noreferrer"  href="/bakan/view?kw='+PageData.forum.name_url+"&kid="+i.msg.bakan_id+'" target="_blank"><img style="height:75px;width:auto;vertical-align: baseline;" src="https://imgsa.baidu.com/forum/pic/item/'+i.msg.pic_url+'.jpg" height="75"/></a><a rel="noreferrer"  href="/bakan/view?kw='+PageData.forum.name_url+"&kid="+i.msg.bakan_id+'" target="_blank">\u672c\u671f\u5427\u520a<em>&#187;</em></a></div>'):e.find(".threadlist_abs").append('<div class="m_bakan"><a rel="noreferrer"  href="/bakan/view?kw='+PageData.forum.name_url+"&kid="+i.msg.bakan_id+'" target="_blank"><img style="height:75px;width:auto;vertical-align: baseline;" src="https://imgsa.baidu.com/forum/pic/item/'+i.msg.pic_url+'.jpg" height="75"/></a><a rel="noreferrer"  href="/bakan/view?kw='+PageData.forum.name_url+"&kid="+i.msg.bakan_id+'" target="_blank">\u672c\u671f\u5427\u520a<em>&#187;</em></a></div>')})})},checkLogin:function(){$(".j_user_card").on("click",function(){if(!PageData.user.is_login){var e=$(this).tbattr("href"),t="//tieba.baidu.com"+$.tb.unescapeHTML(e);return window.open("/f/user/passport?jumpUrl="+t+"&statsInfo=frs_user#login_anchor"),!1}})},bindTopThreadEvent:function(){var e=this,t=$("#thread_top_folder"),i=$("#thread_top_list");t.length&&t.on("click",function(){i.children("li").slideDown(),$(this).hide();for(var t=$(this).data("field"),a=$.cookie("top_list")||"",n=0,r=t.length;r>n;n++){var o=e.requireInstance("frs-list/widget/util_top_cookie",[t[n]]);a=o.deltid(a)}$.cookie("top_list",a,{expires:72,path:"/"})}),i.find(".j_thread_hidden").on("click",function(){$(this).parents(".j_thread_list").slideUp(),t.show();var i=$(this).data("field"),a=i.tid,n=$.cookie("top_list")||"",r=e.requireInstance("frs-list/widget/util_top_cookie",[a]);r.tidin(n)||$.cookie("top_list",r.addtid(n),{expires:72,path:"/"})})},bindLive:function(){this.$_wrapper.on("click",".threadlist_live, .threadlist_blink_dot",function(e){$.stats.track("\u70b9\u51fb","frs\u770b\u5e16\u76f4\u64ad\u8d34\u70b9\u51fb\u91cf","frs","click",{live_id:/threadlist_blink_dot/.test(e.target.className)?e.target.parentNode.href.match(/live_id=(\d+)/)[1]:e.target.href.match(/live_id=(\d+)/)[1]})});for(var e=$(".threadlist_blink_dot"),t=0;t<e.length;t++)e[t].posY=e[t].getBoundingClientRect().top+document.documentElement.scrollTop;$(window).on("scroll",function(){for(var t=0;t<e.length;t++)null==e[t].seen&&e[t].posY<document.documentElement.clientHeight+document.documentElement.scrollTop&&e[t].posY>document.documentElement.scrollTop&&(e[t].seen=!0,$.stats.track("\u5c55\u793a","frs\u770b\u5e16\u76f4\u64ad\u8d34\u66dd\u5149\u91cf","frs","view",{live_id:e[t].parentNode.href.match(/live_id=(\d+)/)[1]}))})},bindMemberEvents:function(){this.$_wrapper.on("mouseover",".j_beMember",function(){$(this).css({"background-color":"#ffffe5"})}).on("mouseout",".j_beMember",function(){$(this).css({"background-color":"#fff"})})},bindDeleteEvents:function(){var e=this;this._options.pagelet.on("manager_mode_disabled",function(){e._options.pagelet.refresh()}).on("manager_mode_enabled",function(){e._options.pagelet.refresh()}),this.$_wrapper.on("click",".j_deleteThreads",$.proxy(this.canDeleteThread,this,0)).on("click",".j_deleteAndBan",$.proxy(this.canDeleteThread,this,1))},canDeleteThread:function(e){var t=this.requireInstance("ueglib/widget/detect_manager_block",[this._options.ifCheck]);t.doOnNotBlocked($.proxy(this.deleteThread,this,e))},deleteThread:function(e,t){var i=this,a="",n=[],r=[];$(".j_batch_delete_select:checked").each(function(e,t){var i=$(t).parent().parent(),o=i.getData();n.push({username:o.author_name,pid:o.first_post_id,id:o.id}),r.push(o.id),a=0==e?o.id:a+"_"+o.id});var o={fid:PageData.forum.id,tbs:PageData.tbs,tid:a,kw:PageData.forum.name,isBan:0};o=t?$.extend(o,t):o,""!=a&&$.tb.post("/f/commit/thread/batchDelete",o,function(t){if(1990055===t.err_code)$.tb.checkRealName();else if(0==t.no)e?i.requireInstance("ueglib/widget/block_user",[n,{ban_id:!0,ban_ip:!0},PageData.forum,PageData.tbs,function(){i._options.pagelet.refresh()}]):i._options.pagelet.refresh();else if(12==t.no)$.dialog.alert("<p>\u62b1\u6b49\uff0c\u8d26\u53f7\u5904\u4e8e\u5c01\u7981\u72b6\u6001\uff0c\u6682\u65f6\u4e0d\u80fd\u5220\u8d34\u3002<a rel='noreferrer'  href='//tieba.baidu.com/upc/userinfo?fid="+PageData.forum.id+"' target='_blank'>\u70b9\u51fb\u6b64\u5904</a>\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f</p>");else if(13==t.no)$.dialog.alert("<p>\u62b1\u6b49\uff0c\u7f51\u7edc\u5730\u5740\u5904\u4e8e\u5c01\u7981\u72b6\u6001\uff0c\u6682\u65f6\u4e0d\u80fd\u5220\u8d34\u3002<a rel='noreferrer'  href='//tieba.baidu.com/upc/userinfo?fid="+PageData.forum.id+"' target='_blank'>\u70b9\u51fb\u6b64\u5904</a>\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f</p>");else if(899==t.no)$.dialog.alert("<p>\u60a8\u65e0\u6cd5\u5220\u9664\u8be5\u8d34\u5b50\u3002</p>");else if(34==t.no)$.dialog.alert("<p>\u4eb2\u7231\u7684\u5c0f\u4f19\u4f34\uff0c\u4f60\u4eca\u5929\u7684\u5220\u8d34\u6570\u91cf\u5df2\u7ecf\u8fbe\u5230\u6700\u5927\u9650\u989d("+t.data.reason+"\u6761/\u5929\uff09\uff0c\u660e\u5929\u518d\u6765\u8bd5\u8bd5\u5427~</p>");else if(4009==t.no)$.dialog.alert("<p>\u8be5\u8d34\u5b50\u5df2\u88ab\u4fdd\u62a4\uff0c\u65e0\u6cd5\u76f4\u63a5\u5220\u9664\uff0c\u5982\u53d1\u73b0\u8d34\u5b50\u6709\u95ee\u9898\u8bf7\u76f4\u63a5\u4e3e\u62a5</p>");else{if(4011==t.no)return i.getCaptcha(t,e),void 0;if(4014===t.no)return i._report(t,e,n),void 0;t.error?$.dialog.alert(t.error):$.dialog.alert("\u51fa\u9519\u5566\uff0c\u5237\u65b0\u9875\u9762\u770b\u4e0b\u5427\u3002")}})},_getExceptLiveBlockList:function(e,t){var i=e.slice(),a=t.data.tids,n={};if(a){for(var r=a.length-1;r>=0;r--){var o=a[r];n[o]=!0}for(r=i.length-1;r>=0;r--)n[i[r].id]&&i.splice(r,1)}return i},_getOnReportCloseFn:function(e,t,i){var a=this,n=i.length===e.data.tids.length?!1:!0;return t?function(){var t=a._getExceptLiveBlockList(i,e);a.requireInstance("ueglib/widget/block_user",[t,{ban_id:!0,ban_ip:!0},PageData.forum,PageData.tbs,function(){a._options.pagelet.refresh()}])}:n?function(){a._options.pagelet.refresh()}:function(){}},_report:function(e,t,i){var a=this,n=['<span style="color:#2d64b3">"',a._getTenStr(e.data.title),'"',"</span>",e.data.tids.length>1?"\u7b49"+e.data.tids.length+"\u4e2a\u8d34\u5b50":"",t?"\u5df2\u88ab\u4fdd\u62a4,\u65e0\u6cd5\u76f4\u63a5\u5220\u9664\u6216\u5c01\u7981,\u5982\u8d34\u5b50\u6709\u95ee\u9898\u8bf7\u76f4\u63a5\u4e3e\u62a5\u3002":"\u5df2\u88ab\u4fdd\u62a4,\u65e0\u6cd5\u76f4\u63a5\u5220\u9664,\u5982\u8d34\u5b50\u6709\u95ee\u9898\u8bf7\u76f4\u63a5\u4e3e\u62a5\u3002"].join("");a.requireInstanceAsync("common/widget/live_complaint",[],function(r){r.showReport({msg:n,tids:e.data.tids,onCloseFn:a._getOnReportCloseFn(e,t,i)})})},_getTenStr:function(e){return e?e.length>10?e.substr(0,10)+"...":e:""},getCaptcha:function(e,t){var i=this,a=i.requireInstanceAsync("poster/widget/captcha_dialog",[{title:"\u5220\u9664\u8d34\u5b50",message:"\u5220\u4e86\u90a3\u4e48\u591a\u8d34\u5b50\uff0c\u8f93\u4e2a\u7801\u9a8c\u8bc1\u4e0b\u8eab\u4efd\u5427~",vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,forumName:PageData.forum.name,forumId:PageData.forum.id,postType:"thread",paramsCallback:function(){return{}}}]);a.bind("onclose",function(){return a.hide(),!1}),a.bind("onaccept",function(){var e={vcode:a.getInputValue(),vcode_md5:a.getVCode()};i.deleteThread.call(i,t,e)}),a.show()},threadEasterEggsTrack:function(){var e=this.$_wrapper.find(".thread-easter-eggs-wrapper");e.siblings(".t_con").find(".j_threadlist_li_left").css("position","relative");var t={};e.each(function(){var e=$(this),i=e.data("skin-id");t[i]?t[i]++:t[i]=1});for(var i in t)$.stats.track("\u5c55\u793a","\u53d1\u5e16\u7279\u578b\u5c55\u793a\u6570\u91cf","frs","show",{show_count:t[i],skinId:i});this.$_wrapper.on("click",".thread-easter-eggs-wrapper",function(){var e=$(this),t=e.data("skin-id");$.stats.track("\u70b9\u51fb","\u53d1\u5e16\u7279\u578b\u5c55\u793a\u6570\u91cf","frs","click",{skinId:t})})},bindJoinVipStat:function(){$("#thread_list").find(".threadlist_author .pre_icon_wrap .icon_tbworld").on("click",function(){$.stats.track("\u7687\u51a0","\u4f1a\u5458\u5065\u5eb7\u7edf\u8ba1","","click",{obj_name:"FRS\u4e3b\u9898\u7528\u6237\u540d\u7687\u51a0\u70b9\u51fb"})})},bindPostSuccessEvents:function(){var e=this;this._options.pagelet.on("postSuccess",function(){e._options.pagelet.refresh()})},bindTopicEvent:function(){$(".topic-tag").off("click").on("click",function(e){e.preventDefault();var t=$(this).tbattr("data-name"),i=$.tb.location.getProtocol()+"//"+$.tb.location.getHostname()+($.tb.location.getPort()?":"+$.tb.location.getPort():"");window.open(i+"/hottopic/browse/hottopic?topic_name="+t)})}}});_.Module.define({path:"platform-activity/widget/iframeHead",sub:{initial:function(){this.$dom=$("#platform_iframe_head"),window._platform_iframe_head=this}}});_.Module.define({path:"platform-activity/widget/activityBtv",requires:[],sub:{initial:function(t){this.$root=$(t.root),this.bindEvents()},bindEvents:function(){var t=this,i=t.$root.find(".vedio_iframe"),a=t.$root.find(".btv_tab");a.on("click",function(t){var e=$(this);t.preventDefault(),a.removeClass("active"),e.addClass("active"),i.tbattr("src",$.tb.unescapeHTML(e.tbattr("data-src")))})}}});_.Module.define({path:"forum/widget/sign100",requires:["forum/widget/SignShai/FlashImageLoader"],sub:{_dom:null,_sign_num:null,_cvs:null,_src:null,_getTbsURL:"//tieba.baidu.com/dc/common/imgtbs",_uploadURL:"https://uploadphotos.baidu.com/upload/pic",initial:function(i,t){var e=this;this._dom=$("#"+i),this._sign_num=t,this._dom.find(".j_sign_100_shai").click(function(){e.render()})},_inputTitle:function(i){$("#edit_parent").find(".edit_title_field").val("\u5728\u672c\u5427\u5df2\u7d2f\u8ba1\u7b7e\u5230"+i+"\u5929\u4e86\uff0c\u622a\u56fe\u7559\u5ff5\u4e00\u4e0b\u4e0b")},render:function(){this.trigger("startRender"),this._createLoading();var i=this;this._inputTitle(i._sign_num),this._insertEditor()},_createLoading:function(){var i=this._dom.offset();$("body").append('<div id="shai_loading" ></div>'),$("#shai_loading").width(this._dom.width()),$("#shai_loading").height(this._dom.height()),$("#shai_loading").css({position:"absolute",left:i.left,top:i.top,"z-index":this._dom.css("z-index")+1})},_removeLoading:function(){$("#shai_loading").remove()},_getTbs:function(i){var t=this;$.ajax({url:t._getTbsURL,dataType:"json",success:function(t){t&&t.data&&t.data.tbs&&i&&_.isFunction(i)&&i(t.data.tbs)}})},_uploadImage:function(i){var t=this;t._getTbs(function(e){var o=i.toDataURL().replace(/^.*base64\,/,"");window.FlashImageLoader.bind("uploadComplete",t._uploadedHandler,t),window.FlashImageLoader.uploadBase64(t._uploadURL,o,{tbs:e})})},_uploadedHandler:function(i,t){var e=$.json.decode(t);if(0!=e.error_code)alert("\u56fe\u7247\u4e0a\u4f20\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5");else{var o=e.info.pic_id_encode;this._src="https://imgsa.baidu.com/forum/pic/item/"+o+".jpg",this._insertEditor()}window.FlashImageLoader.unbind("uploadComplete",this._uploadedHandler)},_insertEditor:function(){var i=this;this.trigger("completeRender"),this._removeLoading();var t=this._src;setTimeout(function(){window.rich_postor?(window.rich_postor._editor.execCommand("insertimage",t,6),window.rich_postor._editor.execCommand("insertlinebreak")):i.fire("insertimage",[{url:t,picType:6}])},300),$("#add_post_btn").click()}}});_.Module.define({path:"forum/widget/SignShai/FlashImageLoader",sub:{flashPath:"https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/static-frs/component/sign_shai/Base64ImageLoader.swf?v=1.0",flashObj:null,isReady:!1,options:null,initial:function(e){this.options=$.extend({},e)},_createFlash:function(){var e=this;if(!this.flashObj){var t=$('<div id="flash_img_loader" style="line-height: 0; font-size: 0px;"></div>');t.appendTo("body"),this.flashObj=new $.swf(this.flashPath,{container:t,width:1,height:1,params:{quality:"high",allowScriptAccess:"always",wMode:"transparent",swLiveConnect:!0,menu:!1},callBacks:{completeHandler:function(t){e._completeHandler(t)},errorHandler:function(t){e._errorHandler(t)},isReady:function(){return e._isReady()},flashReady:function(){e._flashReady()},uploadBase64Complete:function(t){e._uploadBase64Complete(t)},uploadBase64Error:function(){e._uploadBase64Error()}}})}},_completeHandler:function(e){"onComplete"in this.options&&"function"==typeof this.options.onComplete&&this.options.onComplete(e),this.trigger("loadComplete",e)},_errorHandler:function(e){"onError"in this.options&&"function"==typeof this.options.onError&&this.options.onError(e),this.trigger("loadError")},_isReady:function(){return!0},_flashReady:function(){this.isReady=!0,"onFlashReady"in this.options&&"function"==typeof this.options.onFlashReady&&this.options.onFlashReady(),this.trigger("flashReady")},_uploadBase64Complete:function(e){this.trigger("uploadComplete",e)},_uploadBase64Error:function(){this.trigger("uploadError")},_remote:function(){var e=this,t=arguments;this._createFlash(),this.isReady?e.flashObj.remote.apply(e.flashObj,t):this.bind("flashReady",function(){e.flashObj.remote.apply(e.flashObj,t)})},load:function(e){this._remote("loadImage",e)},uploadBase64:function(e,t,n){this._remote("uploadBase64",e,t,n)}}}),_.Module.use("frs/component/SignShai/FlashImageLoader",null,function(e){window.FlashImageLoader=e}),!function(e,t,n){"use strict";function i(t){d.logging&&e.console&&e.console.log&&e.console.log(t)}function a(e){return{zindex:e,children:[]}}function o(e,t){var n=[];return{storage:n,width:e,height:t,fillRect:function(){n.push({type:"function",name:"fillRect",arguments:arguments})},drawImage:function(){n.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){n.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(e,t){n.push({type:"variable",name:e,arguments:t})}}}var r,l,s,d={};d.Util={},d.Util.backgroundImage=function(e){return/data:image\/.*;base64,/i.test(e)||/^(-webkit|-moz|linear-gradient|-o-)/.test(e)?e:('url("'===e.toLowerCase().substr(0,5)?(e=e.substr(5),e=e.substr(0,e.length-2)):(e=e.substr(4),e=e.substr(0,e.length-1)),e)},d.Util.Bounds=function(e){var t,n={};return e.getBoundingClientRect?(t=e.getBoundingClientRect(),n.top=t.top,n.bottom=t.bottom||t.top+t.height,n.left=t.left,n.width=t.width||t.right-t.left,n.height=t.height||t.bottom-t.top,n):void 0},d.Util.getCSS=function(i,a){function o(e,t){var n,a=i.runtimeStyle&&i.runtimeStyle[e],o=i.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(t)&&/^-?\d/.test(t)&&(n=o.left,a&&(i.runtimeStyle.left=i.currentStyle.left),o.left="fontSize"===e?"1em":t||0,t=o.pixelLeft+"px",o.left=n,a&&(i.runtimeStyle.left=a)),/^(thin|medium|thick)$/i.test(t)?t:Math.round(parseFloat(t))+"px"}var s;if(e.getComputedStyle)r!==i&&(l=t.defaultView.getComputedStyle(i,null)),s=l[a],"backgroundPosition"===a&&(s=(s.split(",")[0]||"0 0").split(" "),s[0]=-1===s[0].indexOf("%")?o(a+"X",s[0]):s[0],s[1]=s[1]===n?s[0]:s[1],s[1]=-1===s[1].indexOf("%")?o(a+"Y",s[1]):s[1]);else if(i.currentStyle)if("backgroundPosition"===a)s=[o(a+"X",i.currentStyle[a+"X"]),o(a+"Y",i.currentStyle[a+"Y"])];else if(s=o(a,i.currentStyle[a]),/^(border)/i.test(a)&&/^(medium|thin|thick)$/i.test(s))switch(s){case"thin":s="1px";break;case"medium":s="0px";break;case"thick":s="5px"}return s},d.Util.BackgroundPosition=function(e,t,n){var i,a,o,r,l=d.Util.getCSS(e,"backgroundPosition");return 1===l.length&&(r=l,l=[],l[0]=r,l[1]=r),-1!==l[0].toString().indexOf("%")?(o=parseFloat(l[0])/100,a=t.width*o-n.width*o):a=parseInt(l[0],10),-1!==l[1].toString().indexOf("%")?(o=parseFloat(l[1])/100,i=t.height*o-n.height*o):i=parseInt(l[1],10),{top:i,left:a}},d.Util.Extend=function(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},d.Util.Children=function(e){var t;try{t=e.nodeName&&"IFRAME"===e.nodeName.toUpperCase()?e.contentDocument||e.contentWindow.document:function(e){var t=[];return null!==e&&!function(e,t){var i=e.length,a=0;if("number"==typeof t.length)for(var o=t.length;o>a;a++)e[i++]=t[a];else for(;t[a]!==n;)e[i++]=t[a++];return e.length=i,e}(t,e),t}(e.childNodes)}catch(a){i("html2canvas.Util.Children failed with exception: "+a.message),t=[]}return t},function(){d.Generate={};var e=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z-]+)([\w\d\.\s,%\(\)]+)\)$/];d.Generate.parseGradient=function(t,n){var i,a,o,r,l,s,d,h,c=e.length;for(a=0;c>a&&!(o=t.match(e[a]));a+=1);if(o)switch(o[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(i={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},l=o[2].match(/\w+/g))for(s=l.length,a=0;s>a;a+=1)switch(l[a]){case"top":i.y0=0,i.y1=n.height;break;case"right":i.x0=n.width,i.x1=0;break;case"bottom":i.y0=n.height,i.y1=0;break;case"left":i.x0=0,i.x1=n.width}if(null===i.x0&&null===i.x1&&(i.x0=i.x1=n.width/2),null===i.y0&&null===i.y1&&(i.y0=i.y1=n.height/2),l=o[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(s=l.length,d=1/Math.max(s-1,1),a=0;s>a;a+=1)h=l[a].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),h[2]?(r=parseFloat(h[2]),r/="%"===h[3]?100:n.width):r=a*d,i.colorStops.push({color:h[1],stop:r});break;case"-webkit-gradient":if(i={type:"radial"===o[2]?"circle":o[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},l=o[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),l&&(i.x0=l[1]*n.width/100,i.y0=l[2]*n.height/100,i.x1=l[3]*n.width/100,i.y1=l[4]*n.height/100),l=o[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(s=l.length,a=0;s>a;a+=1)h=l[a].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),r=parseFloat(h[2]),"from"===h[1]&&(r=0),"to"===h[1]&&(r=1),i.colorStops.push({color:h[3],stop:r});break;case"-moz-linear-gradient":if(i={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},l=o[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),l&&(i.x0=l[1]*n.width/100,i.y0=l[2]*n.height/100,i.x1=n.width-i.x0,i.y1=n.height-i.y0),l=o[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(s=l.length,d=1/Math.max(s-1,1),a=0;s>a;a+=1)h=l[a].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),h[2]?(r=parseFloat(h[2]),h[3]&&(r/=100)):r=a*d,i.colorStops.push({color:h[1],stop:r});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(i={type:"circle",x0:0,y0:0,x1:n.width,y1:n.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},l=o[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),l&&(i.cx=l[1]*n.width/100,i.cy=l[2]*n.height/100),l=o[3].match(/\w+/),h=o[4].match(/[a-z-]*/),l&&h)switch(h[0]){case"farthest-corner":case"cover":case"":var g=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.cy,2)),p=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.y1-i.cy,2)),u=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.y1-i.cy,2)),m=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.cy,2));i.rx=i.ry=Math.max(g,p,u,m);break;case"closest-corner":var g=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.cy,2)),p=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.y1-i.cy,2)),u=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.y1-i.cy,2)),m=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.cy,2));i.rx=i.ry=Math.min(g,p,u,m);break;case"farthest-side":"circle"===l[0]?i.rx=i.ry=Math.max(i.cx,i.cy,i.x1-i.cx,i.y1-i.cy):(i.type=l[0],i.rx=Math.max(i.cx,i.x1-i.cx),i.ry=Math.max(i.cy,i.y1-i.cy));break;case"closest-side":case"contain":"circle"===l[0]?i.rx=i.ry=Math.min(i.cx,i.cy,i.x1-i.cx,i.y1-i.cy):(i.type=l[0],i.rx=Math.min(i.cx,i.x1-i.cx),i.ry=Math.min(i.cy,i.y1-i.cy))}if(l=o[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(s=l.length,d=1/Math.max(s-1,1),a=0;s>a;a+=1)h=l[a].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),h[2]?(r=parseFloat(h[2]),r/="%"===h[3]?100:n.width):r=a*d,i.colorStops.push({color:h[1],stop:r})}return i},d.Generate.Gradient=function(e,n){var a,o,r,l,s,h=t.createElement("canvas"),c=h.getContext("2d");if(h.width=n.width,h.height=n.height,a=d.Generate.parseGradient(e,n),s=new Image,a)if("linear"===a.type){for(o=c.createLinearGradient(a.x0,a.y0,a.x1,a.y1),r=0,l=a.colorStops.length;l>r;r+=1)try{o.addColorStop(a.colorStops[r].stop,a.colorStops[r].color)}catch(g){i(["failed to add color stop: ",g,"; tried to add: ",a.colorStops[r],"; stop: ",r,"; in: ",e])}c.fillStyle=o,c.fillRect(0,0,n.width,n.height),s.src=h.toDataURL()}else if("circle"===a.type){for(o=c.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.rx),r=0,l=a.colorStops.length;l>r;r+=1)try{o.addColorStop(a.colorStops[r].stop,a.colorStops[r].color)}catch(g){i(["failed to add color stop: ",g,"; tried to add: ",a.colorStops[r],"; stop: ",r,"; in: ",e])}c.fillStyle=o,c.fillRect(0,0,n.width,n.height),s.src=h.toDataURL()}else if("ellipse"===a.type){var p,u=t.createElement("canvas"),m=u.getContext("2d"),f=Math.max(a.rx,a.ry),y=2*f;for(u.width=u.height=y,o=m.createRadialGradient(a.rx,a.ry,0,a.rx,a.ry,f),r=0,l=a.colorStops.length;l>r;r+=1)try{o.addColorStop(a.colorStops[r].stop,a.colorStops[r].color)}catch(g){i(["failed to add color stop: ",g,"; tried to add: ",a.colorStops[r],"; stop: ",r,"; in: ",e])}m.fillStyle=o,m.fillRect(0,0,y,y),c.fillStyle=a.colorStops[r-1].color,c.fillRect(0,0,h.width,h.height),p=new Image,p.onload=function(){c.drawImage(p,a.cx-a.rx,a.cy-a.ry,2*a.rx,2*a.ry),s.src=h.toDataURL()},p.src=u.toDataURL()}return s},d.Generate.ListAlpha=function(e){var t,n="";do t=e%26,n=String.fromCharCode(t+64)+n,e/=26;while(26*e>26);return n},d.Generate.ListRoman=function(e){var t,n=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],i=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],a="",o=n.length;if(0>=e||e>=4e3)return e;for(t=0;o>t;t+=1)for(;e>=i[t];)e-=i[t],a+=n[t];return a}}(),d.Parse=function(r,l){function s(){return{width:Math.max(Math.max(q.body.scrollWidth,q.documentElement.scrollWidth),Math.max(q.body.offsetWidth,q.documentElement.offsetWidth),Math.max(q.body.clientWidth,q.documentElement.clientWidth)),height:Math.max(Math.max(q.body.scrollHeight,q.documentElement.scrollHeight),Math.max(q.body.offsetHeight,q.documentElement.offsetHeight),Math.max(q.body.clientHeight,q.documentElement.clientHeight))}}function h(e,t){var n=parseInt(X(e,t),10);return isNaN(n)?0:n}function c(e,t,n,i,a,o){"transparent"!==o&&(e.setVariable("fillStyle",o),e.fillRect(t,n,i,a),G+=1)}function g(e,t){switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,function(e,t,n){return e.length>0?t+n.toUpperCase():void 0});case"uppercase":return e.toUpperCase();default:return e}}function p(e){return e.replace(/^\s*/g,"").replace(/\s*$/g,"")}function u(e,t){if(W[e+"-"+t]!==n)return W[e+"-"+t];var i,a,o,r=q.createElement("div"),l=q.createElement("img"),s=q.createElement("span");return r.style.visibility="hidden",r.style.fontFamily=e,r.style.fontSize=t,r.style.margin=0,r.style.padding=0,K.appendChild(r),l.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",l.width=1,l.height=1,l.style.margin=0,l.style.padding=0,l.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=t,s.style.margin=0,s.style.padding=0,s.appendChild(q.createTextNode("Hidden Text")),r.appendChild(s),r.appendChild(l),i=l.offsetTop-s.offsetTop+1,r.removeChild(s),r.appendChild(q.createTextNode("Hidden Text")),r.style.lineHeight="normal",l.style.verticalAlign="super",a=l.offsetTop-r.offsetTop+1,o={baseline:i,lineWidth:1,middle:a},W[e+"-"+t]=o,K.removeChild(r),o}function m(e,t,n,i){p(e).length>0&&(i.fillText(e,t,n),G+=1)}function f(e,t,n){var i,a,o,r,l,s,h,f,y,w,b,x,v,_=n.ctx,C=X(e,"fontFamily"),S=X(e,"fontSize"),R=X(e,"color"),T=X(e,"textDecoration"),M=X(e,"textAlign"),k=(X(e,"letterSpacing"),X(e,"fontWeight")),L=X(e,"fontStyle"),I=X(e,"fontVariant"),E=!1,A=0;if(t.nodeValue=g(t.nodeValue,X(e,"textTransform")),a=p(t.nodeValue),a.length>0){switch("none"!==T&&(o=u(C,S)),M=M.replace(["-webkit-auto"],["auto"]),r=t.nodeValue.split(""),parseInt(k,10)){case 401:k="bold";break;case 400:k="normal"}for(_.setVariable("fillStyle",R),_.setVariable("font",L+" "+I+" "+k+" "+S+" "+C),E?_.setVariable("textAlign","right"):_.setVariable("textAlign","left"),f=t,y=0,l=r.length;l>y;y+=1){if(h=null,P.rangeBounds)("none"!==T||0!==p(r[y]).length)&&(h=r[y],q.createRange?(w=q.createRange(),w.setStart(t,A),w.setEnd(t,A+h.length)):w=K.createTextRange(),i=w.getBoundingClientRect()?w.getBoundingClientRect():{});else{if("string"!=typeof f.nodeValue)continue;s=f.splitText(r[y].length),b=f.parentNode,x=q.createElement("wrapper"),v=f.cloneNode(!0),x.appendChild(f.cloneNode(!0)),b.replaceChild(x,f),i=d.Util.Bounds(x),h=f.nodeValue,f=s,b.replaceChild(v,x)}switch(null!==h&&m(h,i.left,i.bottom,_),T){case"underline":c(_,i.left,Math.round(i.top+o.baseline+o.lineWidth),i.width,1,R);break;case"overline":c(_,i.left,i.top,i.width,1,R);break;case"line-through":c(_,i.left,Math.ceil(i.top+o.middle+o.lineWidth),i.width,1,R)}A+=r[y].length}}}function y(e,t){var n,i,a=q.createElement("boundelement");return a.style.display="inline",n=e.style.listStyleType,e.style.listStyleType="none",a.appendChild(q.createTextNode(t)),e.insertBefore(a,e.firstChild),i=d.Util.Bounds(a),e.removeChild(a),e.style.listStyleType=n,i}function w(e){var t=-1,n=1,i=e.parentNode.childNodes;if(e.parentNode){for(;i[++t]!==e;)1===i[t].nodeType&&n++;return n}return-1}function b(e,t,n){var i,a,o,r,l,s=X(e,"listStylePosition"),h=X(e,"listStyleType"),c=X(e,"fontWeight");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(h)){switch(o=w(e),h){case"decimal":r=o;break;case"decimal-leading-zero":r=1===o.toString().length?o="0"+o.toString():o.toString();break;case"upper-roman":r=d.Generate.ListRoman(o);break;case"lower-roman":r=d.Generate.ListRoman(o).toLowerCase();break;case"lower-alpha":r=d.Generate.ListAlpha(o).toLowerCase();break;case"upper-alpha":r=d.Generate.ListAlpha(o)}switch(r+=". ",l=y(e,r),c){case 401:c="bold";break;case 400:c="normal"}if($.setVariable("fillStyle",X(e,"color")),$.setVariable("font",X(e,"fontVariant")+" "+c+" "+X(e,"fontStyle")+" "+X(e,"fontSize")+" "+X(e,"fontFamily")),"inside"!==s)return;$.setVariable("textAlign","left"),i=n.left,a=l.bottom,m(r,i,a,$)}}function x(e){var t=r[e];return t&&t.succeeded===!0?t.img:!1}function v(e,t){var n=Math.max(e.left,t.left),i=Math.max(e.top,t.top),a=Math.min(e.left+e.width,t.left+t.width),o=Math.min(e.top+e.height,t.top+t.height);return{left:n,top:i,width:a-n,height:o-i}}function _(e,t){var n;return t?"auto"!==e?(H=!0,n=a(e),t.children.push(n),n):t:n=a(0)}function C(e,t,n,i){var a,o,r,l,s,d,g,p=n.left,u=n.top,m=n.width,f=n.height,y=function(e){var t,n=[],i=["Top","Right","Bottom","Left"];for(t=0;4>t;t+=1)n.push({width:h(e,"border"+i[t]+"Width"),color:X(e,"border"+i[t]+"Color")});return n}(e);for(a=0;4>a;a+=1)if(o=y[a],o.width>0){switch(r=p,l=u,s=m,d=f-y[2].width,a){case 0:d=y[0].width;break;case 1:r=p+m-y[1].width,s=y[1].width;break;case 2:l=l+f-y[2].width,d=y[2].width;break;case 3:s=y[3].width}g={left:r,top:l,width:s,height:d},i&&(g=v(g,i)),g.width>0&&g.height>0&&c(t,r,l,g.width,g.height,o.color)}return y}function S(e,t,n){var a,o,r,l,s,d=q.createElement("valuewrap"),h=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"];for(a=0,l=h.length;l>a;a+=1){s=h[a];try{d.style[s]=X(e,s)}catch(c){i("html2canvas: Parse: Exception caught in renderFormValue: "+c.message)}}d.style.borderColor="black",d.style.borderStyle="solid",d.style.display="block",d.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(e.type)||"SELECT"===e.nodeName)&&(d.style.lineHeight=X(e,"height")),d.style.top=t.top+"px",d.style.left=t.left+"px",o="SELECT"===e.nodeName?e.options[e.selectedIndex].text:e.value,r=q.createTextNode(o),d.appendChild(r),K.appendChild(d),f(e,r,n),K.removeChild(d)}function R(e,t,n,i,a,o,r,l,s,d){e.drawImage(t,n,i,a,o,r,l,s,d),G+=1}function T(e,t,n,i,a,o,r,l){var s=0,d=0;r-n>0&&(s=r-n),l-i>0&&(d=l-i),R(e,t,s,d,a-s,o-d,n+s,i+d,a-s,o-d)}function M(e,t,n,i,a,o,r){var l,s,d=Math.min(t.width,o);for(n.top=n.top-Math.ceil(n.top/t.height)*t.height,s=a+n.top;r+a>s;)l=Math.floor(s+t.height)>r+a?r+a-s:t.height,T(e,t,i+n.left,s,d,l,i,a),s=Math.floor(s+t.height)}function k(e,t,n,i,a,o,r){var l,s,d=Math.min(t.height,r);for(n.left=n.left-Math.ceil(n.left/t.width)*t.width,s=i+n.left;o+i>s;)l=Math.floor(s+t.width)>o+i?o+i-s:t.width,T(e,t,s,a+n.top,l,d,i,a),s=Math.floor(s+t.width)}function L(e,t,n){var a,o,r,l,s,h,c,g,p,u,m,f,y=X(e,"backgroundImage"),w=X(e,"backgroundRepeat").split(",")[0];if(/data:image\/.*;base64,/i.test(y)||/^(-webkit|-moz|linear-gradient|-o-)/.test(y)||(y=y.split(",")[0]),"undefined"!=typeof y&&/^(1|none)$/.test(y)===!1)if(y=d.Util.backgroundImage(y),a=x(y),o=d.Util.BackgroundPosition(e,t,a),a)switch(w){case"repeat-x":k(n,a,o,t.left,t.top,t.width,t.height);break;case"repeat-y":M(n,a,o,t.left,t.top,t.width,t.height);break;case"no-repeat":l=t.width-o.left,p=t.height-o.top,s=o.left,h=o.top,c=o.left+t.left,g=o.top+t.top,0>s?(s=Math.abs(s),c+=s,l=Math.min(t.width,a.width-s)):(l=Math.min(l,a.width),s=0),0>h?(h=Math.abs(h),g+=h,p=Math.min(t.height,a.height-h)):(p=Math.min(p,a.height),h=0),p>0&&l>0&&R(n,a,s,h,l,p,c,g,l,p);break;default:for(o.top=o.top-Math.ceil(o.top/a.height)*a.height,r=t.top+o.top;r<t.height+t.top;)u=Math.min(a.height,t.height+t.top-r),m=Math.floor(r+a.height)>u+r?u+r-r:a.height,r<t.top?(f=t.top-r,r=t.top):f=0,k(n,a,o,t.left,r,t.width,m),f>0&&(o.top+=f),r=Math.floor(r+a.height)-f}else i("html2canvas: Error loading background:"+y)}function I(e,t){var n,a,r,g,p,u,m,f,y,w,T,M,k=d.Util.Bounds(e),I=k.left,E=k.top,A=k.width,U=k.height,F=X(e,"backgroundColor"),B=X(e,"position"),D=X(e,"opacity");switch(t?j={}:(j=s(),t={opacity:1}),a=_(X(e,"zIndex"),t.zIndex),r={ctx:o(j.width||A,j.height||U),zIndex:a,opacity:D*t.opacity,cssPosition:B},t.clip&&(r.clip=d.Util.Extend({},t.clip)),l.useOverflow===!0&&/(hidden|scroll|auto)/.test(X(e,"overflow"))===!0&&/(BODY)/i.test(e.nodeName)===!1&&(r.clip=r.clip?v(r.clip,k):k),g=a.children.push(r),u=a.children[g-1].ctx,u.setVariable("globalAlpha",r.opacity),p=C(e,u,k,!1),r.borders=p,Q.test(e.nodeName)&&"transparent"!==l.iframeDefault&&(F="default"===l.iframeDefault?"#efefef":l.iframeDefault),m={left:I+p[3].width,top:E+p[0].width,width:A-(p[1].width+p[3].width),height:U-(p[0].width+p[2].width)},r.clip&&(m=v(m,r.clip)),m.height>0&&m.width>0&&(c(u,m.left,m.top,m.width,m.height,F),L(e,m,u)),e.nodeName){case"IMG":f=e.getAttribute("src"),n=x(f),n?(y=h(e,"paddingLeft"),w=h(e,"paddingTop"),T=h(e,"paddingRight"),M=h(e,"paddingBottom"),R(u,n,0,0,n.width,n.height,I+y+p[3].width,E+w+p[0].width,k.width-(p[1].width+p[3].width+y+T),k.height-(p[0].width+p[2].width+w+M))):i("html2canvas: Error loading <img>:"+f);break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(e.type)&&e.value.length>0&&S(e,k,r);break;case"TEXTAREA":e.value.length>0&&S(e,k,r);break;case"SELECT":e.options.length>0&&S(e,k,r);break;case"LI":b(e,r,m);break;case"CANVAS":y=h(e,"paddingLeft"),w=h(e,"paddingTop"),T=h(e,"paddingRight"),M=h(e,"paddingBottom"),R(u,e,0,0,e.width,e.height,I+y+p[3].width,E+w+p[0].width,k.width-(p[1].width+p[3].width+y+T),k.height-(p[0].width+p[2].width+w+M))}return a.children[g-1]}function E(e,t){if("none"!==X(e,"display")&&"hidden"!==X(e,"visibility")&&(t=I(e,t)||t,$=t.ctx,!Q.test(e.nodeName))){var n,i,a,o=d.Util.Children(e);for(n=0,a=o.length;a>n;n+=1)i=o[n],1===i.nodeType?E(i,t):3===i.nodeType&&f(e,i,t)}}e.scroll(0,0);var A,U,F,B,D,$,j,z,O,N,P={rangeBounds:!1,svgRendering:l.svgRendering&&function(){var e=new Image,a=t.createElement("canvas"),o=a.getContext===n?!1:a.getContext("2d");if(o===!1)return!1;a.width=a.height=10,e.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{o.drawImage(e,0,0),a.toDataURL()}catch(r){return!1}return i("html2canvas: Parse: SVG powered rendering available"),!0}()},V=l.elements===n?t.body:l.elements[0],H=!1,G=0,W={},q=V.ownerDocument,Q=new RegExp("("+l.ignoreElements+")"),K=q.body;r=r||{},q.createRange&&(A=q.createRange(),A.getBoundingClientRect&&(U=q.createElement("boundtest"),U.style.height="123px",U.style.display="block",K.appendChild(U),A.selectNode(U),F=A.getBoundingClientRect(),B=F.height,123===B&&(P.rangeBounds=!0),K.removeChild(U)));var X=d.Util.getCSS;for(D=I(V,null),P.svgRendering&&!function(e){function t(e){var n,i,o,r,l,s=d.Util.Children(e),h=s.length;for(l=0;h>l;l+=1)if(r=s[l],3===r.nodeType)a+=r.nodeValue.replace(/\</g,"&lt;").replace(/\>/g,"&gt;");else if(1===r.nodeType&&!/^(script|meta|title)$/.test(r.nodeName.toLowerCase())){if(a+="<"+r.nodeName.toLowerCase(),r.hasAttributes())for(n=r.attributes,o=n.length,i=0;o>i;i+=1)a+=" "+n[i].name+'="'+n[i].value+'"';a+=">",t(r),a+="</"+r.nodeName.toLowerCase()+">"}}var n=new Image,i=s(),a="";t(e),n.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='"+i.width+"' height='"+i.height+"'>","<foreignObject width='"+i.width+"' height='"+i.height+"'>","<html xmlns='http://www.w3.org/1999/xhtml' style='margin:0;'>",a.replace(/\#/g,"%23"),"</html>","</foreignObject>","</svg>"].join(""),n.onload=function(){D.svgRender=n}}(t.documentElement),z=0,O=V.children,N=O.length;N>z;z+=1)E(O[z],D);return D.backgroundColor=X(t.documentElement,"backgroundColor"),D},d.Preload=function(a){function o(e){x.href=e,x.href=x.href;var t=x.protocol+x.host;return t===c}function r(){!m.firstRun&&m.numLoaded>=m.numTotal&&(i("Finished loading images: # "+m.numTotal+" (failed: "+m.numFailed+")"),"function"==typeof a.complete&&a.complete(m),m.numLoaded=0,m.numTotal=0,m.numFailed=0)}function l(t,n,i){d.proxyLoadQueue||(d.proxyLoadQueue={}),d.proxyLoadQueue[t]={img:n,imageObj:i},d.flashImageLoader||(d.flashImageLoader=e.FlashImageLoader,e.FlashImageLoader.bind("loadError",function(){if(d.proxyLoadQueue[imgURL]){var e=d.proxyLoadQueue[imgURL].imageObj;e.succeeded=!1,m.numLoaded++,m.numFailed++,r()}}),e.FlashImageLoader.bind("loadComplete",function(e,t){var n=t.url,i=t.data.base64,a="data:image/png;base64,"+i;if(d.proxyLoadQueue[n]){var o=d.proxyLoadQueue[n].img,r=d.proxyLoadQueue[n].imageObj;d.proxyLoadQueue[n]=null,delete d.proxyLoadQueue[n],r=m[n]={img:o},h(o,r),o.src=a.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,"")}})),e.FlashImageLoader.load(t)}function s(e){var t,a,o,l,h=d.Util.Children(e),c=!1;try{var p=h.length;for(t=0;p>t;t+=1)s(h[t])}catch(u){}try{c=e.nodeType}catch(f){c=!1,i("html2canvas: failed to access some element's nodeType - Exception: "+f.message)}if(1===c||c===n){try{a=d.Util.getCSS(e,"backgroundImage")}catch(u){i("html2canvas: failed to get background-image - Exception: "+u.message)}a&&"1"!==a&&"none"!==a&&(/^(-webkit|-o|-moz|-ms|linear)-/.test(a)?(l=d.Generate.Gradient(a,d.Util.Bounds(e)),l!==n&&(m[a]={img:l,succeeded:!0},m.numTotal++,m.numLoaded++,r())):(o=d.Util.backgroundImage(a.match(/data:image\/.*;base64,/i)?a:a.split(",")[0]),g.loadImage(o)))}}function h(t,i){t.onload=function(){i.timer!==n&&e.clearTimeout(i.timer),m.numLoaded++,i.succeeded=!0,t.onerror=t.onload=null,r()},t.onerror=function(){if("anonymous"===t.crossOrigin&&(e.clearTimeout(i.timer),a.proxy)){var n=t.src;return t=new Image,i.img=t,t.src=n,l(t.src,t,i),void 0}m.numLoaded++,m.numFailed++,i.succeeded=!1,t.onerror=t.onload=null,r()}}var c,g,p,u,m={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},f=a.elements[0]||t.body,y=f.ownerDocument,w="img"!=f.tagName.toLowerCase()?f.getElementsByTagName("img"):[f],b=w.length,x=y.createElement("a"),v=function(e){return e.crossOrigin!==n}(new Image);for(x.href=e.location.href,c=x.protocol+x.host,g={loadImage:function(t){var i,r;t&&m[t]===n&&(i=new Image,t.match(/data:image\/.*;base64,/i)?(i.src=t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),r=m[t]={img:i},m.numTotal++,h(i,r)):o(t)||a.allowTaint===!0?(r=m[t]={img:i},m.numTotal++,h(i,r),i.src=t):v&&!a.allowTaint&&a.useCORS?(i.crossOrigin="anonymous",r=m[t]={img:i},m.numTotal++,h(i,r),i.src=t,i.customComplete=function(){this.img.complete?this.img.onerror():this.timer=e.setTimeout(this.img.customComplete,100)}.bind(r),i.customComplete()):a.proxy&&(r=m[t]={img:i},m.numTotal++,l(t,i,r)))},cleanupDOM:function(o){var l,s;if(!m.cleanupDone){o&&"string"==typeof o?i("html2canvas: Cleanup because: "+o):i("html2canvas: Cleanup after timeout: "+a.timeout+" ms.");for(s in m)if(m.hasOwnProperty(s)&&(l=m[s],"object"==typeof l&&l.callbackname&&l.succeeded===n)){e[l.callbackname]=n;try{delete e[l.callbackname]}catch(d){}l.script&&l.script.parentNode&&(l.script.setAttribute("src","about:blank"),l.script.parentNode.removeChild(l.script)),m.numLoaded++,m.numFailed++,i("html2canvas: Cleaned up failed img: '"+s+"' Steps: "+m.numLoaded+" / "+m.numTotal)}e.stop!==n?e.stop():t.execCommand!==n&&t.execCommand("Stop",!1),t.close!==n&&t.close(),m.cleanupDone=!0,o&&"string"==typeof o||r()}},renderingDone:function(){u&&e.clearTimeout(u)}},a.timeout>0&&(u=e.setTimeout(g.cleanupDOM,a.timeout)),i("html2canvas: Preload starts: finding background-images"),m.firstRun=!0,s(f),i("html2canvas: Preload: Finding images"),p=0;b>p;p+=1)g.loadImage(w[p].getAttribute("src"));return m.firstRun=!1,i("html2canvas: Preload: Done."),m.numTotal===m.numLoaded&&r(),g},d.Renderer=function(e,n){function i(e){var t,n,o,r,l,s,d,h,c=[],g=[],p=e.children;for(t=0,l=p.length;l>t;t+=1)s=p[t],s.children&&s.children.length>0?(c.push(s),g.push(s.zindex)):a.push(s);for(g.sort(function(e,t){return e-t}),n=0,o=g.length;o>n;n+=1)for(r=g[n],d=0,h=c.length;h>=d;d+=1)if(c[d].zindex===r){s=c.splice(d,1),i(s[0]);break}}var a=[];if((new Date).getTime(),i(e.zIndex),"function"!=typeof n._renderer._create)throw new Error("Invalid renderer defined");return n._renderer._create(e,n,t,a,d)},s=function(t,a){var o,r,l=((new Date).getTime(),{logging:!1,elements:t,proxy:"http://html2canvas.appspot.com/",timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,iframeDefault:"default",ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,flashcanvas:n,width:null,height:null,taintTest:!0,renderer:"Canvas",clipRange:null});if(l=d.Util.Extend(a,l),"string"==typeof l.renderer&&d.Renderer[l.renderer]!==n)l._renderer=d.Renderer[l.renderer](l);else{if("function"!=typeof l.renderer)throw"Unknown renderer";l._renderer=l.renderer(l)}return d.logging=l.logging,l.complete=function(e){("function"!=typeof l.onpreloaded||l.onpreloaded(e)!==!1)&&(o=d.Parse(e,l),("function"!=typeof l.onparsed||l.onparsed(o)!==!1)&&(r=d.Renderer(o,l),"function"==typeof l.onrendered&&l.onrendered(r)))},e.setTimeout(function(){d.Preload(l)},0),{render:function(e,t){return d.Renderer(e,d.Util.Extend(t,l))},parse:function(e,t){return d.Parse(e,d.Util.Extend(t,l))},preload:function(e){return d.Preload(d.Util.Extend(e,l))},log:i}},s.log=i,s.Renderer={Canvas:n},d.Renderer.Canvas=function(a){a=a||{};var o,r=t,l=a.canvas||r.createElement("canvas"),s=!1,d=!1,h=!1,c=2880;if(l.getContext)i("html2canvas: Renderer: using canvas renderer"),h=!0;else if(a.flashcanvas!==n){s=!0,i("html2canvas: Renderer: canvas not available, using flashcanvas");var g=r.createElement("script");g.src=a.flashcanvas,g.onload=function(t,a){var o;return t.onload!==n?a:(t.onreadystatechange!==n?(o=function(){"loaded"!==t.readyState&&"complete"!==t.readyState?e.setTimeout(o,250):a()},e.setTimeout(o,250)):i("html2canvas: Renderer: Can't track when flashcanvas is loaded"),void 0)}(g,function(){"undefined"!=typeof e.FlashCanvas&&(i("html2canvas: Renderer: Flashcanvas initialized"),e.FlashCanvas.initElement(l),h=!0,d!==!1&&o._create.apply(null,d))}),r.body.appendChild(g)}return o={_create:function(e,a,o,r,g){if(!h)return d=arguments,l;var p,u,m,f,y,w,b,x,v,_=l.getContext("2d"),C=t.createElement("canvas"),S=C.getContext!==n,R=S?C.getContext("2d"):{},T=[];if(l.width=l.style.width=s?Math.min(c,a.width||e.ctx.width):a.width||e.ctx.width,l.height=l.style.height=s?Math.min(c,a.height||e.ctx.height):a.height||e.ctx.height,v=_.fillStyle,_.fillStyle=e.backgroundColor,_.fillRect(0,0,l.width,l.height),_.fillStyle=v,a.svgRendering&&e.svgRender!==n)_.drawImage(e.svgRender,0,0);else for((new Date).getTime(),u=0,m=r.length;m>u;u+=1){if(p=r.splice(0,1)[0],p.canvasPosition=p.canvasPosition||{},_.textBaseline="bottom",p.clip&&(_.save(),_.beginPath(),_.rect(p.clip.left,p.clip.top,p.clip.width,p.clip.height),_.clip()),p.ctx.storage)for(f=0,b=p.ctx.storage.length;b>f;f+=1)switch(x=p.ctx.storage[f],x.type){case"variable":_[x.name]=x.arguments;break;case"function":if("fillRect"===x.name)(!s||x.arguments[0]+x.arguments[2]<c&&x.arguments[1]+x.arguments[3]<c)&&_.fillRect.apply(_,x.arguments);else if("fillText"===x.name)(!s||x.arguments[1]<c&&x.arguments[2]<c)&&_.fillText.apply(_,x.arguments);else if("drawImage"===x.name&&x.arguments[8]>0&&x.arguments[7]){if(S&&a.taintTest&&-1===T.indexOf(x.arguments[0].src)){R.drawImage(x.arguments[0],0,0);try{R.getImageData(0,0,1,1)}catch(M){C=o.createElement("canvas"),R=C.getContext("2d");continue}T.push(x.arguments[0].src)}_.drawImage.apply(_,x.arguments)}}p.clip&&_.restore()}if(i("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),m=a.elements.length,1===m&&"object"==typeof a.elements[0]&&"BODY"!==a.elements[0].nodeName&&s===!1){var w=a.clipRange?a.clipRange:g.Util.Bounds(a.elements[0]);y=o.createElement("canvas"),y.width=w.width,y.height=w.height,_=y.getContext("2d");var k=l.getContext("2d"),L=k.getImageData(w.left,w.top,w.width,w.height);return _.putImageData(L,0,0),l=null,y}return l}}},e.html2canvas=s}(window,document),_.Module.define({path:"forum/widget/SignShai",requires:["forum/widget/SignShai/FlashImageLoader"],sub:{_dom:null,_txt:null,_cal:null,_sign_info:null,_cvs:null,_src:null,_getTbsURL:"//tieba.baidu.com/dc/common/imgtbs",_uploadURL:"https://uploadphotos.baidu.com/upload/pic",_signText:{1:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>1</span>\u4e2a\u7b7e\u5230\uff0c<br />\u4ee5\u8fc5\u96f7\u4e0d\u53ca\u63a9\u8033\u76d7\u94c3\u4e4b\u52bf\u62a2\u5f97\u5934\u7b7e\uff0c\u8d76\u7d27\u622a\u56fe\u7559\u5ff5~~",2:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>2</span>\u4e2a\u7b7e\u5230\uff0c<br />\u6162\u4e86\u90a3\u4e48\u4e00\u70b9\u70b9\u4e00\u70b9\u70b9\uff0c\u5c48\u5c45\u7b2c\u4e8c\uff0c\u660e\u5929\u6765\u62a2\u7b2c\u4e00~",3:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>3</span>\u4e2a\u7b7e\u5230\uff0c<br />\u5982\u5c0f\u674e\u98de\u5200\u822c\u7684\u901f\u5ea6\u6458\u5f97\u7b7e\u5230\u63a2\u82b1\uff0c\u597d\u8eab\u624b\u554a~",10:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>10</span>\u4e2a\u7b7e\u5230\uff0c<br />\u5341\u5168\u5341\u7f8e\u8bf4\u7684\u5c31\u662f\u6211\uff0c\u6709\u6728\u6709?\u6709\u6728\u6709\uff1f\u6709\u6728\u6709~",100:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>100</span>\u4e2a\u7b7e\u5230\uff0c<br />\u53e4\u6709\u767e\u6b65\u7a7f\u6768\uff0c\u54b1\u8fd9\u7b2c100\u4e2a\u7b7e\u5230\u4e5f\u4e0d\u5bb9\u6613\u54c8~~",222:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>222</span>\u4e2a\u7b7e\u5230\uff0c<br />\u4e00\u4e2a2\u662f\u5076\u7136\uff0c\u4e24\u4e2a2\u662f\u5076\u7136\uff0c\u4e09\u4e2a2\u5c31\u771f2\u4e86\u2026\u2026",250:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>250</span>\u4e2a\u7b7e\u5230\uff0c<br />\u676f\u4e86\u4e2a\u5177\u554a\uff0c\u8fd9\u4e2a\u6570\u5b57\u597d\u50cf\u6709\u70b9\u5c34\u5c2c\u54c8~~",2222:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>2222</span>\u4e2a\u7b7e\u5230\uff0c<br />\u8981\u4e0d\u8981\u8fd9\u4e48\u591a2\u554a\uff0c\u53c8\u4e0d\u662f\u6597\u5730\u4e3b\u51d1\u70b8\u5f39\uff0c\u4f24\u4e0d\u8d77~~",1000:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>1000</span>\u4e2a\u7b7e\u5230\uff0c<br />\u201c\u7b7e\u201d\u8f7d\u4e00\u523b\u96be\u9022\uff0c\u524d\u9762999\u4e2a\u4eba\u90fd\u6728\u6709\u62a2\u5230\u54e6~",9527:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>9527</span>\u4e2a\u7b7e\u5230\uff0c<br />\u636e\u8bf4\u8fd9\u662f\u4e2a\u5f88\u5185\u6db5\u7684\u6570\u5b57\uff0c\u5012\u8fc7\u6765\u770b\u770b\uff0c\u4f60\u61c2\u7684~",10000:"\u4eca\u65e5\u672c\u5427\u7b2c<span class='sign_index_num'>10000</span>\u4e2a\u7b7e\u5230\uff0c<br />10000\u554a\uff0c\u5c31\u51b2\u8fd9\u4e2a\u6570\uff0c\u9738\u6c14\u4fa7\u6f0f\u6709\u6728\u6709\uff01"},_signKeepText:{7:"\u8fde\u7eed\u5728\u672c\u5427\u7b7e\u52307\u5929\uff0c<br />\u4f60\u5df2\u7ecf\u8fde\u7eed\u7b7e\u52307\u5929\uff0c\u4e00\u5468\u90fd\u753b\u6ee1\u4e86\u5708\u5708\uff0c\u52a0\u6cb9\u5427~",30:"\u8fde\u7eed\u5728\u672c\u5427\u7b7e\u523030\u5929\uff0c<br />\u4f60\u5df2\u7ecf\u8fde\u7eed\u7b7e\u4e8630\u5929\uff0c\u622a\u4e2a\u56fe\u770b\u770b\u5728\u5427\u91cc\u795e\u9a6c\u6c34\u5e73~"},_titleText:"\u8fde\u7eed\u5728\u672c\u5427\u7b7e\u5230<keep>\u5929\uff0c\u6652\u4e0b\u7b7e\u5230\u6392\u540d\u7167\uff0c\u770b\u770b\u6211\u795e\u9a6c\u6c34\u5e73",initial:function(e,t){this._dom=$("#"+e),this._txt=this._dom.find(".sign_text_gray").eq(0),this._cal=this._dom.find(".j_succ_info").eq(0),this._sign_info=t,this._changeTxt()
},_changeTxt:function(){var e=this,t=this._sign_info.rank.toString(),n=this._sign_info.sign_keep.toString(),i=n in this._signKeepText||t in this._signText;n in this._signKeepText?this._txt.html(this._signKeepText[n].replace("<rank>",t.toString())):t in this._signText&&this._txt.html(this._signText[t]),i&&($.tb.Stats.sendRequest("https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_shai_display"}),this._txt.append('&nbsp;&nbsp;<button class="j_sign_shai sign_shai_btn" >&nbsp;</button>'),this._dom.find(".j_sign_shai").click(function(){e.render()}),this.bind("startRender",function(){e._dom.find(".j_sign_shai").unbind("click")}),this.bind("completeRender",function(){e._dom.find(".j_sign_shai").click(function(){e.render()})}))},_inputTitle:function(){$("#edit_parent").find(".edit_title_field").val(this._titleText.replace("<keep>",this._sign_info.sign_keep.toString()))},render:function(){this.trigger("startRender"),this._createLoading(),$.tb.Stats.sendRequest("https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_shai_render"});var e=this;if(this._dom.find(".signed_anime_day").removeClass("signed_anime_day").addClass("signed_day"),this._inputTitle(),e._src)this._insertEditor();else{var t=this._dom.offset(),n=this._cal.offset();$.extend(t,{right:t.left+this._dom.width(),bottom:t.top+this._dom.height()}),$.extend(n,{right:n.left+this._cal.width(),bottom:n.top+this._cal.height()});var i=Math.max(t.right,n.right)-Math.min(t.left,n.left),a=Math.max(t.bottom,n.bottom)-Math.min(t.top,n.top);html2canvas(e._dom,{onrendered:function(t){e._cvs=t,e._uploadImage(t)},clipRange:{left:Math.min(t.left,n.left)-1,top:Math.min(t.top,n.top)-1,width:i+12,height:a+2}})}},_createLoading:function(){var e=this._cal.offset();$("body").append('<div id="shai_loading" ></div>'),$("#shai_loading").width(this._cal.width()),$("#shai_loading").height(this._cal.height()),$("#shai_loading").css({position:"absolute",left:e.left,top:e.top,"z-index":this._cal.css("z-index")+1})},_removeLoading:function(){$("#shai_loading").remove()},_getTbs:function(e){var t=this;$.ajax({url:t._getTbsURL,dataType:"json",success:function(t){t&&t.data&&t.data.tbs&&e&&_.isFunction(e)&&e(t.data.tbs)}})},_uploadImage:function(e){var t=this;t._getTbs(function(n){var i=e.toDataURL().replace(/^.*base64\,/,"");window.FlashImageLoader.bind("uploadComplete",t._uploadedHandler,t),window.FlashImageLoader.uploadBase64(t._uploadURL,i,{tbs:n})})},_uploadedHandler:function(e,t){var n=$.json.decode(t);if(0!=n.error_code)alert("\u56fe\u7247\u4e0a\u4f20\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5");else{var i=n.info.pic_id_encode;this._src="https://imgsa.baidu.com/forum/pic/item/"+i+".jpg",this._insertEditor()}window.FlashImageLoader.unbind("uploadComplete",this._uploadedHandler)},_insertEditor:function(){var e=this;this.trigger("completeRender"),this._removeLoading();var t=this._src;setTimeout(function(){window.rich_postor?(window.rich_postor._editor.execCommand("insertimage",t,6),window.rich_postor._editor.execCommand("insertlinebreak")):e.fire("insertimage",[{url:t,picType:6}])},300),$("#add_post_btn").click()}}});_.Module.define({requires:["encourage-props/widget/ContSignCard","tbui/widget/LoginDialog","encourage-member/widget/join_vip_dialog","tbui/widget/bubble_tip","tbui/widget/Card","tbui/widget/CaptchaDialog","forum/widget/SignShai","forum/widget/sign100"],path:"forum/widget/sign_mod",sub:{_jq_wrap:null,_options:{},initial:function(n,i,e){this._jq_wrap=n,this._options=$.extend(this._options,i),this.signRank.options=i,this.signRank.pageUnitData=e,this.signRank.sign_init(n,this._options,this),this.signRank.pvLog()},signRank:{sign_url:"/sign/add",sign_forum:"/sign/info",get_url:"/sign/loadmonth",month_url:"/sign/month",sign_card:null,sign_year:null,sign_month:null,orign_year:null,orign_month:null,rights_tips:[null,null,null,null,null],mouseEventTimer:null,rightsTipsTimer:null,isReplenishing:!1,rplnBubble:null,resign_card_num:0,rpln_available_time:13858272e5,jq_wrap:null,_resignMap:{2280001:"\u60a8\u5c1a\u5728\u9ed1\u540d\u5355\u4e2d\uff0c\u4e0d\u80fd\u64cd\u4f5c",2280002:"\u4eb2\uff0c\u60a8\u5df2\u88ab\u5c01\u7981\uff0c\u7b7e\u5230\u6210\u529f\uff0c\u4f46\u65e0\u6cd5\u6da8\u7ecf\u9a8c\u54e6~",2280003:"\u7b7e\u5230\u592a\u9891\u7e41\u4e86\u70b9\uff0c\u4f11\u606f\u7247\u523b\u518d\u6765\u5427:)",2280004:"\u5f53\u524d\u7b7e\u5230\u4eba\u6570\u592a\u591a\uff0c\u8bf7\u7a0d\u540e\u518d\u7b7e",2280005:"\u7b7e\u5230\u592a\u9891\u7e41\u4e86\u70b9\uff0c\u4f11\u606f\u7247\u523b\u518d\u6765\u5427:)",2280006:"\u60a8\u5df2\u7ecf\u7b7e\u8fc7\u5230\u4e86\uff0c\u8bf7\u660e\u5929\u7ee7\u7eed\u7b7e\u5230^_^",2280007:"\u7b7e\u5230\u670d\u52a1\u5fd9\uff0c\u8bf7\u91cd\u65b0\u7b7e\u5230",2280008:"\u670d\u52a1\u5668\u6253\u76f9\u4e86\uff0c\u518d\u7b7e\u4e00\u6b21\u53eb\u9192\u5b83",2280009:"\u8be5\u7528\u6237\u6ca1\u6709\u7b7e\u5230",2280010:"\u670d\u52a1\u5668\u6253\u76f9\u4e86\uff0c\u518d\u7b7e\u4e00\u6b21\u53eb\u9192\u5b83",2280011:"\u670d\u52a1\u5668\u6253\u76f9\u4e86\uff0c\u518d\u7b7e\u4e00\u6b21\u53eb\u9192\u5b83",2280012:"\u8865\u7b7e\u5361\u4e0d\u8db3\uff0c\u8bf7\u5148\u8d2d\u4e70\u8865\u7b7e\u5361",2280013:"\u6570\u636e\u5e93\u8bbf\u95ee\u6210\u529f\uff0c\u4f46\u6570\u636e\u4e0d\u5b58\u5728",2280014:"\u8865\u7b7e\u5361\u4f7f\u7528\u6570\u636e\u91cf\u8d85\u8fc7\u9650\u5236\uff0c\u8bf7\u660e\u65e5\u7ee7\u7eed"},_getClientHtml:function(){return['<div class="sign_card">','<h2 class="sign_card_title">'+this.pageUnitData.sign_mod_card_title+"</h2>",'<div class="sign_card_detail">'+this.pageUnitData.sign_mod_card_detail+"</div>",'<a rel="noreferrer" href="https://tiebac.baidu.com/c/s/download/pc?src=webtb&t=2&tab=5#img5" target="_blank" class="sign_card_positive_btn">',this.pageUnitData.sign_mod_card_positive_btn+"</a>",'<a rel="noreferrer" href="/home/main?id='+PageData.user.portrait+'#scardsign" target="_blank" class="sign_card_sign_btn">'+this.pageUnitData.sign_mod_card_no_txt+"</a>","</div>"].join("")},sign_init:function(n,i,e){var s=this,t=this.jq_wrap=n;if(this.MODULE=e,"sign_rank"==$.cookie("add_sign")&&(i.isSignIn||s.showCardBeforeSign(),$.cookie("add_sign",null)),"true"==$.cookie("sign_not_now")&&(t.find(".j_signbtn").removeClass("j_cansign").addClass("signstar_ing"),setTimeout(function(){t.find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign")},1e4)),i.isSignIn)s.sign_resetdate(),s.sign_load_month(0),s.cal_mouseEnterOut(),setInterval(function(){s.refresh_sign_rank()},3e5);else{{var a=new Date;a.getDay()}t.find(".j_signbtn").addClass("j_cansign")}t.on("click",".j_cont_sign_card",function(n){n.preventDefault();var e=$(".j_sign_succ_keep").text(),t=$(".j_sign_succ_count").text();$(this).hasClass("j_need_judge")&&e==t?s.showAlreadyUsed($(this)):s.MODULE.requireInstance("encourage-props/widget/ContSignCard",[{userProp:$.getPageData("userProp",{},i)}])}),t.on("click",".j_onekey_btn",function(n){PageData.user.is_login||(n.preventDefault(),s.MODULE.requireInstance("tbui/widget/LoginDialog"))}),t.find(".j_btn_getmember").on("click",function(){var n=s.MODULE.requireInstance("encourage-member/widget/join_vip_dialog");return n.getMemberDialog(),!1}),t.on("click",".j_cansign",function(){if(PageData.user.is_login)PageData.user.is_black?s.show_block_sign_dialog():s.showCardBeforeSign();else{s.MODULE.requireInstance("tbui/widget/LoginDialog",["","",function(){$.cookie("add_sign","sign_rank",{expires:14}),$.tb.location.reload()}])}}),t.find(".j_calendar_month_prev").click(function(){var n=new Date(s.sign_year,s.sign_month-1,1),i=new Date(s.orign_year-2,s.orign_month-1,1),e=new Date(2012,6,1);n.getTime()<=i.getTime()||n.getTime()<=e.getTime()||s.set_sign_calendar("",s.sign_year,s.sign_month,-1)}),t.find(".j_calendar_month_next").click(function(){s.sign_year>s.orign_year||s.sign_year==s.orign_year&&s.sign_month>=s.orign_month||s.set_sign_calendar("",s.sign_year,s.sign_month,1)}),PageData.user.is_login&&(t.find(".j_sign_rights").show(),t.find(".j_sign_rights_icon").each(function(n,i){$(i).mouseover(function(){s.rightsTipsTimer=setTimeout(function(){s.sign_right_tips(n)},400)}).mouseout(function(){window.clearInterval(s.rightsTipsTimer),s.rightsTipsTimer=window.setTimeout(function(){null!=s.rights_tips[n]&&s.rights_tips[n].hideBubble()},10)})}));var r=PageData.user,_=r.mPaar_props&&r.mParr_props.level&&r.mParr_props.level.props_id>0&&r.mParr_props.level.end_time>+new Date/1e3,o="sign_box_bright_hover";o=i.hasClass?_?"sign_box_member_bright_hover":"sign_box_bright_hover":_?"sign_box_member_bright_noclass_hover":"sign_box_bright_noclass_hover";var g=t.find(".j_sign_box");g.hover(function(){$(this).addClass(o)},function(){$(this).removeClass(o)});var l=t.find(".j_sign_dir_tip"),d=l.html();l.html("");var c={content:d,arrow_dir:"up",bubble_css:{top:-12,left:i.hasClass?4:50,width:i.hasClass?"pb"==i.page?192:200:120,"text-align":"left"},arrow_pos:{right:i.hasClass?30:-9},attr:" id='tb_message_tip_n' ",wrap:l,closeBtn:!1},u=e.requireInstance("tbui/widget/bubble_tip",[c]),p=g.find(".j_signdir");p.bind("mouseenter",function(){l.show(),u.showBubble()}).bind("mouseleave",function(){u.hideBubble()});var h=$(".lack_sign_monthly_tip_card");t.find(".j_lack_sign_monthly_help").on("click",function(n){n.preventDefault(),h.fadeIn("fast")}).on("mouseleave",function(){h.timeout=setTimeout(function(){h.fadeOut("fast")},1e3)}),h.on("mouseenter",function(){clearTimeout(h.timeout),h.fadeIn("fast")}).on("mouseleave",function(){h.fadeOut("fast")}),t.find(".j_sign_tip_1key_icon").on("click",function(){$.stats.track("\u7b7e\u5230_\u4e00\u952e\u7b7e\u5230icon","\u7b7e\u5230\u6539\u9020",{obj_type:"\u7b7e\u5230",obj_url:$(this).tbattr("href")})})},showAlreadyUsed:function(n){this._alreadyUsedBb&&this._alreadyUsedBb.closeBubble();var i={content:"\u672c\u5427\u6240\u6709\u7b7e\u5230\u5df2\u7ecf\u8fde\u7eed\uff0c\u8bf7\u53bb\u522b\u7684\u5427\u770b\u770b",arrow_dir:"down",bubble_css:{top:-40,left:8,width:143,height:53},arrow_pos:{left:70},wrap:n.parent(),closeBtn:!0};this._alreadyUsedBb=this.MODULE.requireInstance("tbui/widget/bubble_tip",[i]),this._alreadyUsedBb.showBubble()},showCardBeforeSign:function(){var n=this,i=$(".j_signbtn");if("1"==$.cookie("showCardBeforeSign")||n.sign_card)n.sign_add();else{var e=n.MODULE.requireInstance("tbui/widget/Card",[{content:n._getClientHtml(),arrow_dir:"up",card_css:{width:197,top:i.offset().top+i.height()+11,left:i.offset().left},card_leave_hide:!0}]);n.sign_card=e,n.bindCardEvent(),e.showCard(),$.cookie("showCardBeforeSign","1",{expires:1})}},bindCardEvent:function(){var n=this;$(".sign_card_negative_btn").on("click",function(i){i.preventDefault(),n.sign_card&&n.sign_card._j_card.hide(),n.sign_add()})},sign_resetdate:function(){var n=new Date;this.sign_year=this.orign_year=n.getFullYear(),this.sign_month=this.orign_month=n.getMonth()+1},cal_mouseEnterOut:function(){var n=this,i=this.jq_wrap;i.find(".j_sign_replenish_button").off().on("click",function(e){e.preventDefault(),"none"==i.find(".j_succ_info").css("display")&&(n.orign_year!=n.sign_year||n.orign_month!=n.sign_month)&&(n.sign_resetdate(),n.sign_load_month(0)),window.clearInterval(n.mouseEventTimer),n.mouseEventTimer=setTimeout(function(){i.find(".j_succ_info").stop(!0,!0).show()},400)}),i.find(".j_signbtn,.j_succ_info").die().live({mouseout:function(){window.clearInterval(n.mouseEventTimer),n.mouseEventTimer=window.setTimeout(function(){i.find(".j_succ_info").fadeOut("slow")},200)},mouseover:function(){"none"==i.find(".j_succ_info").css("display")&&(n.orign_year!=n.sign_year||n.orign_month!=n.sign_month)&&(n.sign_resetdate(),n.sign_load_month(0)),window.clearInterval(n.mouseEventTimer),n.mouseEventTimer=setTimeout(function(){i.find(".j_succ_info").stop(!0,!0).show()},400)}})},cal_mouseEventRemove:function(){window.clearInterval(self.mouseEventTimer),this.jq_wrap.find(".j_signbtn,.j_succ_info").die()},sign_add:function(n){var i=this,e={kw:$.tb.escapeHTML(PageData.forum.name),tbs:PageData.tbs,ie:"utf-8"};$.extend(e,n),this.jq_wrap.find(".j_signbtn").removeClass("j_cansign").addClass("signstar_ing"),$.tb.post(i.sign_url,e,function(n){if(n&&1990055==n.no)i.jq_wrap.find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign"),$.tb.checkRealName();else if(!n||0!=n.no&&1104!=n.no)if(n&&2150040==n.no){var e=i.MODULE.requireInstance("tbui/widget/CaptchaDialog",[{message:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801\u5b8c\u6210\u7b7e\u5230",vCode:n.data.captcha_vcode_str,vCodeType:n.data.captcha_code_type,title:"\u7b7e\u5230",forumName:"",forumId:"",checkUrl:"/sign/checkVcode",vCodeUrl:"/sign/getVcode",paramsCallback:function(){return{tbs:PageData.tbs}}}]);e.bind("onaccept",function(){i.sign_add({captcha_input_str:e.getInputValue(),captcha_vcode_str:e.getVCode()})}),e.bind("onclose",function(){i.jq_wrap.find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign")}),e.show()}else{setTimeout(function(){i.jq_wrap.find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign")},1e4);var s=new Date;if(s.setTime(s.getTime()+1e4),$.cookie("sign_not_now",!0,{expires:s}),1007==n.no){var t=i.jq_wrap.find(".j_signbtn");t.removeClass().addClass("j_signbtn signstar_full")}else new $.dialog({html:"<div class='signmod_likeandsign_dialog'>"+(i._resignMap[n.no]||n.error)+"</div>",holderClassName:"passportDialog",title:"\u7b7e\u5230\u5931\u8d25",draggable:!1,width:338,height:87})}else{var a=n.data.uinfo,r=new Date(a.sign_time);i.sign_year=i.orign_year=r.getFullYear(),i.sign_month=i.orign_month=r.getMonth()+1,i.sign_load_month(1),i.options.isActivitySign&&$.tb.location.reload()}},"json")},sign_load_month:function(n,i,e){var s=this;$.tb.get(s.get_url,{kw:$.tb.escapeHTML(PageData.forum.name),ie:"utf-8",sign_y:i,sign_m:e,t:Math.random()},function(t){if(t&&0==t.no){s.jq_wrap.find(".j_signin_index").html(t.data.sign_user_info.rank),s.jq_wrap.find(".j_succ_text").html(s.succ_text(s.options.signForumInfo&&s.options.signForumInfo.current_rank_info.sign_rank,t.data.sign_user_info.rank,s.options.signForumInfo.forum_info&&s.options.signForumInfo.forum_info.level_1_dir_name,t.data.sign_user_info.sign_keep)),s.jq_wrap.find(".j_sign_succ_keep").html(t.data.sign_user_info.sign_keep),s.jq_wrap.find(".j_sign_succ_count").html(t.data.sign_user_info.sign_total),s.setReplenishInfo(t),$(".j_sign_month_lack_days").text(t.data.resign_info.mon_miss_sign_num),i&&e||(s.sign_resetdate(),s.set_sign_calendar(t)),s.signShai(t),s.check_rights_status(t.data.sign_user_info.sign_keep);var a=s.jq_wrap.find(".j_signbtn"),r=s.jq_wrap.find(".j_sign_box");if(r[0]&&r.addClass("sign_box_bright_signed"),a.removeClass().addClass("j_signbtn signstar_signed"),n){var _=t.data.sign_user_info.sign_keep;s.jq_wrap.find(".j_succ_info").show(),a.append('<span class="sign_keep_span">\u8fde\u7eed'+_+"\u5929</span>"),(30==_||100==_)&&s.sign_100({username:PageData.user.name,forumname:PageData.forum.name,memberCount:s.options.memberNumber,memberTitle:s.options.memberTitle,continueSign:_});var o={normal:[2,4],baidubrowser:[3,5],member:[8,10],seniormember:[12,14]},g=_>1?1:0,l="normal";try{l="baidubrowser.tieba"==window.external.GetVersion("version")?"baidubrowser":"normal"}catch(d){}if(PageData.user.mParr_props&&PageData.user.mParr_props.level){var c=PageData.user.mParr_props.level;1e3*c.end_time>+new Date&&(l=2==c.props_id?"seniormember":1==c.props_id?"member":"normal")}var u='<div style="position:absolute;"><div class="sign_plus_two">+'+o[l][g]+" \u7ecf\u9a8c</div></div>";s.options.isLike&&!s.options.isBlock&&(s.jq_wrap.find(".signed_day:last").append(u),setTimeout(function(){$(".sign_plus_two").show().animate({opacity:0,top:"-=20"},2500,function(){$(this).parent().remove()})},1e3)),"member"==l||"seniormember"==l?s.jq_wrap.find(".signed_day:last").removeClass("signed_day").addClass("signed_member_anime"):s.jq_wrap.find(".signed_day:last").removeClass("signed_day").addClass("signed_anime_day")}else s.jq_wrap.find(".j_sign_btn_keep").text(_);s.cal_mouseEnterOut()}},"json")},setReplenishInfo:function(n){var i=this.jq_wrap.find(".j_succ_info"),e=this.jq_wrap.find(".sign_keep_span"),s=0;e.length>0&&e.text("\u8fde\u7eed"+n.data.sign_user_info.sign_keep+"\u5929");var t=n.data.resign_info;s=this.resign_card_num=t.resign_card_num,$(".rpln_card_wrap").removeClass("rpln_card_wrap_2 rpln_card_wrap_3"),t.resign_card_num<=9||(t.resign_card_num>9&&t.resign_card_num<100?$(".rpln_card_wrap").addClass("rpln_card_wrap_2"):(s="99+",$(".rpln_card_wrap").addClass("rpln_card_wrap_3"))),i.find(".j_rpln_card_count").text(s),0==t.mon_miss_sign_num?this.jq_wrap.find(".j_need_rpln_wrap").text("\u672c\u6708\u5b8c\u7f8e\u7b7e\u5230"):this.jq_wrap.find(".j_need_rpln_wrap").html('\u672c\u6708\u6f0f\u7b7e<span class="j_lack_sign_monthly_count sign_num">'+t.mon_miss_sign_num+"</span>\u6b21")},refresh_sign_rank:function(){var n={kw:$.tb.escapeHTML(PageData.forum.name),ie:"utf-8",tbs:PageData.tbs};$.tb.get(this.sign_forum,n,function(n){var i=!1;try{var e=n}catch(s){i=!0}i||e&&0==e.no&&($(".j_today_signnum").html(e.data.forum_info.current_rank_info.sign_count),$(".j_signrank_index").html(e.data.forum_info.current_rank_info.sign_rank))})},show_block_sign_dialog:function(){var n=new $.dialog({html:"<div class='signmod_likeandsign_dialog'>\u5728\u672c\u5427\u7b7e\u5230\u9700\u8981\u5148\u6210\u4e3a\u4f1a\u5458\u54e6~\u52a0\u5165\u6211\u4eec\u5427\uff01</div><div class='signmod_likeandsign_btnzone'><input class='signmod_confirm_btn j_sign_confirm' type='button' value='\u77e5\u9053\u4e86' /></div>",holderClassName:"passportDialog",title:"\u672c\u5427\u7b7e\u5230",draggable:!1,width:338,height:87});$(n.element[0]).find(".j_sign_confirm").click(function(){n.close()})},succ_text:function(n,i,e,s){if(s){if(9==s)return"\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u5373\u53ef\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u52a0\u7c97\u529f\u80fd\uff0c\u660e\u5929\u4e0d\u8981\u5fd8\u4e86\u6765\u7b7e\u5230\u54e6\u3002";if(10==s)return"\u606d\u559c\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u52a0\u7c97\u529f\u80fd\uff0c\u53d1\u8d34\u70ab\u8000\u5427\uff01\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u54e6~";if(19==s)return"\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u5373\u53ef\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u53d8\u7ea2\u529f\u80fd\uff0c\u660e\u5929\u4e0d\u8981\u5fd8\u4e86\u6765\u7b7e\u5230\u54e6\u3002";if(20==s)return"\u606d\u559c\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u53d8\u7ea2\u529f\u80fd\uff0c\u53d1\u8d34\u70ab\u8000\u5427\uff01\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u54e6~";if(29==s)return"\u5df2\u8fde\u7eed\u7b7e\u523029\u5929\uff0c\u660e\u65e5\u7b7e\u5230\u5373\u53ef\u83b7\u5f97ID\u7ea2\u8272\u9ad8\u4eae\u6548\u679c\uff0c\u4e0d\u8981\u5fd8\u4e86\u54e6~";if(30==s)return"\u606d\u559c\u4f60\u83b7\u5f97ID\u7ea2\u8272\u9ad8\u4eae\u6548\u679c\uff0c\u8d76\u7d27\u53d1\u8d34\u70ab\u8000\u5427\u3002\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u54e6~"}var t;if(10>=i)switch(parseInt(i)){case 1:t="\u606d\u559c\u4f60\u62a2\u5f97\u672c\u5427\u4eca\u65e5\u7b7e\u5230\u7b2c1\u540d\uff0c\u8d76\u7d27\u622a\u56fe\u7559\u5ff5\u5427~~";break;case 2:t="\u672c\u5427\u4eca\u65e5\u7b7e\u5230\u7b2c1\u4eba\u88ab\u62a2\u8d70\u4e86\u2026\u2026\u660e\u5929\u518d\u6765\u65e9\u4e00\u70b9\u5427~";break;default:t="\u606d\u559c\u4f60\u540d\u5217\u672c\u5427\u4eca\u65e5\u7b7e\u5230\u524d10\uff0c\u83b7\u5f97\u201c\u672c\u5427\u5fe0\u8bda\u5427\u53cb\u201d\u79f0\u53f7~"}else if(100==i)t="\u54a6\uff0c\u4e00\u4e0d\u5c0f\u5fc3\u5c31\u8e29\u5230100\u4e86\uff0c\u4eca\u5929\u4f1a\u6709\u597d\u8fd0\u6c14\u5594~";else if(250==i)t="\u8bf7\u5728\u5fc3\u4e2d\u9ed8\u5ff53\u904d\uff1a\u6211\u4e0d\u662f250\u6211\u4e0d\u662f250\u6211\u4e0d\u662f250\u2026\u2026";else if(1e3==i)t="\u524d\u9762999\u4eba\u7684\u7ecf\u8fc7\uff0c\u53ea\u4e3a\u4e86\u6210\u5168\u4f60\u7684\u5706\u6ee1\u2026\u2026";else if(1e4==i)t="\u80fd\u8e29\u5230\u5982\u6b64\u5927\u6574\u5b9e\u5728\u662f\u4eba\u54c1\u7206\u68da\u554a\uff01\u53ef\u4ee5\u51fa\u95e8\u4e70\u5f69\u7968\u4e86~";else if(100>=n)switch(parseInt(n)){case 1:t="\u672c\u5427\u7b2c\u4e00\u7684\u5730\u4f4d\uff0c\u53c8\u7a33\u5b9a\u4e86\u7a33\u5b9a\u4e86\u7a33\u5b9a\u4e86\u2026\u2026";break;case 2:t="\u672c\u5427\u79bb\u7b2c\u4e00\u540d\u53c8\u8fd1\u4e86\u4e00\u70b9\u70b9\u70b9\u70b9\uff0c\u52a0\u6cb9\uff01";break;case 3:t="\u4fdd\u6301\u524d\u4e09\u540d\u4e0d\u5bb9\u6613\uff0c\u8bb0\u5f97\u660e\u5929\u8981\u6765\u7b7e\u5230\u54e6~~";break;default:t=10>=n?"\u524d\u5341\u540d\u7ade\u4e89\u6fc0\u70c8\uff0c\u8bb0\u5f97\u6bcf\u5929\u90fd\u6765\u7b7e\u5230\u54e6~":30>=n?"\u79bb\u524d\u5341\u540d\u8fd8\u6709\u4e9b\u8ddd\u79bb\uff0c\u5927\u5bb6\u6765\u5f97\u66f4\u52e4\u5feb\u4e9b\u5427~":"\u4e00\u767e\u5f3a\u7684\u5730\u4f4d\u9700\u8981\u5927\u5bb6\u7684\u5171\u540c\u52aa\u529b\uff0c\u52a0\u6cb9\uff01"}else t="\u8bb0\u5f97\u660e\u5929\u8981\u6765\u7b7e\u5230\u54e6\uff0c\u5e2e\u672c\u5427\u63d0\u5347\u6392\u540d~";return t},set_sign_calendar:function(n,i,e,s){function t(n){for(var i=n.data.sign_user_info.sign_month,e=["\uff0c\u7b7e\u5230\u7ecf\u9a8c+2\uff0c\u8fde\u7eed\u7b7e\u5230+4","\uff0c\u624b\u673a\u7b7e\u5230\u7ecf\u9a8c+3\uff0c\u8fde\u7eed\u7b7e\u5230+5","\uff0c\u767e\u5ea6\u6d4f\u89c8\u5668\u7b7e\u5230\u7ecf\u9a8c+3\uff0c\u8fde\u7eed\u7b7e\u5230+5","\uff0c\u767e\u5ea6\u624b\u673a\u6d4f\u89c8\u5668\u7b7e\u5230\u7ecf\u9a8c+4\uff0c\u8fde\u7eed\u7b7e\u5230+6","\uff0c\u7b7e\u5230\u7ecf\u9a8c+6\uff0c\u8fde\u7eed\u7b7e\u5230+8","\uff0c\u4f7f\u7528\u4f1a\u5458\u7b7e\u5230\u7ecf\u9a8c+8\uff0c\u8fde\u7eed\u7b7e\u5230+10","\uff0c\u4f7f\u7528\u9ad8\u7ea7\u4f1a\u5458\u7b7e\u5230\u7ecf\u9a8c+12\uff0c\u8fde\u7eed\u7b7e\u5230\u7ecf\u9a8c+14",""],s=0;s<i.length;s++){var t=i[s],a=t.t,g=a.substr(0,a.indexOf(":")),l=a.substr(a.indexOf(":")+1),d="\u4e8e"+g+"\u70b9"+l+"\u5206\uff0c\u7b2c"+t.rank+"\u4e2a\u7b7e\u5230";"00"==g&&"00"==l&&""==t.rank&&(d="\u989d\uff0c\u670d\u52a1\u5668\u8fd9\u5929\u6253\u76f9\u4e86\uff0c\u6ca1\u8bb0\u4f4f\u4f60\u662f\u51e0\u70b9\u7b7e\u5230\u7684\uff0c\u62b1\u6b49...");var c=parseInt(t.d);_.push(c);var u="signed_day",p=7;switch(t.sign_type){case"pc":p=0,u="signed_day";break;case"mobile":p=1,u="signed_mob_day";break;case"brs":p=2,u="signed_day";break;case"mobile_brs":p=3,u="signed_mob_day";break;case"mobile_client":p=4,u="signed_mob_day";break;case"member":p=5,u="signed_member";break;case"senior_member":p=6,u="signed_member"}var h=d+e[p];1==o.options.isBlock&&(u="",h=d+"\uff0c\u60a8\u5f53\u524d\u5df2\u88ab\u5c01\u7981\uff0c\u6682\u65e0\u7b7e\u5230\u7ecf\u9a8c"),t.is_resign&&(u="signed_rpln_day",h="\u8865\u7b7e\u6210\u529f\uff0c\u8865\u7b7e\u7ecf\u9a8c+"+t.sign_score),n.data.is_detail||(u="sign_gray",h=""),r.find(".j_d_"+c).addClass(u).tbattr({title:h})}}function a(){var n=r.find(".j_canlerdar_days"),i=n.find("td").filter(function(){return!$(this).hasClass("emptyDate")});if(i.each(function(n){var i=new Date(o.sign_year,o.sign_month-1,n+1);$.inArray(n+1,_)<0&&i<o.getEnvInitialTime()&&i>=Math.max(o.rpln_available_time,o.getEnvInitialTime()-2592e6)&&($(this).addClass("unsigned_day"),$.browser.mozilla&&$(this).children(".mozilla_td_hack").length<1&&$(this).append('<div class="mozilla_td_hack" style="position:absolute"></div>'))}),n.off().on("mouseenter",".unsigned_day",function(){$(this).addClass("unsigned_day_hover")}).on("mouseleave",".unsigned_day",function(){$(this).removeClass("unsigned_day_hover"),o.rplnBubble&&o.rplnBubble.closeBubble()}).on("click",".unsigned_day",function(){o.delReplenishSignGuide(),o.replenishSign($(this))}),"1"!==$.cookie("rpln_guide")){var e=i.filter(".unsigned_day").last();if(e.length>0){var s=parseInt(e.text()),t=new Date(o.sign_year,o.sign_month-1,s);t>=o.rpln_available_time&&(e.addClass("rpln_guide_day"),o.setReplenishSignGuide(e.parent().index()),$.cookie("rpln_guide","1",{expires:1e3}))}}}var r=this.jq_wrap,_=[],o=this;(""==i||"undefined"==typeof i)&&(i=this.sign_year),(""==e||"undefined"==typeof e)&&(e=this.sign_month),"undefined"!=typeof s&&(s=parseInt(s),0>s?(e-=1,0==e&&(i-=1,e=12)):s>0&&(e+=1,13==e&&(i+=1,e=1)));var g,l,d,c;g=new Date(i,e-1,1),l=new Date(i,e,0),d=g.getDay(),c=l.getDate(),r.find(".j_5, .j_6").css({display:"none"});for(var u=1;32>u;u++)r.find(".j_d_"+u).removeClass(function(n,i){var e=i.split(" ");return e.shift(),e.join(" ")}).tbattr({title:""});for(var p=0;7>p;p++)r.find(".j_1_"+p+", .j_5_"+p+", .j_6_"+p).html("&nbsp;").addClass("emptyDate");for(var h=1,p=d,u=1;c>0;p++,c--,u++)7==p&&(p=0,h++),5==h&&r.find(".j_5").css({display:""}),6==h&&r.find(".j_6").css({display:""}),r.find(".j_"+h+"_"+p).addClass("j_d_"+u).html(u).removeClass("emptyDate");this.sign_year=i,this.sign_month=e,"undefined"!=typeof n&&""!=n?(t(n),a(n)):$.tb.get(this.get_url,{kw:$.tb.escapeHTML(PageData.forum.name),ie:"utf-8",sign_y:i,sign_m:e},function(n){return n&&0==n.no?(t(n),o.setReplenishInfo(n),a(n),void 0):(alert(n.no),void 0)},"json"),String(e).length<2&&(e+="",e="0"+e);var m=i+"\u5e74"+e+"\u6708";if(r.find(".j_calendar_month").html(m),this.sign_month==this.orign_month&&this.sign_year==this.orign_year){var b=r.find(".j_d_"+(new Date).getDate());if(b.hasClass("signed_day")||b.hasClass("signed_mob_day")||b.hasClass("signed_member"));else{var f=$(".j_signin_index").html();b.addClass("signed_day").tbattr({title:"\u4e8e"+(new Date).getHours()+"\u70b9"+(new Date).getMinutes()+"\u5206\uff0c\u7b2c"+f+"\u4e2a\u7b7e\u5230\uff0c\u7b7e\u5230\u7ecf\u9a8c+2\uff0c\u8fde\u7eed\u7b7e\u5230+4"})}}},setReplenishSignGuide:function(n){if(!this.$guide_mask){this.$guide_mask_close=$('<div class="rpln_guide_close">X</div>'),this.$guide_mask=$('<div class="rpln_guide">'),this.$guide_text=$('<div class="rpln_guide_txt">');var i=this.jq_wrap.find(".sign_succ_calendar");this.$guide_text.css("top",26*(n+1)),i.prepend(this.$guide_text).prepend(this.$guide_mask).prepend(this.$guide_mask_close),this.$guide_mask_close.on("click",$.proxy(this.delReplenishSignGuide,this))}},delReplenishSignGuide:function(){this.$guide_mask_close&&this.$guide_mask_close.remove(),this.$guide_mask&&this.$guide_mask.remove(),this.$guide_text&&this.$guide_text.remove()},getEnvInitialTime:function(){var n=new Date;return n.setHours(0),n.setMinutes(0),n.setSeconds(0),n},replenishSign:function(n){var i,e,s,t,a,r,_,o,g=this;if(i=parseInt(n.text()),e=new Date(this.sign_year,this.sign_month-1,i),s=g.getEnvInitialTime(),t=(s-e)/864e5,a=0,2>=t)a=1;else if(10>=t)a=2;else if(20>=t)a=3;else{if(!(30>=t))throw"\u53ef\u7b7e\u5230\u5929\u6570\u4e0d\u5e94\u5927\u4e8e30\u5929";a=4}if(g.rplnBubble&&g.rplnBubble.closeBubble(),$.isNumeric(i)&&!(e>s-864e5)){var l={arrow_dir:"down",bubble_css:{top:-50,left:-61,width:143,height:53},arrow_pos:{left:70},wrap:n,closeBtn:!1};o={top:-19,left:-34,width:110,height:20},buy_arrow_pos={left:54},r='<div class="rpln_tip">\u8865\u7b7e\u672c\u6b21\u9700\u6d88\u8017<span class="rpln_card_needed_count">'+a+'\u5f20</span>\u8865\u7b7e\u5361<br><a rel="noreferrer" class="yes_btn">\u786e\u5b9a</a><a rel="noreferrer" class="cancel_btn">\u53d6\u6d88</a></div>',_='<div class="rpln_tip">\u8fd8\u9700\u8981'+parseInt(a-this.resign_card_num)+'\u5f20\u8865\u7b7e\u5361\uff0c\u53bb<a rel="noreferrer" target="_blank" class="tbmall_link" href="/tbmall/propslist?category=108">\u5546\u57ce\u8d2d\u4e70\u5427</a>>></div>',$.browser.mozilla&&(l.wrap=n.children(".mozilla_td_hack"),l.bubble_css.top=-74,o.top=-43),this.resign_card_num>=a?l.content=r:(l.content=_,l.bubble_css=o,l.arrow_pos=buy_arrow_pos),g.rplnBubble=g.MODULE.requireInstance("tbui/widget/bubble_tip",[l]),g.rplnBubble.j_bubble.on("click",".yes_btn",function(){g.isReplenishing||(g.isReplenishing=!0,$.tb.post("/sign/resign",{kw:$.tb.escapeHTML(PageData.forum.name),tbs:PageData.tbs,ie:"utf-8",sign_y:g.sign_year,sign_m:g.sign_month,sign_d:i},function(i){g.isReplenishing=!1,n.removeClass("unsigned_day_hover"),i?0==i.no||2280002==i.no?(n.removeClass("unsigned_day unsigned_day_hover").addClass("signed_rpln_anime"),g.rplnBubble.closeBubble(),g.options.isLike&&!g.options.isBlock&&(n.append('<div style="position:absolute;"><div class="sign_plus">+'+5*a+" \u7ecf\u9a8c</div></div>"),n.find(".sign_plus").show().animate({opacity:0,top:"-=20"},2500,function(){$(this).parent().remove()})),n.tbattr("title","\u4e8e"+((new Date).getMonth()+1)+"\u6708"+(new Date).getDate()+"\u65e5\u8865\u7b7e\u6210\u529f\uff0c\u8865\u7b7e\u7ecf\u9a8c+"+5*a),g.sign_load_month(0,g.sign_year,g.sign_month)):(g.rplnBubble&&g.rplnBubble.closeBubble(),l.content=g._resignMap[i.no]||"\u54ce\u5440~\u670d\u52a1\u5668\u6253\u76f9\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5~",l.bubble_css=o,l.arrow_pos=buy_arrow_pos,g.rplnBubble=g.MODULE.requireInstance("tbui/widget/bubble_tip",[l]),g.rplnBubble.showBubble()):(g.rplnBubble&&g.rplnBubble.closeBubble(),l.content="\u54ce\u5440~\u670d\u52a1\u5668\u6253\u76f9\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5~",l.bubble_css=o,l.arrow_pos=buy_arrow_pos,g.rplnBubble=g.MODULE.requireInstance("tbui/widget/bubble_tip",[l]),g.rplnBubble.showBubble())}))}).on("click",".cancel_btn",function(){n.removeClass("unsigned_day_hover"),g.rplnBubble.closeBubble()}),g.rplnBubble.showBubble()}},pvLog:function(){$("#sign_music_rank").on("click",function(){$.stats.track("music_rank","\u7b7e\u5230")})},signShai:function(n){var i=this,e=null!=navigator.userAgent.match(/iPad/i);if(void 0!=document.createElement("canvas").getContext&&!$.browser.mozilla&&!e){var s=i.MODULE.requireInstance("forum/widget/SignShai",["sign_mod",n.data.sign_user_info]);s.bind("startRender",function(){i.cal_mouseEventRemove()}),s.bind("completeRender",function(){i.cal_mouseEnterOut()})}},sign_100:function(n){var i=this;if(n){var e=new Date,s=e.getFullYear()+"\u5e74"+(e.getMonth()+1)+"\u6708"+e.getDate()+"\u65e5",t="";t="<div class='sign_100_dlg'><div class='sign_100_"+n.continueSign+"'></div><div class='sign_100_text'><div class='sign_100_close'></div><div class='sign_100_title'>\u4eb2\u7231\u7684"+n.username+"</div>",t=100==n.continueSign?t+"<div class='sign_100_content'>\u4eca\u5929\u662f\u4f60\u5728\u54b1\u4eec<span class='sign_baname_highlight'>"+n.forumname+"</span>\u5427\u7b7e\u5230\u7684<span class='rank_number'>\u7b2c"+n.continueSign+"\u5929</span>\uff0c\u503c\u5f97\u7eaa\u5ff5\u7684\u65e5\u5b50\uff0c\u6709\u6728\u6709\uff01<br/>\u65f6\u95f4\u8fc7\u5f97\u771f\u5feb\u54c8\uff0c\u4ece\u7b2c\u4e00\u6b21\u7b7e\u5230\u5230\u73b0\u5728\uff0c\u5df2\u6709"+n.continueSign+"\u4e2a\u503c\u5f97\u56de\u5473\u7684\u65e5\u65e5\u591c\u591c\u5728\u8fd9\u91cc\u7559\u5b58\u3002<br/>\u8ba9\u6211\u4eec\u611f\u5230\u5f00\u5fc3\u7684\u662f\uff0c\u4f60\u4ecd\u7136\u662f\u54b1\u4eec<span class='sign_baname_highlight'>"+n.forumname+"</span>\u5427\u7684"+n.memberCount+"\u4e2a<span class='sign_baname_highlight'>"+n.memberTitle+"</span>\u4e2d\u575a\u5b9e\u7684\u4e00\u4efd\u5b50\u3002<br/>\u4eca\u5929\uff0c\u7b7e\u5230"+n.continueSign+"\u5929\uff1b\u6b64\u540e\uff0c\u8ba9\u6211\u4eec\u4f9d\u7136\u5171\u540c\u6210\u957f\uff0c\u5e76\u5feb\u4e50\u3002<br/></div>":t+"<div class='sign_100_content'>\u77e5\u9053\u5417\uff0c\u4eca\u5929\u662f\u4f60\u5728\u54b1\u4eec<span class='sign_baname_highlight'>"+n.forumname+"</span>\u5427\u7b7e\u5230\u7684<span class='rank_number'>\u7b2c"+n.continueSign+"\u5929</span>\uff0c\u6574\u6574\u4e00\u4e2a\u6708\u5566\uff01<br/>\u65f6\u95f4\u8fc7\u5f97\u633a\u5feb\u7684\u54c8\uff0c\u4ece\u4f60\u7b2c\u4e00\u6b21\u5230\u672c\u5427\u7b7e\u5230\uff0c\u70b9\u4e0e\u4e0d\u70b9\u95f4\uff0c\u5728\u8d34\u5427\u5ea6\u8fc7\u4e86"+n.continueSign+"\u4e2a\u7f8e\u597d\u7684\u65e5\u5b50\u3002<br/>\u4eca\u540e\u7684\u8def\u8fd8\u957f\u7740\u5462\uff0c\u8877\u5fc3\u5e0c\u671b\u4f60\u5728<span class='sign_baname_highlight'>"+n.forumname+"</span>\u5427\u7684\u6bcf\u4e00\u5929\u90fd\u80fd\u5f00\u5fc3\uff0c\u4e0e\u5168\u4f53\u5427\u53cb\u4eec\u76f8\u77e5\u76f8\u7231\u3002<br/>\u4eca\u5929\uff0c\u7b7e\u5230\u6ee1\u6708\uff1b\u6b64\u540e\uff0c\u8ba9\u6211\u4eec\u4f9d\u7136\u5171\u540c\u6210\u957f\u3002<br/></div>",t=t+"<div class='sign_100_message'><a rel='noreferrer' href='/i/sys/jump?un=%CC%F9%B0%C9%C7%A9%B5%BD%D0%A1%C3%D8%CA%E9' target='_blank'>\u8d34\u5427\u7b7e\u5230\u5c0f\u79d8\u4e66</a><img src='//tb2.bdstatic.com/tb/img/itieba_vip.gif' title='\u8d34\u5427\u5b9e\u540d\u8ba4\u8bc1' class='verified_icon'>&nbsp;&nbsp;&nbsp;&nbsp;"+s+"&nbsp;&nbsp;&nbsp;&nbsp;<button class='j_sign_100_shai sign_100_shai_btn'>&nbsp;</button></div></div></div>";var a=new $.dialog({html:t,holderClassName:"sign_100_wapper",width:"681",showTitle:!1});$(a.element[0]).find(".sign_100_close").click(function(){a.close()});var r=null!=navigator.userAgent.match(/iPad/i);if(void 0!=document.createElement("canvas").getContext&&!$.browser.mozilla&&!r){$(".j_sign_100_shai").show();var _=i.MODULE.requireInstance("forum/widget/sign100",["dialogJbody",n.continueSign]);_.bind("completeRender",function(){a.close()})}}},sign_right_tips:function(n){for(var i=[],e=[],s=[],n=0;5>n;n++)i.push(this.pageUnitData["sign_mod_tiptitle"+(n+1)]),e.push(this.pageUnitData["sign_mod_tiptext"+(n+1)]),s.push(this.pageUnitData["sign_mod_tipcondition"+(n+1)]);$(".j_sign_rights").css("position","relative").css("z-index","1");var t=[43,77,114,145,175],a=n+1,r={icon:"sign_big_icon_"+a,title:i[n],text:e[n],condition:s[n],position_right:13,arr_right:t[n]},_={content:"<div class='sign_rights_tip'><div class='sign_rights_top clearfix'><div class='sign_rights_big_icon "+r.icon+"'></div><div class='sign_rights_text_wapper'><div class='sign_rights_title'>"+r.title+"</div><div class='sign_rights_title_text'>"+r.text+"</div></div></div><div class='sign_rights_popline'></div><div class='sign_rights_condition'>"+r.condition+"</div></div>",arrow_dir:"up",bubble_css:{top:35,right:r.position_right,width:250,"z-index":9999},arrow_pos:{left:r.arr_right},attr:" ",wrap:$(".j_sign_rights"),closeBtn:!1};if(null===this.rights_tips[n]){var o=this.MODULE.requireInstance("tbui/widget/bubble_tip",[_]);o.showBubble(),this.rights_tips[n]=o}else this.rights_tips[n].showBubble()},check_rights_status:function(n){$(".j_sign_rights_icon:eq(0)").addClass("rights_get"),n>=2&&$(".j_sign_rights_icon:eq(1)").addClass("rights_get"),n>=10&&$(".j_sign_rights_icon:eq(2)").addClass("rights_get"),n>=20&&$(".j_sign_rights_icon:eq(3)").addClass("rights_get"),n>=30&&$(".j_sign_rights_icon:eq(4)").addClass("rights_get")}}}});_.Module.define({path:"navigation/widget/navigator",sub:{initial:function(t,i){this.support=!!(window.history&&window.history.pushState&&i),this.initialEvent(t)},initialEvent:function(t){var i=this,n=this.initialTabLocker(!1);$(".j_nav_list").on("click","a.j_nav_local_tab_link",function(){var t=this;if(i.support){if(!n.isLock()){n.lock();var o=$.tb.unescapeHTML($(t).tbattr("href"));Bigpipe.broadcast("router_handle",{url:o})}return!1}}),t.on("tab_change_finish",function(t){n.unlock();var i=t.tab||"main",o=$("#tb_nav"),a=o.find(".j_tbnav_tab[data-tab-"+i+"]");o.find(".j_tbnav_tab.focus").removeClass("focus"),a.length>0?a.addClass("focus"):void 0})},initialTabLocker:function(t,i){var n=!1,i=i||100,o=null,a=function(t){n=!!t};return a.prototype.isLock=function(){return n},a.prototype.lock=function(){var t=this;return n=!0,o&&clearTimeout(o),o=setTimeout(function(){t.unlock()},i),this},a.prototype.unlock=function(){return n=!1,this},new a}}});_.Module.define({path:"navigation/widget/search_handler",sub:{_staticUrl:{no_key:"//tieba.baidu.com/","\u8d34\u5427\u6295\u8bc9":"//tieba.baidu.com/tousu/new","\u5e16\u5427\u6295\u8bc9":"//tieba.baidu.com/tousu/new",tiebatousu:"//tieba.baidu.com/tousu/new","\u8d34\u5427\u6295\u8bc9\u5427":"//tieba.baidu.com/tousu/new","\u8d34\u5427\u6295\u8bc9\u4e2d\u5fc3":"//tieba.baidu.com/tousu/new","\u6295\u8bc9\u4e2d\u5fc3":"//tieba.baidu.com/tousu/new","\u6295\u8bc9":"//tieba.baidu.com/tousu/new","\u8d34\u5427\u4e3e\u62a5":"//tieba.baidu.com/tousu/new","\u77e5\u9053\u6295\u8bc9":"http://tousu.baidu.com/zhidao","\u7a7a\u95f4\u6295\u8bc9":"http://tousu.baidu.com/hi","\u767e\u79d1\u6295\u8bc9":"http://tousu.baidu.com/baike",zhidaotousu:"http://tousu.baidu.com/zhidao",kongjiantousu:"http://tousu.baidu.com/hi",baiketousu:"http://tousu.baidu.com/baike"},_sendStatistics:function(t){$.stats.sendRequest("st_mod=search&search_type="+t)},initial:function(){},toStaticUrl:function(t){var e=t.toLowerCase();return this._staticUrl.hasOwnProperty(e)?($.tb.location.setHref(this._staticUrl[e]),!1):void 0},enterBa:function(t,e){if(""==t)return $.tb.location.setHref(this._staticUrl.no_key),!1;this.toStaticUrl(t);var s=[];if(s=-1!=t.indexOf("\uff1a")?t.split("\uff1a"):t.split(":"),2==s.length){if("\u6807\u7b7e"==s[0])return this._sendStatistics("tagsearch",t),$.tb.location.setHref("/f/search/fm?ie=utf-8&tag="+encodeURIComponent($.tb.escapeHTML(s[1]))),!1;if(-1!=s[0].indexOf("\u5427\u5185")){var o=s[0].split("\u5427\u5185")[0];if(o)return this._sendStatistics("baneisearch",t),$.tb.location.setHref("/f/search/res?ie=utf-8&kw="+encodeURIComponent($.tb.escapeHTML(o))+"&qw="+encodeURIComponent($.tb.escapeHTML(s[1]))),!1}}if(PageData.search_what&&"fromBtn"!=e){if("composite"==PageData.search_what)return this._sendStatistics("compositesearch",t),$.tb.location.setHref("/f/search/res?ie=utf-8&qw="+encodeURIComponent($.tb.escapeHTML(t))),!1;if("forum"==PageData.search_what)return this._sendStatistics("forumsearch",t),$.tb.location.setHref("/f/search/fm?ie=utf-8&qw="+encodeURIComponent($.tb.escapeHTML(t))),!1}return this._sendStatistics("enterba&from=search",t),$.tb.location.setHref("/f?ie=utf-8&kw="+encodeURIComponent(t)+"&fr=search"),!1},searchPost:function(t){return window.history_search_post||(PageData.user.is_login&&$.tb.post("/f/search/addWord",{word:$.tb.escapeHTML(t)},function(t){0==t.no&&(window.history_search_post=!1)}),window.history_search_post=!0),this._sendStatistics("postsearch",t),setTimeout(function(){$.tb.location.setHref("/f/search/res?ie=utf-8&qw="+encodeURIComponent($.tb.escapeHTML(t)))},100),!1},searchPostInBa:function(t,e){var s="/f/search/res?ie=utf-8&kw="+encodeURIComponent($.tb.escapeHTML(e))+"&qw="+encodeURIComponent($.tb.escapeHTML(t));return window.history_search_post||(PageData.user.is_login&&$.tb.post("/f/search/addWord",{word:$.tb.escapeHTML(t)},function(t){0==t.no&&(window.history_search_post=!1)}),window.history_search_post=!0),this._sendStatistics("baneisearch",t),setTimeout(function(){$.tb.location.setHref(s)},100),!1},searchPeople:function(t){return this._sendStatistics("peoplesearch",t),$.tb.location.setHref("/f/search/sure?ie=utf-8&only_user=1&qw="+encodeURIComponent($.tb.escapeHTML(t))),!1},searchTag:function(t){return this._sendStatistics("tagsearch",t),$.tb.location.setHref("/f/search/fm?ie=utf-8&tag="+encodeURIComponent($.tb.escapeHTML(t))),!1},searchForum:function(t){var e="/f/search/fm?ie=UTF-8&";return-1!=t.indexOf("\u6807\u7b7e\uff1a")?(t=t.substr(t.indexOf("\u6807\u7b7e\uff1a")+3),e=e+"tag="+encodeURIComponent($.tb.escapeHTML(t))):-1!=t.indexOf("\u6807\u7b7e:")?(t=t.substr(t.indexOf("\u6807\u7b7e:")+3),e=e+"tag="+encodeURIComponent($.tb.escapeHTML(t))):e=e+"qw="+encodeURIComponent($.tb.escapeHTML(t)),$.tb.location.setHref(e),!1}}});_.Module.define({path:"navigation/widget/tbnav_bright/tbnav_search",requires:["navigation/widget/search_handler"],sub:{_searchHandler:null,_jq_wrap:null,_jq_input:null,_options:{forumName:""},initial:function(t,i){var n=this;this._searchHandler=this.requireInstance("navigation/widget/search_handler"),this._jq_wrap=t,this._jq_input=t.find(".j_search_internal_input"),this._options=$.extend(this._options,i),this._jq_wrap.submit(function(){return n._searchInternal(),!1}),this._initPlaceHolder()},_addJump:function(){$(".qiangzuo_trigger").length>0&&$(".qiangzuo_trigger").on("click",function(){window.open("/game/worldcup/index")})},_searchInternal:function(){var t=this._getSearchWord();this._searchHandler.searchPostInBa(t,this._options.forumName)},_getSearchWord:function(){return this._jq_input.val()},_initPlaceHolder:function(){var t=this,i=this._jq_wrap.find(".j_search_internal_placeholder"),n=this._jq_input;""!=t._getSearchWord()&&i.hide(),n.focus(function(){i.hide()}).blur(function(){""==t._getSearchWord()&&i.show()}),i.click(function(){n.focus()})}}}),_.Module.define({path:"navigation/widget/tbnav_bright",requires:["navigation/widget/tbnav_bright/tbnav_search"],sub:{_jq_wrap:null,_nav_wrap:null,promotion_tmp:['<div id="activity_nav_promotion_enter">','<a href="#{link}" target="_blank">','<img src="#{img}">',"</a>","</div>"].join(""),initial:function(t,i,n){this._jq_wrap=t,this._nav_wrap=$("#tb_nav"),this.requireInstance("navigation/widget/tbnav_bright/tbnav_search",[i.jq_search,i]),this._bindNavDropDownList(),this._initStats(),this._initWanleTip(),n=n||{},this._initPromotionEnter(n.promotion_setting)},_bindNavDropDownList:function(){var t=this;this._nav_wrap.find(".j_tbnav_list").on("mouseenter",function(i){i.preventDefault();var n=$(i.currentTarget);n.addClass("nav_list_over"),t._nav_wrap.find(".j_nav_list").css("overflow","visible"),$("#star_class_nav").css("overflow","visible")}).on("mouseleave",function(t){t.preventDefault();var i=$(t.currentTarget);i.removeClass("nav_list_over")})},_initPromotionEnter:function(t){var i=$.getPageData("0.0",0,t),n=$.getPageData("1.0",0,t);if(!n||!i)return!1;var a=i.replace(/[\/,:,.,-]/g,"").substr(-30);if(1==$.tb.Storage.get("tbnavHideBarrageEnter_"+a))return!1;var e=$.tb.format(this.promotion_tmp,{link:n,img:i}),r=$(e);this._nav_wrap.find(".j_nav_list").append(r),$("#star_class_nav").append(r),$.stats.track("\u5bfc\u822a\u680f\u5c55\u793a","\u5206\u53d1\u5bfc\u822a\u680f\u63a8\u5e7f\u4f4d","","view"),r.on("click",function(){$.stats.track("\u5bfc\u822a\u680f\u8df3\u8f6c","\u5206\u53d1\u5bfc\u822a\u680f\u63a8\u5e7f\u4f4d","","click"),$.tb.Storage.set("tbnavHideBarrageEnter_"+a,1)})},_initStats:function(){var t=this._nav_wrap.find(".j_nav_list"),i="\u5bfc\u822a\u680ftab\u7edf\u8ba1";t.find("a").on("click",function(){var t=$(this).text().split("\uff08")[0];$.stats.track(t,i)})},_initWanleTip:function(){var t=PageUnit.load("tbnav_bright_wanle_type");if(1!=t)return!1;var i=new Date,n=i.getTime(),a=new Date(i.getTime()+864e5-1e3*(60*i.getHours()*60+60*i.getMinutes()+i.getSeconds())),e=$.cookie("wanleTipCircle");if(e){if(n>e+1728e5)return $.cookie("wanleTipCircle",0),void 0;if(0==e)return}else $.cookie("wanleTipCircle",n);var r=this._nav_wrap.find("#j_navtab_wanle");if(r.on("click",function(){$.stats.track("tab\u5bfc\u6d41","\u8d34\u5427PC\u76d6\u697c\u6d3b\u52a8","","click"),s.hide(),$.cookie("wanleTipHide",1,{expires:a})}),1!=$.cookie("wanleTipHide")){var o=['<div class="wanle_tab_tip">','<a class="jump_tip" href="/f?ie=utf-8&kw='+encodeURIComponent("\u4e50\u6b64\u4e0d\u75b2")+'" target="_self"></a>','<a class="close_tip" href="#" onclick="return false;"></a>',"</div>"].join(""),s=$(o);r.closest(".space").append(s),s.on("click","a",function(){s.hide(),$.cookie("wanleTipHide",1,{expires:a})}),s.on("click",".jump_tip",function(){$.stats.track("tab\u5bfc\u6d41","\u8d34\u5427PC\u76d6\u697c\u6d3b\u52a8","","click")})}}}});_.Module.define({path:"tbui/widget/js_redirect",requires:[],sub:{_track:function(e,a,t,o,n){t&&"object"==typeof t&&(n=t,t=""),o&&"object"==typeof o&&(n=o,o="");var r="frs"===t.toLowerCase()?"official/click/viewTrue":"http://"+location.host+"/official/click/viewTrue",c={client_type:"pc_web",task:a&&encodeURIComponent(a)||"",locate:e&&encodeURIComponent(e)||"",type:o&&encodeURIComponent(o)||"click",url:encodeURIComponent(document.location.href),refer:encodeURIComponent(document.referrer)};PageData&&(c.page=t||PageData.product,PageData.forum&&(c.fid=PageData.forum.id||"",c.fname=encodeURIComponent(PageData.forum.name||"")),PageData.user&&(c.uid=PageData.user.id||"",c.uname=PageData.user.name||"",c.is_new_user=PageData.user.is_new_user||""),PageData.thread&&(c.tid=PageData.thread&&PageData.thread.thread_id||""));for(var i in n)n.hasOwnProperty(i)&&(c[i]=encodeURIComponent(n[i]));c.page=c.page.toLowerCase(),$.ajax({type:"POST",url:r,data:c,dataType:"json"})}}});_.Module.define({path:"platform-official/widget/platform_spread_layer",requires:["tbui/widget/js_redirect"],sub:{initial:function(t,a,e,o){if(this.$platformLayer=$("#platform_left_float"),this.$platformCloseBtn=$("#j_platform_close_btn"),this.$platformClickBtn=$("#j_platform_float_content"),this.shouldShowLayer=$.tb.Storage.get("platform_float_hide_"+t)?!0:!1,this.opt=t,this.isLocality=a,this.evl=e,this.evlPb=o,this.shouldShowLayer=a?$.cookie("locality_float_hide_"+t)?!0:!1:$.cookie("platform_float_hide_"+t)?!0:!1,!this.shouldShowLayer){this.isLocality?$.stats.track("\u5730\u65b9\u5427","\u8d34\u5427\u6d6e\u6807",PageData.page,"show",{obj_type:"\u5e73\u53f0\u5316",obj_name:t}):$.stats.track("\u6574\u4f53","\u8d34\u5427\u6d6e\u6807",PageData.page,"show",{obj_type:"\u5e73\u53f0\u5316",obj_name:t}),this.$platformLayer.show(),this._bindEvent(),"pb"===PageData.page&&(this.evl.first_dir=PageData.forum.first_class,this.evl.second_dir=PageData.forum.second_class,this.evlPb.first_dir=PageData.forum.first_class,this.evlPb.second_dir=PageData.forum.second_class),$.stats.track("p0251","ad_plat",PageData.page,"VIEW_TRUE",this.evl);var i=this.requireInstance("tbui/widget/js_redirect");i._track("p0251","ad_plat",PageData.page,"VIEW_TRUE",this.evlPb)}},_bindEvent:function(){var t=this,a=t.$platformLayer,e=t.$platformCloseBtn,o=t.$platformClickBtn,i=t.opt;o.on("click",function(){$.stats.track("\u6574\u4f53\u70b9\u51fb","\u8d34\u5427\u6d6e\u6807",PageData.page,"click",{obj_type:"\u5e73\u53f0\u5316",obj_name:i})}),e.on("click",function(){return $.stats.track("\u5173\u95ed\u6309\u94ae","\u8d34\u5427\u6d6e\u6807",PageData.page,"click",{obj_type:"\u5e73\u53f0\u5316",obj_name:i}),a.hide(),t.isLocality?$.cookie("locality_float_hide_"+i,1,{path:"/"}):$.cookie("platform_float_hide_"+i,1,{expires:999,path:"/"}),$.tb.Storage.set("platform_float_hide_"+i,1),!1})}}});_.Module.define({path:"platform-official/widget/platform_spread_video",requires:[],sub:{ANIMATE_STYLE:{UP:1,DOWN:2},videoHeight:255,ch:document.documentElement.clientHeight||document.body.clientHeight,cw:document.documentElement.clientWidth||document.body.clientWidth,initial:function(t,e){var o=$.tb.Storage.get("platform_spread_video_"+e),i=$.tb.Storage.get("platform_video_spread_close_"+e),a=$.tb.Storage.get("platform_video_spread_autoShow_"+e),n=null!=i,d=null==o&&!parseInt(o),s=$.browser.msie&&6==Number($.browser.version);return this.swfURL=t,this.opt=e,this.$videoWrap=$("#platform_spread_video"),this.$videoTopHeads=this.$videoWrap.find(".platform_video_head"),this.$videoContent=this.$videoWrap.find(".platform_video_content"),this.$upHead=this.$videoTopHeads.eq(0),this.$downHead=this.$videoTopHeads.eq(1),this.$downBtn=this.$upHead.find(".head_down_btn"),this.$upBtn=this.$downHead.find(".head_up_btn"),this.$closeBtns=this.$videoTopHeads.find(".head_close_btn"),this.shouldShowVideo=d,s||n?(this.$videoWrap.hide(),void 0):($.stats.track("\u6574\u4f53","\u8d34\u5427\u89c6\u9891",PageData.page,"show",{obj_type:"\u5e73\u53f0\u5316",obj_name:e}),d&&null==a?($.cookie("platform_video_spread_autoShow_"+e,1,{expires:999,path:"/"}),this._animateTo(this.ANIMATE_STYLE.UP)):this._animateTo(this.ANIMATE_STYLE.DOWN),this._bindEvent(),void 0)},_animateTo:function(t){var e=this,o=e.$videoWrap,i=e.$videoContent,a=e.$downHead,n=e.$upHead,d=e.opt;t&e.ANIMATE_STYLE.UP?($.stats.track("\u89c2\u770b","\u8d34\u5427\u89c6\u9891",PageData.page,"show",{obj_type:"\u5e73\u53f0\u5316",obj_name:d}),i.show(),o.animate({bottom:0},600,function(){a.hide(),n.show(),setTimeout(function(){$.stats.track("\u6709\u6548\u89c2\u770b","\u8d34\u5427\u89c6\u9891",PageData.page,"show",{obj_type:"\u5e73\u53f0\u5316",obj_name:d})},5e3)}),e._loadSwf()):o.animate({bottom:-1*e.videoHeight},600,function(){i.hide(),n.hide(),a.show()})},_bindEvent:function(){var t=this,e=t.$videoWrap,o=t.$closeBtns,i=t.$upBtn,a=t.$downBtn,n=t.opt;o.on("click",function(){return $.stats.track("\u5173\u95ed\u6309\u94ae","\u8d34\u5427\u89c6\u9891",PageData.page,"click",{obj_type:"\u5e73\u53f0\u5316",obj_name:n}),$.tb.Storage.set("platform_video_spread_close_"+n,1),e.hide(),!1}),i.on("click",function(){return t._animateTo(t.ANIMATE_STYLE.UP),!1}),a.on("click",function(){return $.stats.track("\u6536\u8d77\u6309\u94ae","\u8d34\u5427\u89c6\u9891",PageData.page,"click",{obj_type:"\u5e73\u53f0\u5316",obj_name:n}),t._animateTo(t.ANIMATE_STYLE.DOWN),!1}),a.one("click",function(){return $.tb.Storage.set("platform_video_spread_"+n,1),!1})},_loadSwf:function(){{var t=this,e=t.swfURL,o=t.opt;t.$videoContent}new $.swf(e,{id:"platform_video_spread_"+o,container:"#j_platform_video_content",width:340,height:255})}}});_.Module.define({path:"platform-base/widget/professional_manager_tips",sub:{initial:function(s){this.options=s,s.isSuccess?this.options.isAuditAsProfessionalManager&&this.popWelcomeDialog():this.popRefuseDialog()},popWelcomeDialog:function(){var s=this,o=$.tb.alert({title:"\u606d\u559c",message:'<div class="professional_manager_dialog_content"><p>\u606d\u559c\u60a8\u5df2\u7ecf\u901a\u8fc7\u804c\u4e1a\u5427\u4e3b\u8d44\u6599\u5ba1\u6838\uff0c<br>\u4f60\u53ef\u4ee5\u53bb\u540e\u53f0\u7ba1\u7406\u672c\u5427\u3002</p><div class="btn_wrapper"></div></div>',buttons:[{text:"\u53bb\u770b\u770b",callback:function(){o.close(),s.scrollToBtn(),s.setRead()}}]});o.bind("onclose",function(){s.setRead()})},scrollToBtn:function(){var s=$(".professional_forum_manage_btn");s.length&&$("body").scrollTop(s.offset().top-100)},popRefuseDialog:function(){var s=this,o=this.options.isAuditAsProfessionalManager?"\u804c\u4e1a":"\u666e\u901a",t=$.tb.alert({title:"\u5ba1\u6838\u672a\u901a\u8fc7",message:'<div class="professional_manager_dialog_content"><p>\u62b1\u6b49\uff0c\u60a8\u7531\u4e8e\u4ee5\u4e0b\u539f\u56e0\u672a\u901a\u8fc7'+o+'\u5427\u4e3b\u8d44\u6599\u5ba1\u6838\uff1a<br><span class="reason">'+this.options.reason+'</span></p><div class="btn_wrapper"></div></div>',buttons:[{text:"\u786e\u5b9a",callback:function(){s.setRead(),t.close()}}]});t.bind("onclose",function(){s.setRead()})},setRead:function(){$.post("/bawu2/profession/setTipsRead",{ie:"utf-8",word:PageData.forum.name,apply_id:this.options.applyId,tbs:PageData.tbs,type:this.options.isAuditAsProfessionalManager?1:0},function(){},"json")}}});window._.Module.define({path:"encourage-celebrity/widget/celebrity_widget",sub:{initial:function(){this.tplLevel=this.parseTpl(' "<a href="<%= href %>" target="_blank" class="celebrity-level">     <span class="label">\u7b49\u7ea7: </span>     <span class="level">         <span class="level-text"><%= npc_info.cur_level %></span>     </span> </a>" ')},getLevelHtml:function(e,l){return l=null===l?"/f/like/level?kw="+e.npc_forum_name+"&ie=utf-8":l===!1?"javascript:":l,this.tplLevel($.extend({href:l},e))},parseTpl:function(e){return window.baidu.template(e.replace(/^ "|" $/g,""))}}});_.Module.define({path:"encourage-celebrity/widget/celebrity_forum_dialog",requires:["encourage-celebrity/widget/celebrity_widget"],sub:{initial:function(i){this._params=i,this._user=i.user,this.pageData=window.PageData||{},this.tbs=this.pageData.tbs,this.Dialog=$.dialog,this.widget=this.requireInstance("encourage-celebrity/widget/celebrity_widget"),this.tpl=this.widget.parseTpl(' "<div class="celebrity_forum_dialog_wrap">     <div class="dialog_content">         <div class="dialog_left">             <div class="npc_info">                 <a href="/celebrity/rankHome" target="_blank">                     <img src="https://gss0.baidu.com/7Ls0a8Sm2Q5IlBGlnYG/sys/portraitm/item/<%=npc_info.npc_avatar%>" width="140" height="140"/>                 </a>                  <div class="user_level">                     <p class="uname">                         <i class="icon-vip2-18"></i>                         <a href="/celebrity/rankHome" target="_blank"><%=npc_info.npc_name%></a>                         <i class="icon_red"></i>                     </p>                      <div class="level-wrapper"><%- levelHtml %></div>                     <div class="exp">                         <div class="exp_lable">\u7ecf\u9a8c\uff1a</div>                         <a class="exp_bar exp_bar_f" href="/f/like/level?kw=<%=encodeURIComponent(npc_info.npc_forum_name)%>&ie=utf-8" target="_blank">                             <div class="exp_bar_current exp_bar_current_f" style="width:<%=(npc_info.cur_score * 100) / (npc_info.cur_score + npc_info.score_left)%>%;"></div>                             <div class="exp_num">                                 <span class="exp_current_num"><%=npc_info.cur_score%></span>                                 <span>/<%=npc_info.cur_score + npc_info.score_left%></span>                             </div>                         </a>                     </div>                     <p>\u540d\u4eba\u699c\u6392\u540d\uff1a<span class="red_text"><%=npc_info.npc_rank%></span></p>                      <p><a href="/celebrity/rankHome" target="_blank">\u67e5\u770b\u540d\u4eba\u699c>></a></p>                 </div>             </div>             <div class="npc_sign_info">                 <div class="info_top">                     \u52a9\u653b\u8be6\u60c5                 </div>                 <div class="info_content">                     <p class="today">\u672c\u6708\u52a9\u653b\u4eba\u6570\uff1a<b><%=npc_info.total_person%></b></p>                      <div class="detail">                         <div class="col2_left">                             <p class="my-orange-text"><%=user.my_continue_days%></p>                              <p>\u6211\u8fde\u7eed\u52a9\u653b</p>                         </div>                         <div class="col2_right">                             <p class="my-orange-text"><%=user.my_total_days%></p>                              <p>\u6211\u7d2f\u79ef\u52a9\u653b</p>                         </div>                     </div>                 </div>             </div>             <div class="npc_sign">                 <a href="javascript:;" data-forumid="<%=npc_info.npc_forum_id%>" data-npcid="<%=npc_info.npc_id%>" class="sign_btn j_sign_btn <% if (user.is_signed) { %> disable <% } %>"><% if (user.is_signed) {                     %>\u4eca\u65e5\u5df2\u52a9\u653b<% } else { %>\u70b9\u6211\u52a9\u653b<% } %></a>             </div>         </div>         <div class="dialog_right">             <div class="scroll_wrapper">                 <ul>                     <% for (var i = 0, l = props.length; i < l; i++) { %>                     <li class="npc_prop_item">                         <div class="item_pic">                             <img src="<%=props[i].logo_picurl%>" width="70" height="70"/>                             <% if (props[i].is_unlock == 0) { %>                             <div class="lock" style="height: <%=100 - props[i].lock_npc_percent %>%"></div>                             <div class="lock_num">                                 <% if (props[i].lock_npc_percent == 0) { %>                                 <i class="icon_lock"></i>                                 <% } else { %>                                 <%= props[i].lock_npc_percent %>%                                 <% } %>                             </div>                             <% } %>                         </div>                         <div class="item_intro">                             <h4><%=props[i].title%></h4>                              <p class="title-sub-text">\u89e3\u9501\u6761\u4ef6\uff1a                                 <%=npc_info[\'npc_name\']%>\u8d26\u53f7\u8fbe\u5230<b><%=props[i].lock_npc_level%></b>\u7ea7</p>                              <p class="title-sub-text">\u9886\u53d6\u6761\u4ef6\uff1a                                 <% if (props[i].props_category == 300) { %>                                 \u6bcf\u5929\u53ef\u4f7f\u75281\u6b21\uff0c\u672c\u5427\u4f1a\u5458\u4f7f\u7528\u6b21\u6570\u4e0d\u9650                                 <% } else { %>                                 <% if (props[i].limit_sign_level == 0 && props[i].lock_need_vip == 0) { %>                                 \u65e0                                 <% }                                 if (props[i].limit_sign_level > 0) { %>                                 <%=npc_info[\'npc_fans_name\']%>\u8fde\u7eed\u52a9\u653b<b><%=props[i].limit_sign_level%></b>\u6b21                                 <% }                                 if ( props[i].lock_need_vip == 1 ) {                                 if (props[i].limit_sign_level > 0) {%>\uff0c<% } %>                                 <span class="red_text">\u672c\u5427\u4f1a\u5458\u4e13\u5c5e</span>                                 <% }                                 }                                 %>                             </p>                         </div>                         <div class="item_action">                             <% if (props[i].is_unlock == 0) { %>                             <button class="btn_sub btn_middle btn_disable">\u5f85\u89e3\u9501</button>                             <% } else if (props[i].can_get == 0) { %>                             <button class="btn_sub btn_middle btn_disable">\u5f85\u9886\u53d6</button>                             <% } else if (props[i].is_used == 0) { %>                             <button class="btn_default btn_middle j_btn_get" data-propsid="<%=props[i].props_id%>">&nbsp;\u9886&nbsp;&nbsp;\u53d6&nbsp;</button>                             <% } else if (props[i].props_category == 200 || props[i].props_category == 113 || props[i].props_category == 300) { %>                             <button class="btn_sub btn_middle btn_disable" data-propsid="<%=props[i].props_id%>">\u5df2\u83b7\u5f97</button>                             <% } else { %>                             <button class="btn_sub btn_middle j_btn_unuse" data-propsid="<%=props[i].props_id%>">\u53d6\u6d88\u4f7f\u7528</button>                             <% } %>                          </div>                     </li>                     <% } %>                 </ul>             </div>             <div class="privilege-wrapper">                 <p class="title-sub-text">\u5151\u6362\u672c\u5427\u4f1a\u5458\uff0c\u4eab\u53d7\u66f4\u591a\u7279\u6743</p>                  <div class="privilege-container">                     <div class="privilege-item">                         <i class="privilege-crown privilege-icon"></i>                         <br>                         <span>\u7687\u51a0\u8eab\u4efd</span>                     </div>                     <div class="privilege-item">                         <i class="privilege-red-name privilege-icon"></i>                         <br>                         <span>\u663e\u793a\u7ea2\u540d</span>                     </div>                     <div class="privilege-item">                         <i class="privilege-sign privilege-icon"></i>                         <br>                         <span>\u7b7e\u5230\u516d\u500d\u7ecf\u9a8c</span>                     </div>                     <div class="privilege-item">                         <i class="privilege-red-title privilege-icon"></i>                         <br>                         <span>\u53d1\u8d34\u7ea2\u8272\u6807\u9898</span>                     </div>                     <div class="privilege-item">                         <i class="privilege-mark privilege-icon"></i>                         <br>                         <span>\u672c\u5427\u4e13\u5c5e\u5370\u8bb0</span>                     </div>                     <div class="privilege-item">                         <i class="privilege-card-bg privilege-icon"></i>                         <br>                         <span>\u5236\u5b9a\u540d\u7247\u80cc\u666f</span>                     </div>                     <div class="privilege-item">                         <i class="privilege-top-thread privilege-icon"></i>                         <br>                         <span>\u9e23\u4eba\u81ea\u52a8\u9876\u8d34</span>                     </div>                     <div class="privilege-item">                         <i class="privilege-head-border privilege-icon"></i>                         <br>                         <span>\u5236\u5b9a\u5934\u50cf\u8fb9\u6846</span>                     </div>                 </div>             </div>         </div>     </div>     <div class="dialog_footer">         <p class="text-overflow">             <a class="btn_default btn_small j_buy_npc_member" data-fid="<%=npc_info[\'npc_forum_id\']%>" data-fname="<%=npc_info[\'npc_forum_name\']%>" href="javascript:;">\u5151\u6362\u672c\u5427\u4f1a\u5458</a>             <button class="btn-sub btn-small hide-privilege">\u6536\u8d77\u4f1a\u5458\u529f\u80fd<i class="triangle-down"></i></button>             <button class="btn-sub btn-small show-privilege">\u67e5\u770b\u4f1a\u5458\u529f\u80fd<i class="triangle-up"></i></button>             \u666e\u901a\u7b7e\u5230,\u672c\u5427\u7ecf\u9a8c<span class="my-orange-text">+1</span>,             <%=npc_info[\'npc_name\']%>\u7ecf\u9a8c<span class="my-orange-text">+0.01</span>             &nbsp;&nbsp;             <%=npc_info[\'npc_fans_name\']%>\u4f1a\u5458\u52a9\u653b,\u672c\u5427\u7ecf\u9a8c<span class="my-orange-text">+2</span>,             <%=npc_info[\'npc_name\']%>\u7ecf\u9a8c<span class="my-orange-text">+0.1</span>         </p>     </div> </div>" '),this._bindEvents()},_bindEvents:function(){var i=this._params.$root,s=this;i.on("click",function(){if(!s._user.is_login)return s.requireInstanceAsync("common/widget/LoginDialog"),void 0;var i=$(this).data("forumid")||s._params.forumId||s.pageData.forum.id,e={tbs:s.tbs};e.forum_id=i,$.post("/celebrity/submit/getForumSupport",e,function(i){i.data&&i.data.length>0&&s._showDialog(i.data[0])})})},_showDialog:function(i){i.npc_info=i.npc_info||{},i.levelHtml=this.widget.getLevelHtml(i,"/celebrity/rankHome");var s=this.tpl(i),e=i.npc_info,t="\u52a0\u5165"+e.npc_fans_name+", \u53c2\u52a0"+e.npc_forum_name+"\u517b\u6210\u8ba1\u5212";this._params.memberLastDays&&(t+='<span class="title-sub-text">\uff08\u60a8\u7684\u5355\u5427\u4f1a\u5458\u8fd8\u6709<span class="red-text">'+this._params.memberLastDays+"</span>\u5929\u5230\u671f\uff09</span>"),this._dialog=new this.Dialog({holderClassName:"celebrity_forum_dialog",html:s,width:745,height:526,title:t,draggable:!1}),this._bindDialogEvents(this._dialog)},_bindDialogEvents:function(i){var s=this,e=$(i.element),t=!1;e.find(".j_sign_btn").on("click",function(){if(!$(this).hasClass("disable")&&!t){t=!0;var i=$(this).data("npcid"),e=$(this).data("forumid"),a={tbs:s.tbs};a.forum_id=e,a.npc_id=i,$.post("/celebrity/submit/support",a,function(i){switch(i.no){case 0:s._dialog.close(),s._showDialog(i.data);break;case 340027:$.dialog.alert("\u5f88\u62b1\u6b49\uff0c\u5c01\u7981\u7528\u6237\u65e0\u6cd5\u52a9\u653b",{title:"\u63d0\u793a"});break;case 3110004:$.dialog.alert("\u4f60\u8fd8\u672a\u5173\u6ce8\u5f53\u524d\u5427\u54e6, \u5feb\u53bb\u5173\u6ce8\u5427~",{title:"\u63d0\u793a"});break;default:$.dialog.alert("\u62bd\u98ce\u4e86~",{title:"\u63d0\u793a"})}t=!1}).fail(function(){t=!1})}}),e.find(".j_buy_npc_member").on("click",function(){var i=$(this).data("fid"),e=$(this).data("fname"),t={};t.scores_money=0,t.scores_other=0;var a={callback:function(){$.tb.location.reload()}};a.is_show_features=!1,a.is_show_forum=!1,a.current_forum_id=i,a.current_forum_name=e,a.scores=s._user.Parr_scores||t,a.cnt_height=225,a.is_celebrity_forum=!0,s.requireInstance("encourage-member/widget/forum_member_dialog",a),s._dialog.close()}),e.on("click",".j_btn_get",function(){var i=$(this),e=i.data("propsid"),t={tbs:s.tbs};t.props_id=e,$.post("/celebrity/submit/getNpcProps",t,function(s){0===+s.no?200===+s.data.props_category||300===+s.data.props_category||113===+s.data.props_category?i.text("\u5df2\u83b7\u5f97").tbattr("class","btn_sub btn_middle btn_disable"):i.text("\u53d6\u6d88\u4f7f\u7528").tbattr("class","btn_sub btn_middle j_btn_unuse"):$.dialog.alert("\u62bd\u98ce\u4e86")})}),e.on("click",".j_btn_unuse",function(){var i=$(this),e=i.data("propsid"),t={tbs:s.tbs};t.props_id=e,$.post("/tbmall/post/closeProps",t,function(s){0===+s.no?i.html("&nbsp;\u9886&nbsp;&nbsp;\u53d6&nbsp;").tbattr("class","btn_default btn_middle j_btn_get"):$.dialog.alert("\u62bd\u98ce\u4e86")})});var a=e.find(".hide-privilege"),n=e.find(".show-privilege"),l=e.find(".privilege-wrapper");e.on("click",".hide-privilege",function(){a.hide(),n.show(),l.hide()}),e.on("click",".show-privilege",function(){a.show(),n.hide(),l.show()})}}});_.Module.define({path:"encourage-member/widget/forum_member_dialog",requires:["encourage-payment/widget/tbean_safe_ajax","encourage-member/widget/join_vip_dialog","encourage-payment/widget/tcharge_dialog","encourage-payment/widget/tdou_view_pay","user/widget/user_api"],sub:{opts:{},tplData:{forums:null,bdRpTime:[1,3,6,12]},tpl:{hd:'<p class="title"><i class="forum-member-dialog-title-icon"></i>#{title}</p>'},bt:window.baidu.template,pageData:window.PageData||{},Dialog:$.dialog,initial:function(e){if(!$.getPageData("user.is_login",0))return this.requireInstanceAsync("tbui/widget/LoginDialog",["","userBar"]),void 0;var t=this,i={};i.is_show_features=!0,i.is_show_forum=!0,i.current_time_order=1,i.current_option=null,i.current_time_unit=3,i.current_forum_id="",i.current_forum_name="",i.isCurForumMember=!1,i.forums=null,i.celebrity_type=-1,i.user={},this.opts=$.extend({},i,e),this.tplData.forums=this.opts.forums,this.opts.scores=this.opts.scores||this.pageData.scores,this.tdouInUser=t.opts.scores.scores_money+t.opts.scores.scores_other,this.forumMemberTitle="\u5355\u5427\u4f1a\u5458",!this.opts.isCurForumMember&&this._checkIsForumMember(),this.safeAjax=this.requireInstance("encourage-payment/widget/tbean_safe_ajax"),this.showDialog({showTitle:!1,width:710,html:t.buildInitHtml(),scrollable:!1}),t.bindEvents(),t.setDefaultContent()},setDefaultContent:function(){this._dialog.element.find(".j_pertime_unit:eq("+this.opts.current_time_order+")").click()},checkTdouEnough:function(){var e=this,t=e.getTimeValue(),i=parseInt(5e3*t,10);e.tdouInUser<i?(e._dialog.element.find(".not-enough-tbean-alert").css("display","inline-block"),e._dialog.element.find(".get-tdou-text").show(),e._dialog.element.find(".j_charge_tdou").addClass("btn-disabled")):(e._dialog.element.find(".not-enough-tbean-alert").hide(),e._dialog.element.find(".get-tdou-text").hide(),e._dialog.element.find(".j_charge_tdou").removeClass("btn-disabled"))},_checkIsForumMember:function(){var e=this.opts.current_forum_id;if(e){var t=$.getPageData("user.mParr_props.forum_member."+e);this.opts.isCurForumMember=t&&1e3*+t.end_time>+new Date}},bindEvents:function(){var e=this;this._dialog.element.on("click",".charge_tdou_agreement a",function(e){e.stopPropagation(),$.stats.track("\u5151\u6362\u5f39\u7a97\u5e95\u90e8","\u5151\u6362\u5355\u5427\u4f1a\u5458\u670d\u52a1\u534f\u8bae\u70b9\u51fb",PageData.page?PageData.page:"other","click")}),this._dialog.element.on("click",".j_charge_tdou",function(){if(!$(this).hasClass("btn-disabled")){if($.isArray(e.opts.forums)&&!e.opts.current_forum_id)return e.showForumError(),void 0;var t=e.getTimeValue();return e.util._isPositiveDigital(t)?parseInt($.trim(t),10)>120?(e._printTimeErrorInfo("\u6700\u591a\u5145\u503c120\u4e2a\u6708"),$(this).val(120),void 0):(e.initBuyMember(t),void 0):(e._printTimeErrorInfo("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6570\u503c"),void 0)}}),this._dialog.element.on("click",".j_close_excharge",function(t){t.preventDefault(),e.closeDialog()}),this._dialog.element.on("click",".j_pertime_unit",function(t){t.preventDefault(),e.changeCurrentOpt($(this),"current_time_unit"),e._closeTipBubble(),e.changeTdouNum(),e.checkTdouEnough(),$("#customTime").val("")}),this._dialog.element.on("focus","#customTime",function(){e.changeCurrentOpt($(this).closest(".j_customTime_unit"),"current_time_unit"),e.changeTdouNum()}),this._dialog.element.on("keyup","#customTime",function(){var t=$(this).val();return $.trim(t).length>0&&!e.util._isPositiveDigital(t)?(e._printTimeErrorInfo("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6570\u503c"),void 0):parseInt($.trim(t),10)>120?(e._printTimeErrorInfo("\u6700\u591a\u5145\u503c120\u4e2a\u6708"),$(this).val(120),e.changeTdouNum(),void 0):(e._closeTipBubble(),e.checkTdouEnough(),e.changeTdouNum(),void 0)});var t=e._dialog.element.find(".select-forum-list-container"),i=e._dialog.element.find(".select-forum-input");this._dialog.element.on("click",".select-forum-input",function(){e.hideForumError(),t.show()}),this._dialog.element.on("mouseleave",".sel_forum",function(){t.hide()}),this._dialog.element.on("click",".select-forum-list-container span",function(){e.opts.current_forum_id=$(this).data("id"),e.opts.current_forum_name=$(this).html(),e._checkIsForumMember(),i.val($(this).html()),t.hide()}),this._dialog.element.on("click",".open-super-member",function(){e.closeDialog();var t=e.requireInstance("encourage-member/widget/join_vip_dialog",[e.joinVipOptions]);t.getMemberDialog("quick_reply",1007001e3)}),this._dialog.element.on("click",".get-tdou-text",function(t){t.preventDefault(),e.closeDialog(),e.requireInstance("encourage-payment/widget/tcharge_dialog")})},initTdouNotEnough:function(e,t){var i=this,s=i.getTimeValue(),a={};a.month=s,a.baidu_charge=t,a.tdou_num=e,i.closeDialog();var o={};o.f_name=i.opts.current_forum_name,i.chargeFailFn($.extend({},a,o))},purchaseMember:function(e){var t=this,i={};i.open_id=e.open_id,i.order_id=e.order_id,i.timestamp=e.timestamp,i.scene_id=e.scene_id,i.pay_type=e.pay_type,i.from="\u5355\u5427\u4f1a\u5458\u4e2d\u5fc3",i.goods_name=e.goods_name,i.goods_image=e.goods_image||"",i.goods_price=e.goods_price,i.goods_amount=e.goods_amount,i.goods_unit="\u4e2a",i.goods_duration=e.goods_duration,i.free_vip_level=e.free_vip_level,i.tdou_num=e.tdou_num,i.chargeType="platform",t.payment=t.requireInstance("encourage-payment/widget/tdou_view_pay",function(e){"encourage_paid"===e.command&&"success"===$.getPageData("data.error","error",e)&&(t.closeDialog(),t.chargeSuccessFn(e.data||{}))}),t.payment.createMain(i)},initBuyMember:function(e){var t=this,i={from:"pc",tbs:t.pageData.tbs};i.props_id=t.opts.current_forum_id,i.forum_id=t.opts.current_forum_id,i.props_num=e,$.post("/celebrity/submit/genOrder",i,function(e){return 0===e.no?(t.opts.celebrity_type=e.data.celebrity_type,t.purchaseMember(e.data||{}),void 0):(t.closeDialog(),t.chargeFailFn(e),void 0)})},changeCurrentOpt:function(e,t){var i=this;i.opts.current_option&&i.opts.current_option.removeClass(t),i.opts.current_option=e,i.opts.current_option.addClass(t)},changeTdouNum:function(){var e=this;this._dialog.element.find(".sel_tdou .tdou_num").text(5e3*e.getTimeValue())},getTimeValue:function(){var e=$.trim($("#customTime").val());return this.opts.current_option&&this.opts.current_option.data("value")?this.opts.current_option.data("value"):0===e.length&&""===e?0:e},chargeFailFn:function(e){var t,i=this,s="auto";if(2270046===e.no)t=i.bt(' "<a class="outpage_close j_close_excharge" href="#"></a> <div class="excharge_bd excharge_enough_bd">     <p class="main_intro">\u60a8\u5df2\u5f00\u901a25\u4e2a\u5427\u7684\u7279\u6743\u5305\uff0c\u8fbe\u5230\u7279\u6743\u5305\u6570\u91cf\u4e0a\u9650</p>     <p class="sub_intro">\u7acb\u5373\u5f00\u901a\u8d34\u5427\u4f1a\u5458\uff0c\u5c3d\u4eab\u8d34\u5427\u7279\u6743\u65e0\u4e0a\u9650</p>     <a class="j_charge_confirm charge_tdou btn_default btn_small" href="#">\u5f00\u901a\u8d85\u7ea7\u4f1a\u5458</a> </div>" '.replace(/^ "|" $/g,"")),s=216;else if(2270074===e.no)t=i.bt(' "<a class="outpage_close j_close_excharge" href="#"></a> <div class="excharge_bd excharge_enough_bd">     <p class="main_intro"><%= mainContent %></p>     <p class="sub_intro"><%= subContent %></p> </div>" '.replace(/^ "|" $/g,""),{mainContent:"\u8d2d\u4e70\u5931\u8d25",subContent:"\u7528\u6237\u6700\u591a\u4e00\u6b21\u53ea\u80fd\u8d2d\u4e70120\u4e2a\u6708"}),s=216;else if(170003===e.no)t=i.bt(' "<a class="outpage_close j_close_excharge" href="#"></a> <div class="excharge_bd excharge_enough_bd">     <p class="main_intro"><%= mainContent %></p>     <p class="sub_intro"><%= subContent %></p> </div>" '.replace(/^ "|" $/g,""),{mainContent:"\u8d2d\u4e70\u5931\u8d25",subContent:"\u60a8\u8fd8\u672a\u5173\u6ce8\u8be5\u5427"}),s=216;else{if(1990018===e.no){var a=$.dialog.confirm("T\u8c46\u4e0d\u8db3\uff0c\u8bf7\u5151\u6362T\u8c46");return a.bind("onaccept",function(){i.requireInstance("encourage-payment/widget/tcharge_dialog"),i.dialog.close()}),void 0}t=i.bt(' "<a class="outpage_close j_close_excharge" href="#"></a> <div class="excharge_bd excharge_enough_bd">     <p class="main_intro"><%= mainContent %></p>     <p class="sub_intro"><%= subContent %></p> </div>" '.replace(/^ "|" $/g,""),{mainContent:"\u8d2d\u4e70\u5931\u8d25",subContent:"\u5f88\u9057\u61be\uff0c\u8d2d\u4e70\u5931\u8d25\u4e86..."}),s=216}i.showDialog({width:537,height:s,showTitle:!1,html:t}),$(".j_close_excharge, .j_excharge_confirm").on("click",function(e){e.preventDefault(),i.closeDialog()})},chargeSuccessFn:function(e){var t=this,i="",s="auto";0===+e.no&&(t.opts.scores=$.extend(t.opts.scores,e.data.left_scores),t.tdouInUser=t.opts.scores.scores_money+t.opts.scores.scores_other,i=t.buildSuccessHtml(e.data)),t.showDialog({width:708,height:s,showTitle:!1,html:i}),$(".j_close_excharge, .j_excharge_confirm").on("click",function(e){e.preventDefault(),t.closeDialog(),$.tb.location.reload()}),this._dialog.element.on("click",".get-exp-gift",function(){var e={};e.is_show_features=!1,e.is_show_forum=!1,e.current_forum_id=t.opts.current_forum_id,e.current_forum_name=t.opts.current_forum_name,e.scores=t.opts.scores,e.cnt_height=225,e.celebrity_type=t.opts.celebrity_type,e.isCurForumMember=t.opts.isCurForumMember,e.user=t.opts.user,t.requireInstanceAsync("encourage-member/widget/exp_package_dialog",e)})},getUserName:function(){var e=this.requireInstance("user/widget/user_api",[]),t="",i=this.pageData.user,s=$.getPageData("forum.id")||this.opts.current_forum_id;return t=e.checkSuperMemberShipOf(i)?'<i class="icon-vip2-16"></i> <a class="vip-red">'+$.getPageData("user.name")+"</a>":e.checkSingleForumMembershipOf(i,s)?'<i class="icon-vip3-16"></i> <a class="vip-red">'+$.getPageData("user.name")+"</a>":$.getPageData("user.name")},buildInitHtml:function(){var e=this,t="";t=e.opts.is_show_forum?"\u5151\u6362"+e.forumMemberTitle:"\u5151\u6362["+e.opts.current_forum_name+"\u5427]"+e.forumMemberTitle;var i=this.getUserName(),s={};return s.title=t,s.tdou_num=5e3*e.opts.current_time_unit,s.bdRpTime=e.tplData.bdRpTime,s.p_style=e.opts.is_celebrity_forum?'style="visibility: hidden;"':"",s.tip=e.opts.is_celebrity_forum?"\u8d85\u7ea7\u4f1a\u5458\u514d\u8d39\u62e5\u6709":"\u8d85\u7ea7\u4f1a\u5458\u514d\u8d39\u4f7f\u7528\u7279\u6743",s.tdouInUser=this.tdouInUser,s.username=i,s.forums=e.opts.forums,e.bt(' "<a class="outpage_close j_close_excharge" href="#"></a> <div class="excharge_hd">     <p class="title">         <i class="forum-member-dialog-title-icon"></i><%- title %>         <span class="user-info">             <span class="user-name">\u5e10\u53f7\uff1a<%- username %></span>             <span class="tdou-in-user">T\u8c46\u4f59\u989d\uff1a<span class="tdou-in-user-num"><%= tdouInUser %></span></span>         </span>     </p> </div> <div class="excharge_bd">     <div class="sel_member">         <span class="sel_label">\u9009\u62e9\u4f1a\u5458:</span>          <div class="single-forum-member">             <i class="single-forum-icon"></i>              <p class="member-label-title">\u5355\u5427\u4f1a\u5458</p>              <p>                 <span class="member-label-orange">5000</span>                 <span class="member-label-text">T\u8c46/\u6708</span>             </p>             <span class="decorate_icon"></span>         </div>         <span class="member-label-text">\u60f3\u76f4\u63a5\u5347\u7ea7\u4e3a800\u4e07\u4e2a\u5427\u7684\u5355\u5427\u4f1a\u5458\uff1f</span>         <span class="open-super-member">\u5f00\u901a\u8d85\u7ea7\u4f1a\u5458</span>     </div>     <% if($.isArray(forums)) { %>     <div class="sel_forum">         <span class="sel_label">\u9009\u62e9\u5427:</span>         <input class="select-forum-input" aria-readonly="true" readonly placeholder="\u9009\u62e9\u9700\u8981\u5f00\u901a\u4f1a\u5458\u7684\u5427"/>         <% if(!forums.length) { %>         <span style="line-height: 37px; color: #e64545;">* \u81f3\u5c11\u5173\u6ce8\u4e00\u4e2a\u5427\u624d\u80fd\u5f00\u901a\u5355\u5427\u4f1a\u5458\u54e6</span>         <% } %>         <div class="select-forum-list-container">             <div class="select-forum-list">                 <% for(var i = 0; i < forums.length; i++) { %>                 <span data-id="<%= forums[i].forum_id %>"><%= forums[i].forum_name %></span>                 <% } %>             </div>         </div>     </div>     <% } %>     <div class="sel_time">         <span class="sel_label">\u9009\u62e9\u65f6\u957f:</span>         <span class="sel_cnt">             <%for(var i = 0; i< bdRpTime.length; i++){%>             <a class="j_pertime_unit per_time_unit" data-value="<%=bdRpTime[i]%>">                 <strong><%=bdRpTime[i]%></strong>\u4e2a\u6708                 <span class="decorate_icon"></span>             </a>             <%}%>             <a class="j_customTime_unit per_time_unit custom_time">                 <input id="customTime" type="text" value="" placeholder="\u5176\u4ed6"/><span>\u4e2a\u6708</span>                 <span class="decorate_icon"></span>             </a>         </span>     </div>     <p class="long_time_warning" <%= p_style %>>\u7279\u6743\u5305\u65f6\u957f(\u7d2f\u8ba1\u8d85\u7ea7\u4f1a\u5458)\u6700\u591a\u8fde\u7eed24\u4e2a\u6708\uff0c\u8d85\u51fa\u90e8\u5206\u53ea\u8d60\u9001\u7ecf\u9a8c\u548c\u9053\u5177\u3002</p>     <div class="sel_tdou">         <span class="sel_label">\u8fd8\u9700\u652f\u4ed8:</span>         <span class="tdou_num"><%= tdou_num %></span>          <div class="not-enough-tbean-alert">             \u60a8\u7684T\u8c46\u4f59\u989d\u4e0d\u8db3\uff0c\u8bf7\u5148\u83b7\u53d6T\u8c46         </div>     </div>     <a class="j_charge_tdou btn-encourage btn-larger charge_tdou" onclick="return false;" href="#">\u7acb\u5373\u5151\u6362</a>     <span class="get-tdou-text">\u83b7\u53d6T\u8c46</span> </div> <div class="charge_tdou_agreement">   \u8bf7\u52a1\u5fc5\u5ba1\u9605\u5e76\u63a5\u53d7   <a href="https://tieba.baidu.com/tb/vip_eula.html" target="baidu_tb_member_agreement">\u300a\u8d34\u5427\u4f1a\u5458\u670d\u52a1\u534f\u8bae\u300b</a>   \u6240\u6709\u6761\u6b3e\uff0c\u5426\u5219\u60a8\u65e0\u6743\u4f7f\u7528\u672c\u670d\u52a1\u3002 </div> " '.replace(/^ "|" $/g,""),s)},buildSuccessHtml:function(e){var t=this,i={celebrityType:t.opts.celebrity_type,isCurForumMember:t.opts.isCurForumMember,forumName:t.opts.current_forum_name,endTime:t.util._getDate(e.member_end_time),userName:t.getUserName(),tdouInUser:t.tdouInUser};return t.bt(' "<div class="forum-member-success-dialog">     <div class="header">         <span class="pull-left">             <i class="icon-ori"></i>             <span class="exchange">\u5151\u6362[<%= forumName %>\u5427]\u5355\u5427\u4f1a\u5458</span>         </span>         <span class="pull-right">             <span class="user-name">\u5e10\u53f7: <%- userName %></span>             <span class="tbean-scores">                 T\u8c46\u4f59\u989d: <i class="icon icon-tbean"></i> <%- tdouInUser %>             </span>         </span>         <a class="outpage_close j_close_excharge" href="javascript:"></a>     </div>     <div class="body">         <div class="title">             <%= isCurForumMember             ? (\'\u60a8\u7684[\' + forumName + \'\u5427]\u4f1a\u5458\u7eed\u8d39\u6210\u529f\')             : (\'\u606d\u559c\u60a8\u6210\u4e3a[\' + forumName + \'\u5427]\u4f1a\u5458\')             %>         </div>         <ul class="pr-list">             <li>                 <i class="icon-pr pr-crown"></i>                 <span>\u7687\u51a0\u8eab\u4efd</span>             </li>             <li>                 <i class="icon-pr pr-red-name"></i>                 <span>\u663e\u793a\u7ea2\u540d</span>             </li>             <li>                 <i class="icon-pr pr-sign"></i>                 <span>\u7b7e\u52306\u500d\u7ecf\u9a8c</span>             </li>             <li>                 <i class="icon-pr pr-red-title"></i>                 <span>\u7ea2\u8272\u6807\u9898</span>             </li>             <% if (celebrityType === 1) { %>             <li>                 <i class="icon-pr pr-mark"></i>                 <span>\u672c\u5427\u4e13\u5c5e\u5370\u8bb0</span>             </li>             <li>                 <i class="icon-pr pr-card-bg"></i>                 <span>\u5b9a\u5236\u540d\u7247\u80cc\u666f</span>             </li>             <li>                 <i class="icon-pr pr-top-thread"></i>                 <span>\u540d\u4eba\u9876\u8d34</span>             </li>             <li>                 <i class="icon-pr pr-head-border"></i>                 <span>\u5b9a\u5236\u5934\u50cf\u8fb9\u6846</span>             </li>             <% } %>         </ul>         <div class="pr-tip<%= celebrityType === 0 ? \'\' : \' hidden\' %>">             <div class="tips">\u5427\u4e3b<a href="/celebrity/rankHome">\u7533\u8bf7\u540d\u4eba\u5802</a>\u540e, \u624d\u80fd\u89e3\u9501\u4ee5\u4e0b\u7279\u6743:</div>             <ul class="pr-tip-list">                 <li>                     <i class="icon-pr-sm pr-mark"></i>                     <span>\u672c\u5427\u4e13\u5c5e\u5370\u8bb0</span>                 </li>                 <li>                     <i class="icon-pr-sm pr-card-bg"></i>                     <span>\u5b9a\u5236\u540d\u7247\u80cc\u666f</span>                 </li>                 <li>                     <i class="icon-pr-sm pr-top-thread"></i>                     <span>\u540d\u4eba\u9876\u8d34</span>                 </li>                 <li>                     <i class="icon-pr-sm pr-head-border"></i>                     <span>\u5b9a\u5236\u5934\u50cf\u8fb9\u6846</span>                 </li>             </ul>         </div>         <div class="gift-title"><span>\u83b7\u5f97\u793c\u7269</span></div>         <ul class="gift-list">             <li>                 <i class="gift-icon gift-resign"></i>                 <span>\u8865\u7b7e\u5361x1</span>             </li>             <li>                 <i class="gift-icon gift-exp-privilege"></i>                 <span>\u672c\u5427\u7ecf\u9a8c\u4e66\u8d2d\u4e70\u6743</span>             </li>         </ul>     </div>     <div class="svpg-footer">         <button class="btn-sub btn-middle j_close_excharge">\u786e\u5b9a</button>         <button class="btn-encourage btn-middle get-exp-gift">\u8d2d\u4e70\u7ecf\u9a8c\u4e66</button>     </div> </div> " '.replace(/^ "|" $/g,""),i)},showErrorForum:function(){},hideErrorForum:function(){},checkHasForum:function(e,t){var i=this,s={};s.forum_name=encodeURIComponent(e),s.tbs=i.pageData.tbs,$.post("../get/checkForum",s).done(function(e){0===e.no&&(0===e.data.forum_id&&null===e.data.forum_name?i.showErrorForum("hasNot"):(i.hideErrorForum(),$.isFunction(t)&&t(e)))})},showDialog:function(e){this._dialog=new this.Dialog(e)},closeDialog:function(){this._dialog&&this._dialog.close()},showForumError:function(e){var t=this,i=t._dialog.element.find(".sel_forum"),s={content:e||"\u8bf7\u9009\u62e9\u8981\u8d2d\u4e70\u7684\u5427",attr:"",wrap:i,closeBtn:!0};s.bubble_css={top:54,left:100,zIndex:9999},s.arrow_pos={left:10},t._dialog.forumErrorBubble=t._dialog.forumErrorBubble||new window.UiBubbleTipBase(s),t._dialog.forumErrorBubble.showBubble()},hideForumError:function(){this._dialog.forumErrorBubble&&this._dialog.forumErrorBubble.hideBubble()},_buildTipBubble:function(e){var t=this,i={content:e,attr:"",wrap:$(".sel_time"),closeBtn:!0};i.arrow_dir="up",i.bubble_css={top:54,right:45,width:133,zIndex:9999},i.arrow_pos={left:10},this.opts.tip_bubble=new window.UiBubbleTipBase(i);var s=this.opts.tip_bubble;s.showBubble(),s.bind("onclose",function(){t._closeTipBubble()})},_closeTipBubble:function(){this.opts.tip_bubble&&this.opts.tip_bubble.hideBubble()},_showTipBubble:function(){this.opts.tip_bubble&&this.opts.tip_bubble.showBubble()},_printTimeErrorInfo:function(e){this.opts.tip_bubble?this._showTipBubble():this._buildTipBubble(e)},util:{_isEmpty:function(e){return 0===$.trim(e).length},_isPositiveDigital:function(e){return/^[1-9]+[0-9]*]*$/.test(e)},_getDate:function(e){var t=new Date(1e3*e),i=t.getFullYear(),s=t.getMonth()+1,a=t.getDate();return i+"\u5e74"+s+"\u6708"+a+"\u65e5"}}}});_.Module.define({path:"encourage-member/widget/exp_package_dialog",requires:["encourage-payment/widget/tbean_safe_ajax","user/widget/user_api","encourage-payment/widget/tdou_view_pay","encourage-payment/widget/tcharge_dialog","encourage-member/widget/forum_member_dialog"],sub:{opts:{},initial:function(e){var t=this,a={is_show_features:!0,is_show_forum:!0,current_time_order:1,current_option:null,current_time_unit:3,current_forum_id:"",current_forum_name:"",user:{},isCurForumMember:!1};this.opts=$.extend({},a,e),this.opts.scores=this.opts.scores||PageData.scores,this.tdouInUser=t.opts.scores.scores_money+t.opts.scores.scores_other,this.FORUM_MEMBER_TITLE=this.opts.is_celebrity_forum?"\u5355\u5427\u4f1a\u5458":"\u5427\u7279\u6743\u5305",this.safeAjax=this.requireInstance("encourage-payment/widget/tbean_safe_ajax"),this.showDialog(),this.bindEvents()},getUserName:function(){var e=this.requireInstance("user/widget/user_api",[]),t="",a=this.opts.user,n=this.opts.current_forum_id;return t=e.checkSuperMemberShipOf(a)?'<i class="icon-vip2-16"></i><a class="vip-red">'+$.getPageData("user.name")+"</a>":e.checkSingleForumMembershipOf(a,n)?'<i class="icon-vip3-16"></i><a class="vip-red">'+$.getPageData("user.name")+"</a>":$.getPageData("user.name")},showDialog:function(){var e=this,t=this.getUserName(),a=_.template('<div class="exp-pageckage-dialog">     <a class="outpage-close j-close-excharge" href="#"></a>     <p class="title">         <i class="forum-member-dialog-title-icon"></i>\u5151\u6362[<%= forumName %>\u5427]\u7ecf\u9a8c\u4e66         <span class="user-info">             <span class="user-name">\u5e10\u53f7\uff1a<%= username %></span>             <span class="tdou-in-user">T\u8c46\u4f59\u989d\uff1a<span class="tdou-in-user-num"><%= tdouInUser %></span></span>         </span>     </p>     <div class="exp-package-dialog-body">         <div class="exp-package-intro">             <i class="icon-exp-package-logo"></i>             <p>                 <i class="icon-tbean"></i>                 <span class="exp-orange-text">5000</span>/\u4e2a             </p>             <p>\uff08\u6bcf\u4e2a\u7ecf\u9a8c\u4e66<span class="exp-orange-text">+50</span>\uff0c\u8d2d\u4e70\u7acb\u5373\u751f\u6548\uff09</p>         </div>         <div class="exp-package-parchase-container">             <p class="input-container">                 <label>\u9009\u62e9\u65f6\u957f\uff1a</label>                 <span class="controller-input-container">                     <button class="cut-btn">-</button>                     <input class="exp-num-input" type="text" value="3"/>                     <button class="add-btn">+</button>                 </span>             </p>             <p class="input-container">                 <label>\u8fd8\u9700\u652f\u4ed8\uff1a</label>                 <i class="icon-tbean"></i>                 <span class="exp-orange-text exp-tbean-num">15000</span>             </p>             <%             if (!isCurForumMember) {             %>             <p class="open-member-text">\u5f00\u901a                 <i class="icon-vip3-16"></i>                 <span class="orange-text j-open-single-member">\u672c\u5427\u4f1a\u5458</span>                 \u4e4b\u540e\u624d\u80fd\u5151\u6362\u7ecf\u9a8c\u4e66             </p>             <button class="btn-middle btn-encourage single-member-btn j-open-single-member">\u5f00\u901a\u5355\u5427\u4f1a\u5458</button>             <% } else { %>             <button class="btn-middle btn-encourage exp-btn">\u7acb\u5373\u5151\u6362</button>             <% } %>         </div>     </div> </div>')({tdou_num:5e3*e.opts.current_time_unit,p_style:e.opts.is_celebrity_forum?'style="visibility: hidden;"':"",tip:e.opts.is_celebrity_forum?"\u8d85\u7ea7\u4f1a\u5458\u514d\u8d39\u62e5\u6709":"\u8d85\u7ea7\u4f1a\u5458\u514d\u8d39\u4f7f\u7528\u7279\u6743",tdouInUser:this.tdouInUser,forumName:$.getPageData("forum.name"),username:t,isCurForumMember:e.opts.isCurForumMember});this.dialog=new $.dialog({showTitle:!1,width:700,html:a})},_changeExpInputValue:function(e){e=e||0;var t=this.getExpInputValue();t+=e,t=0>t?0:t,this.$expInput.val(t)},getExpInputValue:function(){var e=parseInt(this.$expInput.val(),10)||0;return e},_updateView:function(e){this.dialog.element.find(".exp-tbean-num").html(e)},purchaseExp:function(e){var t=this,a={open_id:e.open_id,order_id:e.order_id,timestamp:e.timestamp,scene_id:e.scene_id,pay_type:e.pay_type,from:"\u5355\u5427\u4f1a\u5458\u7ecf\u9a8c\u4e66",goods_name:e.goods_name,goods_image:e.goods_image||"",goods_price:e.goods_price,goods_amount:e.goods_amount,goods_unit:"\u4e2a",goods_duration:e.goods_duration,free_vip_level:e.free_vip_level,tdou_num:e.tdou_num};$.extend(a,{chargeType:"platform"}),t.payment=t.requireInstance("encourage-payment/widget/tdou_view_pay",function(e){"encourage_paid"==e.command&&"success"==$.getPageData("data.error","error",e)&&$.tb.location.reload()}),t.payment.createMain(a)},bindEvents:function(){var e=this;this.$expInput=this.dialog.element.find(".exp-num-input"),this.dialog.element.on("click",".add-btn",function(){e._changeExpInputValue(1);var t=e.getExpInputValue();e._updateView(5e3*t)}),this.dialog.element.on("click",".cut-btn",function(){e._changeExpInputValue(-1);var t=e.getExpInputValue();e._updateView(5e3*t)}),this.dialog.element.on("click",".exp-btn",function(){var t=e.getExpInputValue();if(t>200)return $.dialog.alert("\u6700\u591a\u53ea\u80fd\u8d2d\u4e70200\u4e2a\u7ecf\u9a8c\u4e66"),void 0;var a={from:"pc",tbs:PageData.tbs};a.props_id=2000163,a.forum_id=$.getPageData("forum.id"),a.props_num=e.getExpInputValue(),$.post("/celebrity/submit/genOrder",a,function(t){if(1990043===t.no)$.dialog.alert("\u60a8\u4e0d\u662f\u6b64\u5427\u7684\u4f1a\u5458");else if(170003===t.no)$.dialog.alert("\u60a8\u8fd8\u672a\u5173\u6ce8\u6b64\u5427");else if(1990018===t.no){var a=$.dialog.confirm("T\u8c46\u4e0d\u8db3\uff0c\u8bf7\u5151\u6362T\u8c46");a.bind("onaccept",function(){e.requireInstance("encourage-payment/widget/tcharge_dialog"),e.dialog.close()})}else 0===t.no&&e.purchaseExp(t.data)})}),this.dialog.element.on("click",".j-open-single-member",function(){e.dialog.close();var t=PageData.forum;e.requireInstance("encourage-member/widget/forum_member_dialog",{is_show_features:!1,is_show_forum:!1,current_forum_id:t.id,current_forum_name:t.name,scores:e.opts.scores,cnt_height:225,isCurForumMember:e.opts.isCurForumMember,callback:function(){$.tb.location.reload()}})}),this.dialog.element.on("click",".j-close-excharge",function(){e.dialog.close()}),this.$expInput.keyup(function(){e._changeExpInputValue(0);var t=e.getExpInputValue();e._updateView(5e3*t)})}}});_.Module.define({path:"encourage-celebrity/widget/npc_vote_action",sub:{initial:function(e){this._opt=e,this._bindEvents()},_bindEvents:function(){var e=this,t=this._opt.$root;t.on("click",".j-btn-vote",function(){if(!PageData.user.is_login)return e.requireInstanceAsync("common/widget/LoginDialog"),void 0;var a=$(this).data("id"),n=$(this).data("forumname");$.post("/celebrity/submit/voteNpc",{tbs:PageData.tbs,id:a},function(a){switch(a.no){case 0:t.find(".j_vote_npc_"+a.data.id).find(".j_vote_num").text(a.data.vote_num),e._success();break;case 952710:e._attention(n);break;case 11e4:e.requireInstanceAsync("common/widget/LoginDialog");break;case 952711:e._alert({msg:"\u5427\u7b49\u7ea7\u8fbe\u5230"+(~~a.data+1)+"\u7ea7\u624d\u80fd\u652f\u6301\u672c\u5427\u54e6"});break;case 952712:e._alert({msg:"\u60a8\u7533\u8bf7\u7684\u540d\u4eba\u5df2\u522b\u7533\u8bf7\u8fc7\u4e86~"});break;case 952713:e._alert({msg:"\u672c\u671f\u6295\u7968\u7ed3\u675f\uff0c\u4e0b\u4e00\u671f\u5373\u5c06\u542f\u52a8\uff0c\u656c\u8bf7\u671f\u5f85"});break;case 952709:e._alert({msg:"\u5f53\u524d\u7528\u6237\u4e0d\u662f\u5427\u4e3b"});break;case 65534:e._alert({msg:"\u6bcf\u5929\u53ea\u80fd\u7ed93\u4e2a\u5427\u6295\u7968 \u0ca5_\u0ca5"});break;case 65533:e._alert({msg:"\u6bcf\u5929\u53ea\u80fd\u7ed9\u4e00\u4e2a\u5427\u62951\u7968\uff0c\u8bf7\u660e\u5929\u7ee7\u7eed\u652f\u6301"});break;case 65532:e._alert({msg:"IP\u4e00\u5929\u8d85\u8fc7500"});break;default:$.dialog.alert(a.error,{title:"\u63d0\u793a"})}})})},_success:function(){var e='<div class="npc-vote-dialog"><p>\u6295\u7968\u6210\u529f</p><div class="btn-group"><a href="/celebrity/rankHome#npc_vote" class="btn-default btn-small mr10 j-see-rank">\u67e5\u770b\u699c\u5355</a> <a href="javascript:;" class="btn-sub btn-small j_close">\u53d6 \u6d88</a></div></div>',t=this._alert({html:e});$(t.element).find(".j-see-rank").on("click",function(){t.close()})},_alert:function(e){var t=e.html||'<div class="npc-vote-dialog"><p>'+e.msg+'</p><div class="btn-group">  <a href="#" class="btn-default btn-small j_close">\u786e \u8ba4</a></div></div>',a=new $.dialog({width:380,html:t,title:"\u63d0\u793a",draggable:!1});return $(a.element).find(".j_close").on("click",function(){return a.close(),!1}),a},_attention:function(e){var t='<div class="npc-vote-dialog"><p>\u672a\u5173\u6ce8\u672c\u5427\u4e0d\u80fd\u6295\u7968\u54e6~</p><div class="btn-group"> <a href="/f?kw='+encodeURIComponent(e)+'" class="btn-default btn-small">\u53bb\u5173\u6ce8</a></div></div>';new $.dialog({width:350,html:t,title:"\u63d0\u793a",draggable:!1})}}});_.Module.define({path:"encourage-celebrity/widget/celebrity",requires:["encourage-payment/widget/tdou_view_pay","encourage-member/widget/forum_member_dialog","encourage-celebrity/widget/npc_vote_action","encourage-member/widget/exp_package_dialog","encourage-celebrity/widget/celebrity_forum_dialog"],sub:{initial:function(e){this.$root=$(".celebrity"),this.pageData=window.PageData,this.forum=this.pageData.forum,this.user=e.user,this.opt=e,this.isCelebrityForum=e.isCelebrityForum||!1,this.isCurForumMember=e.isCurForumMember||!1,this._bindEvents()},purchaseExp:function(e){var r=this,o=$.extend({from:"\u5355\u5427\u4f1a\u5458\u7ecf\u9a8c\u4e66",chargeType:"platform"},e);o.goods_unit="\u4e2a",r.payment=r.requireInstance("encourage-payment/widget/tdou_view_pay"),r.payment.createMain(o)},_bindEvents:function(){var e=this;this.$root.find(".j-gift-buy").on("click",function(){var r={};r.scores_money=0,r.scores_other=0;var o={};o.is_show_features=!1,o.is_show_forum=!1,o.current_forum_id=e.forum.id,o.current_forum_name=e.forum.name,o.scores=e.user.Parr_scores||r,o.cnt_height=225,o.is_celebrity_forum=e.isCelebrityForum,o.isCurForumMember=e.isCurForumMember,o.user=e.user,o.callback=function(){$.tb.location.reload()},e.requireInstance("encourage-member/widget/forum_member_dialog",o)}),this.$root.on("click",".open-btn",function(){e.$root.find(".first-show-container").hide(),e.$root.find(".second-show-container").show()}),this.$root.on("click",".close-btn",function(){e.$root.find(".first-show-container").show(),e.$root.find(".second-show-container").hide()}),this.requireInstance("encourage-celebrity/widget/npc_vote_action",{$root:e.$root}),this.$root.on("click",".celebrity-purchase-exp",function(){if(!$.getPageData("user.is_login",0))return e.requireInstanceAsync("tbui/widget/LoginDialog",["","userBar"]),void 0;var r={};r.scores_money=0,r.scores_other=0;var o={};o.is_show_features=!1,o.is_show_forum=!1,o.current_forum_id=e.forum.id,o.current_forum_name=e.forum.name,o.scores=e.user.Parr_scores||r,o.cnt_height=225,o.is_celebrity_forum=e.isCelebrityForum,o.isCurForumMember=e.isCurForumMember,o.user=e.user,e.requireInstance("encourage-member/widget/exp_package_dialog",[o])}),this.requireInstance("encourage-celebrity/widget/celebrity_forum_dialog",{$root:e.$root.find(".j-btn-celebrity"),celebrity:e.opt.celebrity,user:e.user,memberLastDays:e.opt.memberLastDays})}}});_.Module.define({requires:["encourage-celebrity/widget/celebrity_widget","encourage-props/widget/buy_controller","encourage-payment/widget/tdou_view_pay","encourage-member/widget/forum_member_dialog","encourage-payment/widget/pay_member","tbui/widget/login_dialog"],path:"encourage-celebrity/widget/celebrity_expball",sub:{resources:{expballPropsCategoryId:119,expballScore:200,expballPropsId:1190001,buyprops:"/tbmall/post/buyprops",voteNpc:"/celebrity/submit/voteNpc",ApiGenOrder:"/celebrity/submit/genOrder"},initial:function(e){e=e||{},this.pageData=e.pageData||{},this.parrProps=this.pageData.Parr_props||{},this.parrScores=this.pageData.Parr_scores||this.getEmptyScores(),this.pageData.scores=this.parrScores,this.tbs=window.PageData.tbs,this.forum=this.pageData.forum||{},this.user=this.pageData.user||{},this.widget=this.requireInstance("encourage-celebrity/widget/celebrity_widget"),this.tplMain=this.widget.parseTpl(' "<div class="celebrity-expball">      <div class="celebrity-expball-top">          <div class="celebrity-expball-top-left"></div>          <div class="celebrity-expball-top-right">              <h3>\u53cc\u500d\u7403\u53ef\u4ee5\u5e2e\u4f60\u7ffb\u500d\u6295\u7968\u7ecf\u9a8c\uff01</h3>              <button class="celebrity-expball-buy-btn btn-encourage btn-large" j-celebrity-expball-buy-btn>\u53bb\u4e70\u9053\u5177</button>          </div>        </div>      <div class="celebrity-expball-bottom">          <p>\u66f4\u591a\u7ffb\u500d\u7968\u6570\u7279\u6743</p>            <p>              \u672c\u5427\u4f1a\u5458\uff1a\u6295\u7968\u4e00\u6b21\uff0c\u7968\u6570+2;              <a href="javascript:" j-celebrity-expball-local-vip>\u5f00\u901a>> </a>          </p>      </div>  </div>" '),this.tplConfirm=this.widget.parseTpl(' "<div class="celebrity-expball">      <div class="celebrity-expball-vote">          <h3>\u53cc\u500d\u7403\u53ef\u4ee5\u5e2e\u4f60\u7ffb\u500d\u7968\u6570\u54e6!</h3>            <div class="celebrity-expball-vote-confirm-btn-wrapper">              <button class="btn-default celebrity-expball-vote-confirm-btn btn-middle" j-celebrity-expball-vote-use-btn>\u4f7f\u7528\u9053\u5177(\u8fd8\u5269<%=left_num %>\u4e2a)</button>              <button class="btn-sub celebrity-expball-vote-confirm-btn btn-middle" j-celebrity-expball-vote-no-use-btn>\u76f4\u63a5\u6295\u7968</button>          </div>      </div>  </div>" '),this.tplVote=this.widget.parseTpl(' "<div class="celebrity-expball">      <div class="celebrity-expball-top">          <div class="celebrity-expball-vote">              <h3><i class="celebrity-expball-vote-icon"></i>\u6295\u7968\u6210\u529f\uff0c<span class="orange-text">\u540d\u4eba\u7968\u6570+<%=add_vote_num %></span></h3>              <% if (left_vote_times != -1) { %>              <p class="celebrity-expball-vote-tip">\u4eca\u65e5\u8fd8\u5269<a><%=left_vote_times %></a>\u6b21\u6295\u7968\u673a\u4f1a</p>              <% } %>          </div>        </div>      <div class="celebrity-expball-bottom">          <p>\u7ffb\u500d\u7968\u6570\u7279\u6743</p>          <ul class="celebrity-expball-bottom-list">              <li>                  <span>\u53cc\u500d\u7403</span><span class="celebrity-expball-bottom-list-right">\u6295\u7968\u4e00\u6b21\uff0c\u7968\u6570*2 <a href="javascript:;" j-celebrity-expball-buy-btn>\u53bb\u8d2d\u4e70>> </a></span>              </li>              <li>                  <span>\u672c\u5427\u4f1a\u5458</span><span class="celebrity-expball-bottom-list-right">\u6295\u7968\u4e00\u6b21\uff0c\u7968\u6570+2 <a href="javascript:;" j-celebrity-expball-local-vip>\u5f00\u901a>> </a></span>              </li>          </ul>      </div>  </div>" '),this.bindEvent()},bindEvent:function(){var e=$(".celebrity"),t=this;e.on("click","[j-celebrity-vote-btn]",function(){var e=$(this);if(t.checkLogin()){var a=e.tbattr("data-id");t.hasExpBall(t.parrProps)?(t.showVoteConfirmDialog(),t.dialog.element.on("click","[j-celebrity-expball-vote-use-btn]",function(){t.vote(a,1)}).on("click","[j-celebrity-expball-vote-no-use-btn]",function(){t.vote(a,0)})):t.vote(a,0)}}).on("click","[j-celebrity-expball-show]",function(){t.tbmallBuy(this)})},hasExpBall:function(e){return+$.getPageData("119.1190001.left_num",0,e)||0},setCallback:function(e,t){this.callback=e,this.context=t},vote:function(e,t){var a=this,r={id:e,tbs:a.tbs};r.use_num=t,$.post(this.resources.voteNpc,r,function(e){if(e)switch(e.no){case 0:t>0&&a.hasExpBall(a.parrProps)&&(a.parrProps["119"]["1190001"].left_num-=t),a.showVoteSuccessDialog(e.data),a.callback&&(a.context?a.callback.call(a.context,e.data):a.callback(e.data));break;case 952710:a.showAlert("\u60a8\u672a\u5173\u6ce8\u672c\u5427");break;case 11e4:a.requireInstanceAsync("common/widget/LoginDialog");break;case 952711:a.showAlert("\u5427\u7b49\u7ea7\u8fbe\u5230"+(e.data+1)+"\u7ea7\u624d\u80fd\u652f\u6301\u672c\u5427\u54e6");break;case 952712:a.showAlert("\u60a8\u7533\u8bf7\u7684\u540d\u4eba\u5df2\u522b\u7533\u8bf7\u8fc7\u4e86~");break;case 952713:a.showAlert("\u672c\u671f\u6295\u7968\u7ed3\u675f\uff0c\u4e0b\u4e00\u671f\u5c06\u5728\u4e0b\u4e2a\u67081\u53f7\u65e9\u4e0a8\u70b9\u542f\u52a8\uff0c\u656c\u8bf7\u671f\u5f85");break;case 952724:a.showAlert("\u672c\u671f\u6295\u7968\u7ed3\u675f, \u4e0b\u671f\u6295\u7968\u5c06\u5728\u65e9\u4e0a8\u70b9\u542f\u52a8, \u656c\u8bf7\u671f\u5f85");break;case 952709:a.showAlert("\u5f53\u524d\u7528\u6237\u4e0d\u662f\u5427\u4e3b");break;case 65534:a.showAlert("\u6bcf\u5929\u53ea\u80fd\u7ed93\u4e2a\u5427\u6295\u7968 \u0ca5_\u0ca5");break;case 65533:a.showAlert("\u6bcf\u5929\u53ea\u80fd\u7ed9\u4e00\u4e2a\u5427\u62951\u7968\uff0c\u8bf7\u660e\u5929\u7ee7\u7eed\u652f\u6301");break;case 65532:a.showAlert("\u5f53\u524dIP\u5df2\u88ab\u9501\u5b9a");break;case 2160001:a.showAlert("\u89d2\u8272\u5df2\u6ee1\u4e00\u4e07\u7968");break;default:a.showAlert("\u64cd\u4f5c\u5931\u8d25,"+e.error)}})},tbmallBuy:function(e){var t=this,a={};a.props_id=this.resources.expballPropsId,a.props_category=this.resources.expballPropsCategoryId,a.props_type="1",a.scores="200",a.name="\u53cc\u500d\u7403",a.imgsrc="//tb2.bdstatic.com/tb/img/expball_buy_icon_552acff.jpg",a.free_user_level="0",a.time_interval="0",a.fetch_scores_limit="0",a.is_default_usedd="0";var r=this.parrScores.scores_total||0;return 200>r?(t.showAlert("T\u8c46\u4f59\u989d\u4e0d\u8db3, \u8bf7\u5148\u5151\u6362T\u8c46\u5427~"),void 0):(this.buyController=this.requireInstance("encourage-props/widget/buy_controller",[$(e),a,this.pageData]),this.buyController._buyDialog.element.off("click",".j_confirm_buy").on("click",".j_confirm_buy",function(){t.genOrder(+t.buyController._buyDialog.element.find(".j_count").val())}),void 0)},genOrder:function(e){var t=this,a={from:"pc",tbs:t.tbs};a.props_id=t.resources.expballPropsId,a.props_num=e,$.post(t.resources.ApiGenOrder,a,function(e){0===+e.no?t.payOrder(e.data||{}):t.showAlert("\u8ba2\u5355\u751f\u6210\u5931\u8d25, \u8bf7\u7a0d\u5019\u91cd\u8bd5")})},payOrder:function(e){var t=this,a={from:"\u540d\u4eba\u5802\u6295\u7968",chargeType:"platform"};a.goods_unit="\u4e2a";var r=$.extend(a,e),i=t.requireInstance("encourage-payment/widget/tdou_view_pay",function(e){e.data=e.data||{},"encourage_paid"===e.command&&0===+e.data.no&&(t.updatePageData($.getPageData("data.data.order_info",{},e)),t.buyController._buyDialog.close())});i.createMain(r)},updatePageData:function(e){var t=+e.tdou_num,a=+e.money_scores,r=+e.other_scores,i=t/200,o=this.hasExpBall(this.parrProps)+i;this.parrScores.scores_total-=t,this.parrScores.scores_money-=a,this.parrScores.scores_other-=r,this.parrProps["119"]=this.parrProps["119"]||{},this.parrProps["119"]["1190001"]=this.parrProps["119"]["1190001"]||{},this.parrProps["119"]["1190001"].left_num=o},getEmptyScores:function(){var e={};return e.scores_money=0,e.scores_total=0,e.scores_other=0,e},showExpBallDialog:function(){var e=this;this.showDialog(e.tplMain({})),e.dialog.element.on("click","[j-celebrity-expball-buy-btn]",function(){e.dialog.close(),e.tbmallBuy(this)}).on("click","[j-celebrity-expball-local-vip]",function(){e.dialog.close();var t={callback:function(){$.tb.location.reload()}};t.is_show_features=!1,t.is_show_forum=!1,t.current_forum_id=e.forum.forum_id,t.current_forum_name=e.forum.forum_name,t.scores=e.pageData.Parr_scores||e.getEmptyScores(),t.cnt_height=225,t.is_celebrity_forum=!0,e.requireInstance("encourage-member/widget/forum_member_dialog",t)}).on("click","[j-celebrity-expball-super-vip]",function(){e.dialog.close();var t=e.requireInstance("encourage-payment/widget/pay_member"),a={fr:"celebrity"};t.showCashier(a)})},showVoteSuccessDialog:function(e){var t=this;e.left_vote_times=e.left_vote_times||-1,this.showDialog(t.tplVote(e)),t.dialog.element.on("click","[j-celebrity-expball-buy-btn]",function(){t.dialog.close(),t.tbmallBuy(this)}).on("click","[j-celebrity-expball-local-vip]",function(){t.dialog.close();var e={callback:function(){$.tb.location.reload()}};e.is_show_features=!1,e.is_show_forum=!1,e.current_forum_id=t.forum.forum_id,e.current_forum_name=t.forum.forum_name,e.scores=t.pageData.Parr_scores||t.getEmptyScores(),e.cnt_height=225,e.is_celebrity_forum=!0,t.requireInstance("encourage-member/widget/forum_member_dialog",e)}).on("click","[j-celebrity-expball-super-vip]",function(){t.dialog.close();var e=t.requireInstance("encourage-payment/widget/pay_member"),a={fr:"celebrity"};e.showCashier(a)})},showVoteConfirmDialog:function(){var e={};e.left_num=this.hasExpBall(this.parrProps),this.showDialog(this.tplConfirm(e))},showAlert:function(e){$.dialog.alert(e,{title:"\u8d34\u5427\u63d0\u793a",acceptValue:"\u77e5\u9053\u5566",onaccept:function(){return!0}})},showDialog:function(e,t){this.dialog&&(this.dialog.close(),this.dialog=null);var a=$.dialog;this.dialog=new a({title:t,html:e,width:430})},checkLogin:function(){return window.PageData.user.is_login?!0:(this.requireInstance("tbui/widget/login_dialog"),!1)}}});window._.Module.define({path:"encourage-appforum/widget/app_forum_notice",sub:{ASIDE_NOTICE_TPL:'<div class="tbapp-forum-edit-wrapper"><div class="tbapp-forum-edit-container"><label>\u6a21\u5757\u540d\u79f0\uff1a</label><input id="tbapp-notice-title-edit" class="form-control"></input></div><div class="tbapp-forum-edit-container"><label>\u516c\u544a\u5185\u5bb9\uff1a</label><textarea id="tbapp-notice-content-edit"></textarea></div><div class="tbapp-forum-edit-container clearfix"><button class="btn-default btn-small app-forum-notice-submit-btn">\u786e\u8ba4\u63d0\u4ea4</button></div></div>',initial:function(t){this.$wrapper=$("#app-forum-notice-wrapper"),this.notice=t.notice||"",this.title=t.title||"",this.bindEvent()},showDialog:function(){var t=$(this.ASIDE_NOTICE_TPL),i=new $.dialog({html:t,title:"\u53f3\u4fa7\u516c\u544a\u6a21\u5757\u8bbe\u7f6e",draggable:!0,width:418});$("#tbapp-notice-content-edit").val(this.notice),$("#tbapp-notice-title-edit").val(this.title),i.element.on("click",".app-forum-notice-submit-btn",function(){var t=$("#tbapp-notice-content-edit").val(),i=$("#tbapp-notice-title-edit").val(),e="/tbapp/forum/setTbappNotice";$.post(e,{content:t,title:i,forum_id:$.getPageData("forum.id",0),tbs:$.getPageData("tbs")},function(t){0===t.no&&(alert("\u63d0\u4ea4\u6210\u529f"),$.tb.location.reload())})})},bindEvent:function(){var t=this;this.$wrapper.on("click",".j-set-notice",function(){t.showDialog()})}}});_.Module.define({path:"encourage-appforum/widget/my_app",sub:{MY_APP_THEME_KEY:"my_app_theme_cls",initial:function(a){var t=this;t._root=$(".j_encourage_entry"),$.extend(t,a),$.tb.Storage.remove("my_app_theme_cls"),"1"==t.is_pull_recommendation&&t.pullRecommendation(),t._stats()},_stats:function(){var a=this,t=a._root.find(".list50").length>0;a._root.on("click","a",function(){var e=$(this).data("log"),p=$(this).closest(".j_app_item").find(".j_app_recommend").length>0||"1"!=a.is_pull_recommendation,n={is_recommendation:p,is_50:t};$.stats.track(e,"\u53f3\u4fa7\u5165\u53e3-\u6211\u7684\u5e94\u7528",PageData.product,"click",n)}),a._viewStats(a._root,{is_50:t})},_viewStats:function(a,t){var e=!1,p=null,n=function(){e||($.stats.track("\u5c55\u73b0","\u53f3\u4fa7\u5165\u53e3-\u6211\u7684\u5e94\u7528",PageData.product,"show",t),e=!0)},_=function(){var t=a.offset().top,e=a.offset().top+a.height(),p=$("body").scrollTop(),n=$(window).height()+p,_=!1;return(t>p&&n>=t||e>p&&n>=e)&&(_=!0),_};_()?n():$(window).on("scroll",function(){_()&&(clearTimeout(p),p=setTimeout(n,200))})},setTheme:function(){var a=this,t="list50",e="list60",p=$.tb.Storage.get(a.MY_APP_THEME_KEY);p||(p="1"==a.is_pull_recommendation?a.user_id%2==0?t:e:a.random(0,99)%2==0?t:e,$.tb.Storage.set(a.MY_APP_THEME_KEY,p)),a._root.find(".j_app_list").addClass(p)},random:function(a,t){return null==t&&(t=a,a=0),a+Math.floor(Math.random()*(t-a+1))},pullRecommendation:function(){var a=this,t={ie:"utf-8",tbs:PageData.tbs};a._ajax&&a._ajax.abort(),a._ajax=$.ajax({type:"post",url:"/tbapp/user/getRecommendApp",data:t,dataType:"json"}).success(function(t){t&&0===t.no&&a.renderAppList(t.data)})},renderAppList:function(a){var t=this,e=0;t.wrapper=$(".j_encourage_entry");for(var p="",n='<li  class="media_vertical app_icon_wrap j_app_item #{last_app_item}"><div class="media_top"><a href="/f?ie=utf-8&kw=#{app_name}" data-log="#{app_name}" target="_blank" class="app_icon_link"  title="#{app_name}"><img src="#{app_img}"></a>#{recommend_title}</div><a href="/f?ie=utf-8&kw=#{app_name}" data-log="#{app_name}" target="_blank"  class="media_bottom text_overflow"  title="#{app_name}">#{app_name}</a></li>',_=0,i=a.length;i>_&&12>_;_++){var o=a[_],r={last_app_item:(_+1)%3===0?"last_app_item":"",app_name:o.forum_name,app_img:o.forum_portrait_image,recommend_title:1==o.type?(e++,'<span  class="j_app_recommend media_caption app_recommend">\u8350</span>'):""};p+=$.tb.format(n,r)}var s=t.wrapper.find(".j_add_app_item");12==a.length?s.hide():s.show(),t.wrapper.find(".j_app_list").prepend(p),e==a.length?(t.wrapper.find(".j_encourage_title").html("\u63a8\u8350\u5e94\u7528"),t.wrapper.find(".j_app_recommend").hide()):(t.wrapper.find(".j_encourage_title").html("\u6211\u7684\u5e94\u7528"),t.wrapper.find(".j_app_recommend").show())}}});var QianbaoIframeMsg=function(t){this.initial(t)};QianbaoIframeMsg.prototype={sendNotice:null,noticeList:[],isIE:!!window.ActiveXObject,initial:function(t){this.tar=window.parent,this.callBack=t.callBack,this.tar==window&&console.warn("parent window not found"),this.initPostMsg()},getNotice:function(t,a){$.each(this.noticeList,function(i,e){e(t,a)})},addNotice:function(){this.noticeList.push(this.callBack)},initPostMsg:function(){var t=this;window.postMessage?(t.sendNotice=function(a,i){t.tar.postMessage(JSON.stringify({type:a,data:i}),"*")},$(window).on("message",function(a){a=a.originalEvent;try{var i=JSON.parse(a.data);t.getNotice(i.type,i.data)}catch(a){console.warn(a)}})):t.isIE&&(window.navigator.sendNotice=t.getNotice,window.navigator.getNotice=window.navigator.getNotice||function(){}),t.addNotice()}},_.Module.define({path:"frs-aside/widget/forum_info",requires:["ueglib/widget/forbidden","tbui/widget/word_limit","tbui/widget/LoginDialog"],sub:{_forumData:null,_tip_dialog:null,_has_right:!1,_bindCardTips:'<div class="bind-card-tips-container"><i class="tips-icon"></i><p class="tips-txt">\u586b\u5199\u4ee5\u4e0b\u4fe1\u606f\uff0c<span class="red-text">\u76ee\u7684\u7528\u4e8e\u5f00\u901a\u767e\u5ea6\u94b1\u5305\u76f8\u5e94\u670d\u52a1\uff0c\u4fbf\u4e8e\u540e\u7eed\u4e3a\u60a8\u7684\u5427\u3001\u53ca\u4e2a\u4eba\u8fdb\u884c\u5229\u76ca\u53d1\u653e\u3002</span>\u540c\u65f6\u767e\u5ea6\u5c06\u4e25\u683c\u4fdd\u969c\u60a8\u7684\u4e2a\u4eba\u4fe1\u606f\u5b89\u5168\uff0c<span class="red-text">\u60a8\u7684\u7ed1\u5361\u4fe1\u606f\u5c06\u4e0d\u4f1a\u88ab\u5ba1\u6838\u5427\u4e3b\u770b\u5230\uff0c</span>\u8bf7\u653e\u5fc3\u7ed1\u5b9a\u3002</p></div>',initial:function(t,a,i,e){var n=$(".j_forum_info");if(!(n.length<=0)){var s=this;s._forumData=i,s._mgrNum=t;var r=s.requireInstance("ueglib/widget/forbidden",[e]),o=r.getForbiddenInfo(),l="";o.isForbidden&&(l="\u62b1\u6b49\uff0c\u60a8\u7684\u5e10\u53f7\u88ab\u5c01\u7981\uff0c\u6682\u65f6\u65e0\u6cd5\u7533\u8bf7\u5427\u4e3b\u3002"),this.forbidTpl=l,n.on("click",".member_setup:first",function(){return s.setMemberName(),!1}),n.on("click",".manager_btn",function(){return s.showForumTeamList(),!1}),n.on("click",".j_btn_apply_assist",function(){return s.isLogin()&&($.stats.track("apply","qianbaoBindCardApplyJunior","","click"),s.assistApply()),!1}),s.displayApplyInfo(a)}},_getCandidatesLink:function(t,a){var i="\u67e5\u770b"+t+"\u4f4d\u5427\u4e3b\u5019\u9009\u4eba";return this._forumData.mgr_num>0&&"voting"==a&&(i="\u7ed9"+t+"\u4f4d\u5427\u4e3b\u5019\u9009\u4eba\u6295\u7968"),'<a href="/bawu2/platform/listCandidateInfo?ie=utf-8&word='+$.tb.escapeHTML(this._forumData.name)+'&manager_type=1" target="_blank">['+i+"]</a>"},_getApplyLink:function(t,a,i){if(t)return $('<a href="/managerapply/apply?kw='+$.tb.escapeHTML(this._forumData.name)+"&forum_id="+PageData.forum.id+'" target="_blank" data-checkun="un">\u7533\u8bf7\u5427\u4e3b</a>');var e="";return e=i===!1?'<a href="/managerapply/applyIntern?kw='+$.tb.escapeHTML(this._forumData.name)+"&forum_id="+PageData.forum.id+'" target="_blank" class="tbManagerApplyIntern btn_default btn_small"  data-checkun="un" title="\u7533\u8bf7\u5b9e\u4e60\u5427\u4e3b">\u7533\u8bf7\u5b9e\u4e60\u5427\u4e3b</a>':a?this.team_link+'<a href="/managerapply/apply?kw='+$.tb.escapeHTML(this._forumData.name)+"&forum_id="+PageData.forum.id+'" target="_blank"  data-checkun="un">\u7533\u8bf7\u5427\u4e3b</a>':'<a href="/managerapply/apply?kw='+$.tb.escapeHTML(this._forumData.name)+"&forum_id="+PageData.forum.id+'" target="_blank" class="tbManagerApply btn_default btn_small"  data-checkun="un" title="\u7533\u8bf7\u672c\u5427\u5427\u4e3b">\u7533\u8bf7\u672c\u5427\u5427\u4e3b</a>'},_getManagerApplying:function(){var t="";return 0==this._forumData.mgr_num&&(t=this.team_link),t+'<span style="background:#b8b8b8;padding:4px 5px 1px;color:#fff;">\u7533\u8bf7\u5904\u7406\u4e2d</span>'},_getCandidateHandleLink:function(t){return'<a href="/bawu2/platform/auditPend?ie=utf-8&word='+$.tb.escapeHTML(this._forumData.name)+'" target="_blank">'+t+"\u4e2a\u5427\u4e3b\u7533\u8bf7</a>"},_getAdminTip:function(t){if(t>0){var a=[];return a.push("\u5f85\u5904\u7406\uff1a"),a.push(this._getCandidateHandleLink(t)),a.join("")}return""},setMemberName:function(){var t,a="",i=$("#member_name_link"),e=i.html(),n=this;this._checkBarsName(e)||(e=""),a='<div style="margin:20px 0 0 10px">',a+='<div style="color:red;line-height:20px">\u6ce8\u610f\uff1a\u4f1a\u5458\u540d\u79f0\u4e00\u4e2a\u6708\u53ea\u80fd\u4fee\u6539\u4e00\u6b21\uff0c\u8bf7\u614e\u91cd\u4fee\u6539\u3002</div>',a+='<span style="font-weight:bold;margin-right:10px;">\u672c\u5427\u4f1a\u5458\u540d\u79f0\u8bbe\u7f6e\uff1a</span>',a+='<input value="'+e+'" id="bars_name" size="17" maxlenth="16" /> ',a+='<button id="bars_name_set" style="padding:0 2px 0 2px">\u786e\u5b9a</button><br />',a+='<span style="line-height:26px">',a+='<span id="bars_message" style="line-height: 20px;font-size:12px">\u4ec5\u9650\u4f7f\u7528\u6c49\u5b57\u3001\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf</span></span>',a+="</div>",t=new $.dialog({title:"\u8bbe\u7f6e",width:400,height:120,html:a}),$("#bars_name_set").click(function(){n._submitSetBarsName(this,t,i)})},_submitSetBarsName:function(t,a,i){var e=$("#bars_name").val()||"",n=this;return e=e.toString(),this._checkBarsName(e)?($.ajax({url:"/f/bawu/commit/update_member_alias",type:"post",dataType:"json",async:!1,data:{kw:$.tb.escapeHTML(PageData.forum.name),mbr_alias:e,tbs:PageData.tbs},success:function(t){t&&(0==t.no&&(i.html(e),setTimeout(function(){a.close()},2e3)),n._showMessage(t.no))}}),void 0):!1},_checkBarsName:function(t){"string"!=typeof t&&(t=t.toString()||t.value);for(var a=0;a<t.length;a++)if(t.charCodeAt(a)<127&&!t.substr(a,1).match(/^\w+$/gi))return this._showMessage("605"),!1;return t&&t.replace(/[^\u0000-\u007f]/g,"aa").length>8?(this._showMessage("604"),!1):!0},_showMessage:function(t){var a=this,i="",e="",n=$("#bars_message"),s={1:"\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a",2:"\u5427\u4e0d\u5b58\u5728",3:"\u60a8\u5f53\u524d\u672a\u767b\u5f55",13:"\u60a8\u7684IP\u88ab\u5c01\u7981\uff0c\u6682\u4e0d\u80fd\u4fee\u6539",607:"\u62b1\u6b49\uff0c\u4f1a\u5458\u540d\u79f0\u4e00\u4e2a\u6708\u53ea\u80fd\u4fee\u6539\u4e00\u6b21\uff0c\u76ee\u524d\u65e0\u6cd5\u4fee\u6539\u3002",603:"\u60a8\u8f93\u5165\u7684\u5185\u5bb9\u5305\u542b\u4e0d\u9002\u5b9c\u6587\u5b57\uff0c\u8bf7\u91cd\u8bd5",604:"\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc74\u4e2a\u6c49\u5b57\uff0c\u8bf7\u91cd\u8bd5",605:"\u4ec5\u9650\u4f7f\u7528\u6c49\u5b57\u3001\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf",606:"\u60a8\u6ca1\u6709\u64cd\u4f5c\u6743\u9650",1e3:"\u53d1\u751f\u4e86\u672a\u77e5\u9519\u8bef"};s["12"]=a.forbidTpl,0==t?i='<span style="color:#2e2">\u64cd\u4f5c\u6210\u529f</span>':(e=s[t]||s["1000"],i='<span style="color:#f00">'+e+"</span>"),n.html(i)},displayApplyInfo:function(t){var a=this,i="/managerapply/data/frs";$.get(i,{kw:this._forumData.name,fid:this._forumData.id,is_mgr:t,mgr_num:this._mgrNum,t:(new Date).getTime().toString(32),ie:"utf-8"},function(i){if("undefined"!=typeof i){var e="",n=null;i.is_applying?(e=a._getManagerApplying(),n=$(e)):(0==a._mgrNum?e=a._getApplyLink(!1,i.is_banned,i.is_key_op):a._mgrNum<3&&1!=t&&(e=a._getApplyLink(!0,!1,!0)),n=$(e),0==i.is_key_op&&0==a._mgrNum?n.bind("click",function(){return a.verify("/managerapply/preSubmitIntern")}):n.bind("click",function(){return a.verify("/managerapply/preSubmit")})),""!==e&&$("#tbManagerApply").append(n).parent().show(),i.candidates_num>0&&$("#tbManagerCandidatesNum").html(a._getCandidatesLink(i.candidates_num,i.state)).css("display","block"),i.assist_candidates_num>0&&$("#assistCandidatesNum").html('<a href="/bawu2/platform/listCandidateInfo?word='+$.tb.escapeHTML(a._forumData.name)+'&manager_type=2" target="_blank" class="assist_candidates_num">[\u67e5\u770b'+i.assist_candidates_num+"\u4f4d\u5c0f\u5427\u4e3b\u5019\u9009\u4eba]</a>").css("display","block"),1==t&&$("#tbAdminTip").html(a._getAdminTip(i.unhandled_manager_num)).css("display","block")}},"json")},verify:function(t,a){var i=this,e=t+"?forum_id="+PageData.forum.id+"&kw="+PageData.forum.name+"&t="+(new Date).getTime().toString(32),n={170001:"\u672a\u6ee1\u8db3\u5427\u4e3b\u7533\u8bf7\u6761\u4ef6\u3002",170002:"\u62b1\u6b49\uff0c\u7533\u8bf7\u672c\u5427\u5427\u4e3b\u5427\u5185\u4f1a\u5458\u7b49\u7ea7\u4e0d\u5f97\u4f4e\u4e8e3\u7ea7\u3002",170003:"\u62b1\u6b49\uff0c\u60a8\u8fd8\u672a\u5173\u6ce8\u672c\u5427\u3002",170004:"\u62b1\u6b49\uff0c\u8be5\u5427\u6682\u65f6\u4e0d\u63a5\u53d7\u5427\u4e3b\u7533\u8bf7\u3002",170005:"\u62b1\u6b49\uff0c\u8be5\u5427\u4e09\u4e2a\u5427\u4e3b\u804c\u4f4d\u5df2\u6ee1\u3002",170006:"\u62b1\u6b49\uff0c\u8be5\u5427\u4e09\u4e2a\u5427\u4e3b\u804c\u4f4d\u5df2\u6ee1\u6216\u8be5\u5427\u5df2\u6709\u5b9e\u4e60\u5427\u4e3b\u3002",170007:"\u62b1\u6b49\uff0c\u60a8\u5df2\u62c5\u4efb\u4e09\u4e2a\u5427\u7684\u5427\u4e3b\u804c\u4f4d\uff0c\u4e0d\u80fd\u518d\u6b21\u7533\u8bf7\u3002",170008:"\u62b1\u6b49\uff0c\u8be5\u6761\u7533\u8bf7\u4fe1\u606f\u5df2\u5904\u7406\u5b8c\u6bd5\uff0c\u65e0\u9700\u91cd\u590d\u63d0\u4ea4\u5904\u7406\u3002",170009:"\u62b1\u6b49\uff0c\u8be5\u5427\u6682\u65e0\u7b26\u5408\u6761\u4ef6\u7684\u7533\u8bf7\u4fe1\u606f\u3002",170010:"\u62b1\u6b49\uff0c\u8be5\u6761\u7533\u8bf7\u4fe1\u606f\u5df2\u5904\u7406\u5b8c\u6bd5\uff0c\u65e0\u9700\u91cd\u590d\u63d0\u4ea4\u5904\u7406\u3002",170011:"\u62b1\u6b49\uff0c\u60a8\u7684\u7533\u8bf7\u4fe1\u606f\u5df2\u4e8e\u4eca\u5929\u88ab\u53d7\u7406\uff0c24\u5c0f\u65f6\u5185\u4e0d\u53ef\u518d\u6b21\u7533\u8bf7\u3002",170012:"\u62b1\u6b49\uff0c\u60a8\u5df2\u63d0\u4ea4\u7684\u7533\u8bf7\u4fe1\u606f\u6b63\u5728\u5ba1\u6838\u4e2d\uff0c\u4e0d\u80fd\u91cd\u590d\u63d0\u4ea4\u7533\u8bf7\uff0c\u8bf7\u60a8\u8010\u5fc3\u7b49\u5f85\u3002",170013:"\u62b1\u6b49\uff0c\u60a8\u5df2\u662f\u8be5\u5427\u5427\u4e3b\uff0c\u4e0d\u53ef\u91cd\u590d\u7533\u8bf7\u3002",170014:"\u62b1\u6b49\uff0c\u81ea\u8be5\u5427\u8f9e\u804c\u5427\u4e3b\u6743\u9650\u4e00\u4e2a\u6708\u5185\u4e0d\u53ef\u518d\u6b21\u7533\u8bf7\u8be5\u5427\u5427\u4e3b\u3002",170015:"\u62b1\u6b49\uff0c\u60a8\u4e8e\u8fd1\u671f\u88ab\u64a4\u9500\u8be5\u5427\u5427\u4e3b\u6743\u9650\uff0c60\u5929\u5185\u4e0d\u53ef\u518d\u6b21\u7533\u8bf7\u3002",170016:"\u62b1\u6b49\uff0c\u8be5\u5427\u5df2\u6709\u5427\u4e3b\uff0c\u6682\u4e0d\u63a5\u53d7\u5b9e\u4e60\u5427\u4e3b\u7533\u8bf7\u3002",170017:"\u62b1\u6b49\uff0c\u8be5\u5427\u6682\u4e0d\u63a5\u53d7\u5b9e\u4e60\u5427\u4e3b\u7533\u8bf7\u3002",170018:"\u62b1\u6b49\uff0c\u8be5\u5427\u6682\u4e0d\u63a5\u53d7\u5b9e\u4e60\u5427\u4e3b\u7533\u8bf7\u3002",170019:"\u62b1\u6b49\uff0c\u8be5\u5427\u6682\u4e0d\u63a5\u53d7\u5b9e\u4e60\u5427\u4e3b\u7533\u8bf7\u3002",170020:"\u62b1\u6b49\uff0c\u60a8\u7684ip\u4e0e\u5f53\u524d\u5427\u4e3b\u76f8\u540c\u6216\u8fd1\u4f3c\uff0c\u8bf7\u60a8\u66f4\u6362ip\u540e\u91cd\u65b0\u7533\u8bf7\u3002\u8bf7\u4e0d\u8981\u7528\u591a\u4e2a\u5e10\u53f7\u62c5\u4efb\u540c\u4e00\u4e2a\u5427\u7684\u5427\u4e3b\u804c\u4f4d\u3002",170021:"\u62b1\u6b49\uff0c\u8be5\u5427\u5427\u4e3b\u4e3a\u5b9e\u4e60\u5427\u4e3b\uff0c\u6682\u4e0d\u63a5\u53d7\u5427\u4e3b\u7533\u8bf7\u3002\u8bf7\u60a8\u4e8e\u5b9e\u4e60\u5427\u4e3b\u8f6c\u6b63\u6216\u8005\u8be5\u5427\u65e0\u5427\u4e3b\u65f6\u518d\u6b21\u7533\u8bf7\u3002",250114:"\u62b1\u6b49\uff0c\u60a8\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002",220012:"\u62b1\u6b49\uff0c\u60a8\u7684\u5e10\u53f7\u88ab\u5c01\u7981\uff0c\u6682\u65f6\u65e0\u6cd5\u7533\u8bf7\u5427\u4e3b\u3002",110000:"\u62b1\u6b49\uff0c\u60a8\u8fd8\u672a\u767b\u5f55\u8d34\u5427\uff0c\u8bf7\u60a8\u767b\u5f55\u540e\u91cd\u65b0\u64cd\u4f5c\u3002",110003:"\u8c03\u7528\u5931\u8d25",210009:"\u53c2\u6570\u9519\u8bef",210011:"\u6821\u9a8c\u5931\u8d25",2130015:"\u62b1\u6b49\uff0c\u8ddd\u60a8\u4e0a\u6b21\u7533\u8bf7\u5427\u4e3b\u88ab\u62d2\u7edd\u672a\u6ee17\u5929\uff0c\u8bf7\u60a8\u5728\u6b64\u671f\u95f4\u79ef\u6781\u5728\u5427\u5185\u53d1\u8a00\uff0c\u591a\u53d1\u5e03\u9ad8\u8d28\u91cf\u7684\u8d34\u5b50\uff0c\u5e26\u52a8\u5427\u5185\u5185\u5bb9\u5efa\u8bbe\uff0c\u5728\u5929\u540e\u518d\u6765\u7533\u8bf7\u3002"};return $.ajax({type:a?"POST":"GET",url:e,async:!1,success:function(a){var e=$.json.decode(a);if("undefined"==typeof e)return!1;var s={not_member:124,is_voting:94,not_meet_limit:134,banned_forum:94,meet_max_apply:94,meet_max_manager:94,is_prisoner:94,fired_manager:94,banned_user:134,is_manager:94,manager_is_full:94,is_applying:94};if(i.has_right=0===e.errno?!0:!1,e.errno)if("not_login"==e.invalid_type)TbCom.process("User","buildLoginFrame");else if("no_username"==e.invalid_type)TbCom.process("User","buildUnameFrame");else{var r="";e.invalid_type in s&&(r=s[e.invalid_type]);var o=n[e.errno];o&&""!=o||(o="\u672a\u77e5\u9519\u8bef"),170001===e.errno&&"/managerapply/preSubmit"===t?o=0==e.data.member_days?"\u62b1\u6b49\uff0c\u7533\u8bf7\u672c\u5427\u5427\u4e3b\u9700\u8fbe\u5230\u5982\u4e0b\u6761\u4ef6\uff1a</br>\u5168\u5427\u53d1\u8d34\u6570\u4e0d\u5f97\u5c11\u4e8e"+(e.data.user_all_post_num||0)+"\u8d34\uff0c\u672c\u5427\u53d1\u8d34\u6570\u4e0d\u5f97\u5c11\u4e8e"+(e.data.user_post_num||0)+"\u8d34\u3002</br>\u5f53\u524d\u60a8\u7684\u5168\u5427\u53d1\u8d34\u6570"+(e.data.cur_user_all_post_num||0)+"\u8d34\uff0c\u672c\u5427\u53d1\u8d34\u6570"+(e.data.cur_user_post_num||0)+"\u8d34\u3002":"\u62b1\u6b49\uff0c\u7533\u8bf7\u672c\u5427\u5427\u4e3b\u9700\u8fbe\u5230\u5982\u4e0b\u6761\u4ef6\uff1a</br>\u5168\u5427\u53d1\u8d34\u6570\u4e0d\u5f97\u5c11\u4e8e"+(e.data.user_all_post_num||0)+"\u8d34\uff0c\u672c\u5427\u53d1\u8d34\u6570\u4e0d\u5f97\u5c11\u4e8e"+(e.data.user_post_num||0)+"\u8d34\uff0c\u6210\u4e3a\u4f1a\u5458\u5929\u6570\u4e0d\u5f97\u5c11\u4e8e"+(e.data.member_days||0)+"\u5929\u3002</br>\u5f53\u524d\u60a8\u7684\u5168\u5427\u53d1\u8d34\u6570"+(e.data.cur_user_all_post_num||0)+"\u8d34\uff0c\u672c\u5427\u53d1\u8d34\u6570"+(e.data.cur_user_post_num||0)+"\u8d34\uff0c\u5df2\u7ecf\u6210\u4e3a\u4f1a\u5458\u5929\u6570"+(e.data.cur_member_days||0)+"\u5929\u3002":170001===e.errno&&"/managerapply/preSubmitIntern"===t?o="\u62b1\u6b49\uff0c\u7533\u8bf7\u672c\u5427\u5b9e\u4e60\u5427\u4e3b\u9700\u8fbe\u5230\u5982\u4e0b\u6761\u4ef6\uff1a\u53d1\u8a00\u6570\u4e0d\u5f97\u5c11\u4e8e10\u8d34\u3002":2130015===e.errno&&(o="\u62b1\u6b49\uff0c\u8ddd\u60a8\u4e0a\u6b21\u7533\u8bf7\u5427\u4e3b\u88ab\u62d2\u7edd\u672a\u6ee17\u5929\uff0c\u8bf7\u60a8\u5728\u6b64\u671f\u95f4\u79ef\u6781\u5728\u5427\u5185\u53d1\u8a00\uff0c\u591a\u53d1\u5e03\u9ad8\u8d28\u91cf\u7684\u8d34\u5b50\uff0c\u5e26\u52a8\u5427\u5185\u5185\u5bb9\u5efa\u8bbe\uff0c\u5728"+Math.ceil(e.data/86400)+"\u5929\u540e\u518d\u6765\u7533\u8bf7\u3002");var l='<div class="apply_manager"><p class="ui_text_emphasize">'+o+'</p><p style="padding:5px 0 10px;text-align:center;"><input id="forum_info_dialog_close" type="button" onclick="return false;" class="close_btn" value="\u786e \u5b9a" style="width:75px;" /></p></div>';l=l.replace(/#memIndexLink#/gi,document.getElementById("member_name_link").href),l=l.replace(/#memBALVINFOLink#/gi,"/f/like/level?kw="+$.tb.escapeHTML(PageData.forum.name)),i._tip_dialog=$.dialog.open(l,{title:"\u5427\u4e3b\u7533\u8bf7",width:470,height:r}),$("#forum_info_dialog_close").bind("click",function(){i._tip_dialog.close()})}$.stats.track("access-"+i.has_right.toString(),"apply-manager","","click")}}),i.has_right},_assistErrorMap:{170001:"\u672a\u6ee1\u8db3\u5c0f\u5427\u4e3b\u7533\u8bf7\u6761\u4ef6\u3002",170002:"\u62b1\u6b49\uff0c\u7533\u8bf7\u672c\u5427\u5c0f\u5427\u4e3b\uff0c\u5427\u5185\u4f1a\u5458\u7b49\u7ea7\u4e0d\u5f97\u4f4e\u4e8e3\u7ea7\u3002",170003:"\u62b1\u6b49\uff0c\u60a8\u8fd8\u672a\u5173\u6ce8\u672c\u5427\u3002",170004:"\u62b1\u6b49\uff0c\u8be5\u5427\u6682\u65f6\u4e0d\u63a5\u53d7\u5c0f\u5427\u4e3b\u7533\u8bf7\u3002",170005:"\u62b1\u6b49\uff0c\u8be5\u5427\u5c0f\u5427\u4e3b\u804c\u4f4d\u5df2\u6ee1\u3002",170006:"\u62b1\u6b49\uff0c\u8be5\u5427\u6ca1\u6709\u5427\u4e3b\uff0c\u6682\u65f6\u4e0d\u63a5\u53d7\u5c0f\u5427\u4e3b\u7533\u8bf7\u3002",170007:"\u62b1\u6b49\uff0c\u60a8\u62c5\u4efb\u5c0f\u5427\u4e3b\u804c\u4f4d\u7684\u540d\u989d\u5df2\u6ee1\uff0c\u4e0d\u80fd\u518d\u6b21\u7533\u8bf7\u3002",170008:"\u62b1\u6b49\uff0c\u8be5\u6761\u7533\u8bf7\u4fe1\u606f\u5df2\u5904\u7406\u5b8c\u6bd5\uff0c\u65e0\u9700\u91cd\u590d\u63d0\u4ea4\u5904\u7406\u3002",170009:"\u62b1\u6b49\uff0c\u8be5\u5427\u6682\u65e0\u7b26\u5408\u6761\u4ef6\u7684\u7533\u8bf7\u4fe1\u606f\u3002",170010:"\u62b1\u6b49\uff0c\u8be5\u6761\u7533\u8bf7\u4fe1\u606f\u5df2\u5904\u7406\u5b8c\u6bd5\uff0c\u65e0\u9700\u91cd\u590d\u63d0\u4ea4\u5904\u7406\u3002",170011:"\u62b1\u6b49\uff0c\u60a8\u7684\u7533\u8bf7\u4fe1\u606f\u5df2\u4e8e\u4eca\u5929\u88ab\u53d7\u7406\uff0c24\u5c0f\u65f6\u5185\u4e0d\u53ef\u518d\u6b21\u7533\u8bf7\u3002",170012:"\u62b1\u6b49\uff0c\u60a8\u5df2\u63d0\u4ea4\u7684\u7533\u8bf7\u4fe1\u606f\u6b63\u5728\u5ba1\u6838\u4e2d\uff0c\u4e0d\u80fd\u91cd\u590d\u63d0\u4ea4\u7533\u8bf7\uff0c\u8bf7\u60a8\u8010\u5fc3\u7b49\u5f85\u3002",170013:"\u62b1\u6b49\uff0c\u60a8\u5df2\u662f\u8be5\u5427\u5427\u4e3b\uff0c\u4e0d\u53ef\u91cd\u590d\u7533\u8bf7\u3002",170025:"\u62b1\u6b49\uff0c\u60a8\u5df2\u662f\u8be5\u5427\u5c0f\u5427\u4e3b\uff0c\u4e0d\u53ef\u91cd\u590d\u7533\u8bf7\u3002",220012:"\u62b1\u6b49\uff0c\u60a8\u7684\u5e10\u53f7\u88ab\u5c01\u7981\uff0c\u6682\u65f6\u65e0\u6cd5\u7533\u8bf7\u5c0f\u5427\u4e3b\u3002",250114:"\u62b1\u6b49\uff0c\u60a8\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002",110000:"\u62b1\u6b49\uff0c\u60a8\u8fd8\u672a\u767b\u5f55\u8d34\u5427\uff0c\u8bf7\u60a8\u767b\u5f55\u540e\u91cd\u65b0\u64cd\u4f5c\u3002",110003:"\u5185\u90e8\u9519\u8bef",210009:"\u53c2\u6570\u9519\u8bef",210011:"\u6821\u9a8c\u5931\u8d25"},assistApply:function(){var t=this;this.assistPreAjax&&this.assistPreAjax.abort(),this.assistPreAjax=$.ajax({url:"/managerapply/assist/preSubmit",type:"post",data:{forum_id:PageData.forum.id,tbs:PageData.tbs},dataType:"json"}).done(function(a){0===a.errno?($.stats.track("apply-true","qianbaoBindCardApplyJunior","","view"),t.openAssitApplyDlg(a.data)):($.stats.track("apply-false","qianbaoBindCardApplyJunior","","view"),t.assistMsgDialog(a.errno))})},setBody:function(){$("body").css({height:$(window).outerHeight(),overflow:"hidden"}),$(".dialogJmodal").css({height:$(window).outerHeight(),width:$(window).outerWidth(),position:"fixed",top:0,left:0})},hideBody:function(){$("body").css({height:"inherit",overflow:"auto"})},openAssitApplyDlg:function(t){var a=this;this._assit_apply_dlg=new $.dialog({html:_.template('<p class="requirement_title">\u672c\u5427\u5c0f\u5427\u4e3b\u7533\u8bf7\u8981\u6c42\uff1a</p> <ol class="requirement_wrap">     <li>\u672c\u5427\u7b49\u7ea7\u4e0d\u4f4e\u4e8e3\u7ea7</li>     <li><%=assist_condition%></li> </ol>  <div>     <p class="assist_num">\u672c\u5427\u76ee\u524d\u5df2\u6709\u5c0f\u5427\u4e3b<%=assist_cur_num%>\u540d\uff0c\u8fd8\u6709<span style="color:red;"><%=assist_left_num%></span>\u4e2a\u540d\u989d</p>     <p class="apply_statement_title">\u7533\u8bf7\u611f\u8a00\uff1a</p>     <div class="statement_wrap j_statement_wrap">         <textarea class="ui_textfield statement j_statement"></textarea>     </div>     <div class="btn_wrap">         <p class="error_text"></p>         <a rel="noreferrer"  href="#" class="ui_btn ui_btn_m btn-default btn-small submit j_submit">             <span><em>\u7acb\u5373\u7533\u8bf7</em></span>         </a>     </div> </div> <div class="error-tips-container">     <div class="error-tips-bg"></div>     <p class="error-tips-txt"></p> </div>')(t),title:"\u7533\u8bf7\u5c0f\u5427\u4e3b",width:750,holderClassName:"assist_apply_dlg"}),this._assit_apply_dlg.onclose(function(){a.hideBody()}),this.setBody(),$.stats.track("binded","qianbaoBindCardApplyJunior","","view"),this.resizeDialog(!0),this.bindDlgEvent()},assistMsgDialog:function(t){var a=this,i=this._assistErrorMap[t];i&&""!=i||(i="\u672a\u77e5\u9519\u8bef");var e=['<div style="margin:20px auto 0;text-align:center;height:100px;">',"<div>",'<div style="font-size:14px;font-weight:bold;">\u63d0\u4ea4\u5931\u8d25\uff1a</div>','<div style="margin:10px 0;color:red;">'+i+"</div>",'<a href="#" class="ui_btn ui_btn_m btn-default btn-small j_dlg_close">',"<span><em>\u786e\u5b9a</em></span>","</a>","</div>","</div>"].join("");a._tip_dialog=$.dialog.open(e,{title:"\u7533\u8bf7\u5c0f\u5427\u4e3b",width:470,height:150}),$(".j_dlg_close").click(function(){return a._tip_dialog.close(),!1})},bindDlgEvent:function(){var t=this;this.j_dlg_wrap=$(".assist_apply_dlg"),this.j_statement=this.j_dlg_wrap.find(".j_statement"),this.j_dlg_wrap.find(".j_submit").bind("click",function(){return t.checkInputs()&&($.stats.track("submit","qianbaoBindCardApplyJunior","","click"),t.initAssistPost()),!1});var a={container:".j_statement_wrap",inputObj:".j_statement",showLimit:400,maxNum:400,numStyle:{color:"red"}};t.word_limit_instance=t.requireInstance("tbui/widget/word_limit",[a]),t.word_limit_instance.init()},isLogin:function(){return PageData.user.is_login?PageData.user.no_un?(TbCom.process("User","buildUnameFrame"),!1):!0:(this.requireInstance("tbui/widget/LoginDialog"),!1)},checkInputs:function(){var t=this,a=this.j_dlg_wrap.find(".error_text"),i=this.j_statement.val();return""===i?(a.html("\u7533\u8bf7\u611f\u8a00\u4e3a\u7a7a").show(),!1):t.word_limit_instance.exceed?(a.html("\u7533\u8bf7\u611f\u8a00\u5b57\u6570\u5df2\u8d85\u4e0a\u9650").show(),!1):!0},initAssistPost:function(){var t=this,a={declaration:$.tb.escapeHTML(this.j_statement.val()),forum_id:PageData.forum.id,ie:"utf-8",tbs:PageData.tbs};$.ajax({url:"/managerapply/assist/submit",type:"post",data:a,dataType:"json"}).done(function(a){0===a.errno?($.stats.track("submit-suc","qianbaoBindCardApplyJunior","","view"),t.showSuccess()):($.stats.track("submit-error","qianbaoBindCardApplyJunior","","view"),t._assit_apply_dlg.close(),t.assistMsgDialog(a.errno))}).fail(function(){t._assit_apply_dlg.close(),t.assistMsgDialog("POST ERROR")})},showSuccess:function(){var t=this,a="//tieba.baidu.com/bawu2/platform/listCandidateInfo?word="+PageData.forum.name_url,i=['<div style="position:absolute;margin-top:130px;left:50%;margin-left:-100px;text-align:center;">',"<div>",'<div style="font-size:14px;font-weight:bold;"><img style="width:20px;height:20px;vertical-align:bottom;margin-right:5px;" src="/tb/static-ucenter/img/success.png">\u63d0\u4ea4\u6210\u529f\uff0c\u5427\u4e3b\u5c06\u5c3d\u5feb\u5904\u7406</div>','<div style="margin:10px 0;">\u60a8\u53ef\u4ee5<a href="'+a+'">\u70b9\u51fb\u67e5\u770b\u60a8\u7684\u7533\u8bf7\u4fe1\u606f>></a></div>','<a href="#" class="ui_btn ui_btn_m btn-default btn-small j_dlg_close">',"<span><em>\u786e\u5b9a</em></span>","</a>","</div>","</div>"].join("");this._assit_apply_dlg.setContent(i),this.j_dlg_wrap.addClass("no_title"),$(".j_dlg_close").click(function(){return t._assit_apply_dlg.close(),!1})},assistMsgDialog:function(t){var a=this,i=this._assistErrorMap[t];i&&""!=i||(i="\u672a\u77e5\u9519\u8bef");var e=['<div style="margin:20px auto 0;text-align:center;height:100px;">',"<div>",'<div style="font-size:14px;font-weight:bold;">\u63d0\u4ea4\u5931\u8d25\uff1a</div>','<div style="margin:10px 0;color:red;">'+i+"</div>",'<a href="#" class="ui_btn btn-default btn-small ui_btn_m j_dlg_close">',"<span><em>\u786e\u5b9a</em></span>","</a>","</div>","</div>"].join("");a._tip_dialog=$.dialog.open(e,{title:"\u7533\u8bf7\u5c0f\u5427\u4e3b",width:470,height:150}),$(".j_dlg_close").click(function(){return a._tip_dialog.close(),!1})},showForumTeamList:function(){var t="/f/bawu/admin_group?kw="+encodeURIComponent(PageData.forum.name)+"&ie=utf-8&fid="+PageData.forum.id;$.dialog.open(t,{title:"\u5427\u52a1\u56e2\u961f",width:550,height:260,contentType:"iframe"})},resizeDialog:function(t){t||($.stats.track("bindSuc","qianbaoBindCardApplyJunior","","click"),this.errorTips({errorno:0,msg:"\u7ed1\u5361\u6210\u529f"})),$(".assit-apply-qianbao-iframe").hide(),$(".unbind").removeClass();var a=this._assit_apply_dlg.element;a.animate({width:"535px",left:107.5+parseInt(a.css("left"),10)})},errorTips:function(t){var a="error";a=0===+t.errorno?"suc":"error",$(".error-tips-container").addClass(a).find(".error-tips-txt").html(t.msg||"\u7f51\u7edc\u9519\u8bef"),setTimeout(function(){$(".error-tips-container").removeClass(a)},2e3)},addNotice:function(t,a){var i=window.qianbaoBindAssitIframe,e=$("#assit-qian-bao-bind-card-iframe"),n={message_namespace:"tiebabindcard",service_type:"tieba_actbindcard"};switch(t=t.replace(new RegExp("^"+n.message_namespace+"_"),"")){case"resize":e.height(a.height);break;case"submit_result":a.result+""=="0"?(i.errorTips({errorno:0,msg:"\u7ed1\u5361\u6210\u529f"}),i.resizeDialog()):i.errorTips({errorno:1,msg:"\u7ed1\u5361\u5931\u8d25"})}}}});_.Module.define({path:"frs-aside/widget/zyq",sub:{initial:function(){$(".j_zyq_mod_link").on("click",".j_mod_item",function(){$.stats.track("\u81ea\u5b9a\u4e49\u94fe\u63a5\u70b9\u51fb","\u5427\u4e3b\u914d\u7f6e\u6570\u636e\u7edf\u8ba1","frs","click")}),$(".j_zyq_mod_friend").on("click",".j_mod_item",function(){$.stats.track("\u53cb\u60c5\u8d34\u5427\u94fe\u63a5\u70b9\u51fb","\u5427\u4e3b\u914d\u7f6e\u6570\u636e\u7edf\u8ba1","frs","click")})}}});_.Module.define({path:"frs-aside/widget/define_link",sub:{initial:function(){}}});_.Module.define({path:"frs-aside/widget/friend",sub:{initial:function(){}}});_.Module.define({path:"frs-aside/widget/search_back",sub:{initial:function(){function e(){var e=$("#aside"),a=$(".search_back_box"),t=a.parent();t.height(a.height()),a.width(t.width()),$(window).scroll(function(){e[0].getBoundingClientRect().bottom<=20?a.addClass("search-back-fixed"):a.removeClass("search-back-fixed")})}function a(e){$.stats.track(e.locate,e.task,e.page,e.type,{client_type:"pc_web"})}e(),$(".j_search_back_item").on("click",function(){a({locate:"aside_right_search_back",task:"\u5927\u641c\u56de\u6d41",page:"frs",type:"click"}),window.open($(this).data("url"))}),a({locate:"aside_right_search_back",task:"\u5927\u641c\u56de\u6d41",page:"frs",type:"show"})}}});